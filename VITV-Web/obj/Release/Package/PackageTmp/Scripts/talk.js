!function () {
    define("utils/query_param", [], function () { "use strict"; return function (e) { e = e.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]"); var t = new RegExp("[\\?&]" + e + "=([^&#]*)"), n = t.exec(location.search); return null === n ? "" : decodeURIComponent(n[1].replace(/\+/g, " ")) } }), define("deferLink", ["jquery"], function (e) { "use strict"; function t(e) { return function (t) { return n.call(this, t, e) } } function n(t, n) { function i() { var e = +s.data(a) - 1; s.data(a, e), 0 >= e && !s.data(c) && (u.location.href = h) } var s = "A" === this.nodeName ? e(this) : e(t.target).closest("a"), h = s.attr("href"), d = s.attr("target"), p = s.length && h && 1 === t.which && !t.metaKey && !t.shiftKey, f = n; if (e.isFunction(n) && (f = n.call(this, t), f === !1)) return !1; p && t.isDefaultPrevented() && !s.data(a) && (p = !1), p && d && "_self" !== d && (p = !1), p && o && s.is("[download]") && (p = !1), p && s.hasClass(r) && (p = !1); var m = +(s.data(a) || 0); p && (s.data(a, m + 1), f.when ? ("resolved" === f.state() && i(), f.done(i)) : e.isNumeric(f) ? u.setTimeout(i, f) : (p = !1, s.data(a, m))), p && !m && (t.preventDefault(), s.data(l, !0)) } function i(i) { return i.when || e.isNumeric(i) || e.isFunction(i) ? t(i) : void n.call(this, i, s) } var s = 50, r = "no-defer", o = "download" in document.createElement("a"), a = "defer-link-pends", l = "defer-link-preventable", c = "defer-link-prevented", u = window, h = e.Event.prototype.preventDefault; return e.Event.prototype.preventDefault = function () { var t = e(this.target); return t.data(l) && t.data(c, !0), h.apply(this, Array.prototype.slice.call(arguments)) }, i }), define("utils/applyAll", ["jquery"], function (e) { "use strict"; function t(n, i, s) { var r, o; for (r = 0, o = i.length; o > r; r++) e.isArray(i[r]) ? t(n, i[r], s) : i[r].apply(n, s) } return t }), define("utils/throwError", [], function () { "use strict"; return function (e) { throw new Error("Error in TED: " + e) } }), define("lib/pubSub", ["jquery", "utils/applyAll", "utils/throwError"], function (e, t, n) { "use strict"; function i(e) { var i = { publish: e.fire, subscribe: e.add, unsubscribe: e.remove }, s = null; e.add(function (e) { s = e }), i.read = function () { return s }; var r; return i.publishUnique = function () { if (!window.JSON) return n("JSON object not available. You may need to shim it on this client."), !1; var t = Array.prototype.slice.call(arguments, 0), i = JSON.stringify(t); i !== r && (e.fire.apply(e, t), r = i) }, i.once = function () { function n() { t(e, i, arguments), e.remove(n) } var i = arguments; return e.add(n) }, i.future = function () { function n() { r && t(e, s, arguments) } var i, s = arguments, r = !1; return i = e.add(n), r = !0, i }, i } function s(t) { var n, s = t && r[t]; return s || (n = e.Callbacks("memory"), s = i(n), t && (r[t] = s)), s } var r = {}; return s._reset = function () { r = {} }, s }), define("lib/resize", ["jquery", "lodash", "lib/pubSub"], function (e, t, n) { "use strict"; function i(e) { for (var t, i = d; i--;) !t && e >= h[i].at && (t = h[i].its); n("sizeGroup").publishUnique(t) } function s() { var e = 0, t = u; if (r = window.innerHeight, o = window.innerWidth || document.documentElement.clientWidth, c) e = l; else for (; t--;) !e && o >= a[t] && (e = a[t]); n("breakpoint").publishUnique(e), n("height").publishUnique(r), n("width").publishUnique(o) } var r, o, a = [320, 480, 600, 768, 1024, 1200], l = 1024, c = e("html").is(".oldie"), u = a.length, h = [{ at: 0, its: "oh" }, { at: 480, its: "xs" }, { at: 768, its: "sm" }, { at: 1024, its: "lg" }], d = h.length; return e(window).on("resize", t.throttle(s, 100)), s(), n("breakpoint").subscribe(i), n }), define("lib/ga", ["jquery", "lodash", "deferLink", "lib/pubSub", "lib/resize"], function (e, t, n, i) { "use strict"; function s() { var e = a.slice.call(arguments), i = this; return function (s) { return i.apply(c, e), t.has(s, "originalEvent") && t.has(this, "nodeName") && "click" === s.type ? n.call(this, s) : void 0 } } function r() { var e, t = 0; i("breakpoint").subscribe(function (n) { c("set", "dimension1", n), t++ ? c.sendEvent("breakpoint", "change", e + "|" + n, t) : c.send("pageview"), e = n }) } function o(t) { var n = e(this), i = "ga-"; t = e.extend(t || {}, { category: n.data(i + "category"), action: n.data(i + "action"), label: n.data(i + "label") }), c.sendEvent(t.category, t.action, t.label) } var a = [], l = window, c = l[l.GoogleAnalyticsObject]; return t.assign(c, { send: t.partial(c, "send"), set: t.partial(c, "set"), sendEvent: t.partial(c, "send", "event"), sendSocial: t.partial(c, "send", "social") }, function (e, t) { return t.recall = s, t }), r(), e(function () { e(document).on("click", "a.ga-link", n(function () { return o.call(this, { action: "click", category: "site.link", label: this.href }), 50 })) }), c }), define("hbs/handlebars", [], function () {
        var e = function () {
            var e = function () { "use strict"; function e(e) { this.string = e } var t; return e.prototype.toString = function () { return "" + this.string }, t = e }(), t = function (e) { "use strict"; function t(e) { return a[e] || "&amp;" } function n(e, t) { for (var n in t) Object.prototype.hasOwnProperty.call(t, n) && (e[n] = t[n]) } function i(e) { return e instanceof o ? e.toString() : e || 0 === e ? (e = "" + e, c.test(e) ? e.replace(l, t) : e) : "" } function s(e) { return e || 0 === e ? d(e) && 0 === e.length ? !0 : !1 : !0 } var r = {}, o = e, a = { "&": "&amp;", "<": "&lt;", ">": "&gt;", '"': "&quot;", "'": "&#x27;", "`": "&#x60;" }, l = /[&<>"'`]/g, c = /[&<>"'`]/; r.extend = n; var u = Object.prototype.toString; r.toString = u; var h = function (e) { return "function" == typeof e }; h(/x/) && (h = function (e) { return "function" == typeof e && "[object Function]" === u.call(e) }); var h; r.isFunction = h; var d = Array.isArray || function (e) { return e && "object" == typeof e ? "[object Array]" === u.call(e) : !1 }; return r.isArray = d, r.escapeExpression = i, r.isEmpty = s, r }(e), n = function () { "use strict"; function e(e, t) { var i; t && t.firstLine && (i = t.firstLine, e += " - " + i + ":" + t.firstColumn); for (var s = Error.prototype.constructor.call(this, e), r = 0; r < n.length; r++) this[n[r]] = s[n[r]]; i && (this.lineNumber = i, this.column = t.firstColumn) } var t, n = ["description", "fileName", "lineNumber", "message", "name", "number", "stack"]; return e.prototype = new Error, t = e }(), i = function (e, t) { "use strict"; function n(e, t) { this.helpers = e || {}, this.partials = t || {}, i(this) } function i(e) { e.registerHelper("helperMissing", function (e) { if (2 === arguments.length) return void 0; throw new a("Missing helper: '" + e + "'") }), e.registerHelper("blockHelperMissing", function (t, n) { var i = n.inverse || function () { }, s = n.fn; return d(t) && (t = t.call(this)), t === !0 ? s(this) : t === !1 || null == t ? i(this) : h(t) ? t.length > 0 ? e.helpers.each(t, n) : i(this) : s(t) }), e.registerHelper("each", function (e, t) { var n, i = t.fn, s = t.inverse, r = 0, o = ""; if (d(e) && (e = e.call(this)), t.data && (n = g(t.data)), e && "object" == typeof e) if (h(e)) for (var a = e.length; a > r; r++) n && (n.index = r, n.first = 0 === r, n.last = r === e.length - 1), o += i(e[r], { data: n }); else for (var l in e) e.hasOwnProperty(l) && (n && (n.key = l, n.index = r, n.first = 0 === r), o += i(e[l], { data: n }), r++); return 0 === r && (o = s(this)), o }), e.registerHelper("if", function (e, t) { return d(e) && (e = e.call(this)), !t.hash.includeZero && !e || o.isEmpty(e) ? t.inverse(this) : t.fn(this) }), e.registerHelper("unless", function (t, n) { return e.helpers["if"].call(this, t, { fn: n.inverse, inverse: n.fn, hash: n.hash }) }), e.registerHelper("with", function (e, t) { return d(e) && (e = e.call(this)), o.isEmpty(e) ? void 0 : t.fn(e) }), e.registerHelper("log", function (t, n) { var i = n.data && null != n.data.level ? parseInt(n.data.level, 10) : 1; e.log(i, t) }) } function s(e, t) { m.log(e, t) } var r = {}, o = e, a = t, l = "1.3.0"; r.VERSION = l; var c = 4; r.COMPILER_REVISION = c; var u = { 1: "<= 1.0.rc.2", 2: "== 1.0.0-rc.3", 3: "== 1.0.0-rc.4", 4: ">= 1.0.0" }; r.REVISION_CHANGES = u; var h = o.isArray, d = o.isFunction, p = o.toString, f = "[object Object]"; r.HandlebarsEnvironment = n, n.prototype = { constructor: n, logger: m, log: s, registerHelper: function (e, t, n) { if (p.call(e) === f) { if (n || t) throw new a("Arg not supported with multiple helpers"); o.extend(this.helpers, e) } else n && (t.not = n), this.helpers[e] = t }, registerPartial: function (e, t) { p.call(e) === f ? o.extend(this.partials, e) : this.partials[e] = t } }; var m = { methodMap: { 0: "debug", 1: "info", 2: "warn", 3: "error" }, DEBUG: 0, INFO: 1, WARN: 2, ERROR: 3, level: 3, log: function (e, t) { if (m.level <= e) { var n = m.methodMap[e]; "undefined" != typeof console && console[n] && console[n].call(console, t) } } }; r.logger = m, r.log = s; var g = function (e) { var t = {}; return o.extend(t, e), t }; return r.createFrame = g, r }(t, n), s = function (e, t, n) { "use strict"; function i(e) { var t = e && e[0] || 1, n = d; if (t !== n) { if (n > t) { var i = p[n], s = p[t]; throw new h("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version (" + i + ") or downgrade your runtime to an older version (" + s + ").") } throw new h("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version (" + e[1] + ").") } } function s(e, t) { if (!t) throw new h("No environment passed to template"); var n = function (e, n, i, s, r, o) { var a = t.VM.invokePartial.apply(this, arguments); if (null != a) return a; if (t.compile) { var l = { helpers: s, partials: r, data: o }; return r[n] = t.compile(e, { data: void 0 !== o }, t), r[n](i, l) } throw new h("The partial " + n + " could not be compiled when running in runtime-only mode") }, i = { escapeExpression: u.escapeExpression, invokePartial: n, programs: [], program: function (e, t, n) { var i = this.programs[e]; return n ? i = o(e, t, n) : i || (i = this.programs[e] = o(e, t)), i }, merge: function (e, t) { var n = e || t; return e && t && e !== t && (n = {}, u.extend(n, t), u.extend(n, e)), n }, programWithDepth: t.VM.programWithDepth, noop: t.VM.noop, compilerInfo: null }; return function (n, s) { s = s || {}; var r, o, a = s.partial ? s : t; s.partial || (r = s.helpers, o = s.partials); var l = e.call(i, a, n, r, o, s.data); return s.partial || t.VM.checkRevision(i.compilerInfo), l } } function r(e, t, n) { var i = Array.prototype.slice.call(arguments, 3), s = function (e, s) { return s = s || {}, t.apply(this, [e, s.data || n].concat(i)) }; return s.program = e, s.depth = i.length, s } function o(e, t, n) { var i = function (e, i) { return i = i || {}, t(e, i.data || n) }; return i.program = e, i.depth = 0, i } function a(e, t, n, i, s, r) { var o = { partial: !0, helpers: i, partials: s, data: r }; if (void 0 === e) throw new h("The partial " + t + " could not be found"); return e instanceof Function ? e(n, o) : void 0 } function l() { return "" } var c = {}, u = e, h = t, d = n.COMPILER_REVISION, p = n.REVISION_CHANGES; return c.checkRevision = i, c.template = s, c.programWithDepth = r, c.program = o, c.invokePartial = a, c.noop = l, c }(t, n, i), r = function (e, t, n, i, s) { "use strict"; var r, o = e, a = t, l = n, c = i, u = s, h = function () { var e = new o.HandlebarsEnvironment; return c.extend(e, o), e.SafeString = a, e.Exception = l, e.Utils = c, e.VM = u, e.template = function (t) { return u.template(t, e) }, e }, d = h(); return d.create = h, r = d }(i, e, n, t, s), o = function (e) { "use strict"; function t(e) { e = e || {}, this.firstLine = e.first_line, this.firstColumn = e.first_column, this.lastColumn = e.last_column, this.lastLine = e.last_line } var n, i = e, s = { ProgramNode: function (e, n, i, r) { var o, a; 3 === arguments.length ? (r = i, i = null) : 2 === arguments.length && (r = n, n = null), t.call(this, r), this.type = "program", this.statements = e, this.strip = {}, i ? (a = i[0], a ? (o = { first_line: a.firstLine, last_line: a.lastLine, last_column: a.lastColumn, first_column: a.firstColumn }, this.inverse = new s.ProgramNode(i, n, o)) : this.inverse = new s.ProgramNode(i, n), this.strip.right = n.left) : n && (this.strip.left = n.right) }, MustacheNode: function (e, n, i, r, o) { if (t.call(this, o), this.type = "mustache", this.strip = r, null != i && i.charAt) { var a = i.charAt(3) || i.charAt(2); this.escaped = "{" !== a && "&" !== a } else this.escaped = !!i; this.sexpr = e instanceof s.SexprNode ? e : new s.SexprNode(e, n), this.sexpr.isRoot = !0, this.id = this.sexpr.id, this.params = this.sexpr.params, this.hash = this.sexpr.hash, this.eligibleHelper = this.sexpr.eligibleHelper, this.isHelper = this.sexpr.isHelper }, SexprNode: function (e, n, i) { t.call(this, i), this.type = "sexpr", this.hash = n; var s = this.id = e[0], r = this.params = e.slice(1), o = this.eligibleHelper = s.isSimple; this.isHelper = o && (r.length || n) }, PartialNode: function (e, n, i, s) { t.call(this, s), this.type = "partial", this.partialName = e, this.context = n, this.strip = i }, BlockNode: function (e, n, s, r, o) { if (t.call(this, o), e.sexpr.id.original !== r.path.original) throw new i(e.sexpr.id.original + " doesn't match " + r.path.original, this); this.type = "block", this.mustache = e, this.program = n, this.inverse = s, this.strip = { left: e.strip.left, right: r.strip.right }, (n || s).strip.left = e.strip.right, (s || n).strip.right = r.strip.left, s && !n && (this.isInverse = !0) }, ContentNode: function (e, n) { t.call(this, n), this.type = "content", this.string = e }, HashNode: function (e, n) { t.call(this, n), this.type = "hash", this.pairs = e }, IdNode: function (e, n) { t.call(this, n), this.type = "ID"; for (var s = "", r = [], o = 0, a = 0, l = e.length; l > a; a++) { var c = e[a].part; if (s += (e[a].separator || "") + c, ".." === c || "." === c || "this" === c) { if (r.length > 0) throw new i("Invalid path: " + s, this); ".." === c ? o++ : this.isScoped = !0 } else r.push(c) } this.original = s, this.parts = r, this.string = r.join("."), this.depth = o, this.isSimple = 1 === e.length && !this.isScoped && 0 === o, this.stringModeValue = this.string }, PartialNameNode: function (e, n) { t.call(this, n), this.type = "PARTIAL_NAME", this.name = e.original }, DataNode: function (e, n) { t.call(this, n), this.type = "DATA", this.id = e }, StringNode: function (e, n) { t.call(this, n), this.type = "STRING", this.original = this.string = this.stringModeValue = e }, IntegerNode: function (e, n) { t.call(this, n), this.type = "INTEGER", this.original = this.integer = e, this.stringModeValue = Number(e) }, BooleanNode: function (e, n) { t.call(this, n), this.type = "BOOLEAN", this.bool = e, this.stringModeValue = "true" === e }, CommentNode: function (e, n) { t.call(this, n), this.type = "comment", this.comment = e } }; return n = s }(n), a = function () { "use strict"; var e, t = function () { function e(e, t) { return { left: "~" === e.charAt(2), right: "~" === t.charAt(0) || "~" === t.charAt(1) } } function t() { this.yy = {} } var n = { trace: function () { }, yy: {}, symbols_: { error: 2, root: 3, statements: 4, EOF: 5, program: 6, simpleInverse: 7, statement: 8, openInverse: 9, closeBlock: 10, openBlock: 11, mustache: 12, partial: 13, CONTENT: 14, COMMENT: 15, OPEN_BLOCK: 16, sexpr: 17, CLOSE: 18, OPEN_INVERSE: 19, OPEN_ENDBLOCK: 20, path: 21, OPEN: 22, OPEN_UNESCAPED: 23, CLOSE_UNESCAPED: 24, OPEN_PARTIAL: 25, partialName: 26, partial_option0: 27, sexpr_repetition0: 28, sexpr_option0: 29, dataName: 30, param: 31, STRING: 32, INTEGER: 33, BOOLEAN: 34, OPEN_SEXPR: 35, CLOSE_SEXPR: 36, hash: 37, hash_repetition_plus0: 38, hashSegment: 39, ID: 40, EQUALS: 41, DATA: 42, pathSegments: 43, SEP: 44, $accept: 0, $end: 1 }, terminals_: { 2: "error", 5: "EOF", 14: "CONTENT", 15: "COMMENT", 16: "OPEN_BLOCK", 18: "CLOSE", 19: "OPEN_INVERSE", 20: "OPEN_ENDBLOCK", 22: "OPEN", 23: "OPEN_UNESCAPED", 24: "CLOSE_UNESCAPED", 25: "OPEN_PARTIAL", 32: "STRING", 33: "INTEGER", 34: "BOOLEAN", 35: "OPEN_SEXPR", 36: "CLOSE_SEXPR", 40: "ID", 41: "EQUALS", 42: "DATA", 44: "SEP" }, productions_: [0, [3, 2], [3, 1], [6, 2], [6, 3], [6, 2], [6, 1], [6, 1], [6, 0], [4, 1], [4, 2], [8, 3], [8, 3], [8, 1], [8, 1], [8, 1], [8, 1], [11, 3], [9, 3], [10, 3], [12, 3], [12, 3], [13, 4], [7, 2], [17, 3], [17, 1], [31, 1], [31, 1], [31, 1], [31, 1], [31, 1], [31, 3], [37, 1], [39, 3], [26, 1], [26, 1], [26, 1], [30, 2], [21, 1], [43, 3], [43, 1], [27, 0], [27, 1], [28, 0], [28, 2], [29, 0], [29, 1], [38, 1], [38, 2]], performAction: function (t, n, i, s, r, o) { var a = o.length - 1; switch (r) { case 1: return new s.ProgramNode(o[a - 1], this._$); case 2: return new s.ProgramNode([], this._$); case 3: this.$ = new s.ProgramNode([], o[a - 1], o[a], this._$); break; case 4: this.$ = new s.ProgramNode(o[a - 2], o[a - 1], o[a], this._$); break; case 5: this.$ = new s.ProgramNode(o[a - 1], o[a], [], this._$); break; case 6: this.$ = new s.ProgramNode(o[a], this._$); break; case 7: this.$ = new s.ProgramNode([], this._$); break; case 8: this.$ = new s.ProgramNode([], this._$); break; case 9: this.$ = [o[a]]; break; case 10: o[a - 1].push(o[a]), this.$ = o[a - 1]; break; case 11: this.$ = new s.BlockNode(o[a - 2], o[a - 1].inverse, o[a - 1], o[a], this._$); break; case 12: this.$ = new s.BlockNode(o[a - 2], o[a - 1], o[a - 1].inverse, o[a], this._$); break; case 13: this.$ = o[a]; break; case 14: this.$ = o[a]; break; case 15: this.$ = new s.ContentNode(o[a], this._$); break; case 16: this.$ = new s.CommentNode(o[a], this._$); break; case 17: this.$ = new s.MustacheNode(o[a - 1], null, o[a - 2], e(o[a - 2], o[a]), this._$); break; case 18: this.$ = new s.MustacheNode(o[a - 1], null, o[a - 2], e(o[a - 2], o[a]), this._$); break; case 19: this.$ = { path: o[a - 1], strip: e(o[a - 2], o[a]) }; break; case 20: this.$ = new s.MustacheNode(o[a - 1], null, o[a - 2], e(o[a - 2], o[a]), this._$); break; case 21: this.$ = new s.MustacheNode(o[a - 1], null, o[a - 2], e(o[a - 2], o[a]), this._$); break; case 22: this.$ = new s.PartialNode(o[a - 2], o[a - 1], e(o[a - 3], o[a]), this._$); break; case 23: this.$ = e(o[a - 1], o[a]); break; case 24: this.$ = new s.SexprNode([o[a - 2]].concat(o[a - 1]), o[a], this._$); break; case 25: this.$ = new s.SexprNode([o[a]], null, this._$); break; case 26: this.$ = o[a]; break; case 27: this.$ = new s.StringNode(o[a], this._$); break; case 28: this.$ = new s.IntegerNode(o[a], this._$); break; case 29: this.$ = new s.BooleanNode(o[a], this._$); break; case 30: this.$ = o[a]; break; case 31: o[a - 1].isHelper = !0, this.$ = o[a - 1]; break; case 32: this.$ = new s.HashNode(o[a], this._$); break; case 33: this.$ = [o[a - 2], o[a]]; break; case 34: this.$ = new s.PartialNameNode(o[a], this._$); break; case 35: this.$ = new s.PartialNameNode(new s.StringNode(o[a], this._$), this._$); break; case 36: this.$ = new s.PartialNameNode(new s.IntegerNode(o[a], this._$)); break; case 37: this.$ = new s.DataNode(o[a], this._$); break; case 38: this.$ = new s.IdNode(o[a], this._$); break; case 39: o[a - 2].push({ part: o[a], separator: o[a - 1] }), this.$ = o[a - 2]; break; case 40: this.$ = [{ part: o[a] }]; break; case 43: this.$ = []; break; case 44: o[a - 1].push(o[a]); break; case 47: this.$ = [o[a]]; break; case 48: o[a - 1].push(o[a]) } }, table: [{ 3: 1, 4: 2, 5: [1, 3], 8: 4, 9: 5, 11: 6, 12: 7, 13: 8, 14: [1, 9], 15: [1, 10], 16: [1, 12], 19: [1, 11], 22: [1, 13], 23: [1, 14], 25: [1, 15] }, { 1: [3] }, { 5: [1, 16], 8: 17, 9: 5, 11: 6, 12: 7, 13: 8, 14: [1, 9], 15: [1, 10], 16: [1, 12], 19: [1, 11], 22: [1, 13], 23: [1, 14], 25: [1, 15] }, { 1: [2, 2] }, { 5: [2, 9], 14: [2, 9], 15: [2, 9], 16: [2, 9], 19: [2, 9], 20: [2, 9], 22: [2, 9], 23: [2, 9], 25: [2, 9] }, { 4: 20, 6: 18, 7: 19, 8: 4, 9: 5, 11: 6, 12: 7, 13: 8, 14: [1, 9], 15: [1, 10], 16: [1, 12], 19: [1, 21], 20: [2, 8], 22: [1, 13], 23: [1, 14], 25: [1, 15] }, { 4: 20, 6: 22, 7: 19, 8: 4, 9: 5, 11: 6, 12: 7, 13: 8, 14: [1, 9], 15: [1, 10], 16: [1, 12], 19: [1, 21], 20: [2, 8], 22: [1, 13], 23: [1, 14], 25: [1, 15] }, { 5: [2, 13], 14: [2, 13], 15: [2, 13], 16: [2, 13], 19: [2, 13], 20: [2, 13], 22: [2, 13], 23: [2, 13], 25: [2, 13] }, { 5: [2, 14], 14: [2, 14], 15: [2, 14], 16: [2, 14], 19: [2, 14], 20: [2, 14], 22: [2, 14], 23: [2, 14], 25: [2, 14] }, { 5: [2, 15], 14: [2, 15], 15: [2, 15], 16: [2, 15], 19: [2, 15], 20: [2, 15], 22: [2, 15], 23: [2, 15], 25: [2, 15] }, { 5: [2, 16], 14: [2, 16], 15: [2, 16], 16: [2, 16], 19: [2, 16], 20: [2, 16], 22: [2, 16], 23: [2, 16], 25: [2, 16] }, { 17: 23, 21: 24, 30: 25, 40: [1, 28], 42: [1, 27], 43: 26 }, { 17: 29, 21: 24, 30: 25, 40: [1, 28], 42: [1, 27], 43: 26 }, { 17: 30, 21: 24, 30: 25, 40: [1, 28], 42: [1, 27], 43: 26 }, { 17: 31, 21: 24, 30: 25, 40: [1, 28], 42: [1, 27], 43: 26 }, { 21: 33, 26: 32, 32: [1, 34], 33: [1, 35], 40: [1, 28], 43: 26 }, { 1: [2, 1] }, { 5: [2, 10], 14: [2, 10], 15: [2, 10], 16: [2, 10], 19: [2, 10], 20: [2, 10], 22: [2, 10], 23: [2, 10], 25: [2, 10] }, { 10: 36, 20: [1, 37] }, { 4: 38, 8: 4, 9: 5, 11: 6, 12: 7, 13: 8, 14: [1, 9], 15: [1, 10], 16: [1, 12], 19: [1, 11], 20: [2, 7], 22: [1, 13], 23: [1, 14], 25: [1, 15] }, { 7: 39, 8: 17, 9: 5, 11: 6, 12: 7, 13: 8, 14: [1, 9], 15: [1, 10], 16: [1, 12], 19: [1, 21], 20: [2, 6], 22: [1, 13], 23: [1, 14], 25: [1, 15] }, { 17: 23, 18: [1, 40], 21: 24, 30: 25, 40: [1, 28], 42: [1, 27], 43: 26 }, { 10: 41, 20: [1, 37] }, { 18: [1, 42] }, { 18: [2, 43], 24: [2, 43], 28: 43, 32: [2, 43], 33: [2, 43], 34: [2, 43], 35: [2, 43], 36: [2, 43], 40: [2, 43], 42: [2, 43] }, { 18: [2, 25], 24: [2, 25], 36: [2, 25] }, { 18: [2, 38], 24: [2, 38], 32: [2, 38], 33: [2, 38], 34: [2, 38], 35: [2, 38], 36: [2, 38], 40: [2, 38], 42: [2, 38], 44: [1, 44] }, { 21: 45, 40: [1, 28], 43: 26 }, { 18: [2, 40], 24: [2, 40], 32: [2, 40], 33: [2, 40], 34: [2, 40], 35: [2, 40], 36: [2, 40], 40: [2, 40], 42: [2, 40], 44: [2, 40] }, { 18: [1, 46] }, { 18: [1, 47] }, { 24: [1, 48] }, { 18: [2, 41], 21: 50, 27: 49, 40: [1, 28], 43: 26 }, { 18: [2, 34], 40: [2, 34] }, { 18: [2, 35], 40: [2, 35] }, { 18: [2, 36], 40: [2, 36] }, { 5: [2, 11], 14: [2, 11], 15: [2, 11], 16: [2, 11], 19: [2, 11], 20: [2, 11], 22: [2, 11], 23: [2, 11], 25: [2, 11] }, { 21: 51, 40: [1, 28], 43: 26 }, { 8: 17, 9: 5, 11: 6, 12: 7, 13: 8, 14: [1, 9], 15: [1, 10], 16: [1, 12], 19: [1, 11], 20: [2, 3], 22: [1, 13], 23: [1, 14], 25: [1, 15] }, { 4: 52, 8: 4, 9: 5, 11: 6, 12: 7, 13: 8, 14: [1, 9], 15: [1, 10], 16: [1, 12], 19: [1, 11], 20: [2, 5], 22: [1, 13], 23: [1, 14], 25: [1, 15] }, { 14: [2, 23], 15: [2, 23], 16: [2, 23], 19: [2, 23], 20: [2, 23], 22: [2, 23], 23: [2, 23], 25: [2, 23] }, { 5: [2, 12], 14: [2, 12], 15: [2, 12], 16: [2, 12], 19: [2, 12], 20: [2, 12], 22: [2, 12], 23: [2, 12], 25: [2, 12] }, { 14: [2, 18], 15: [2, 18], 16: [2, 18], 19: [2, 18], 20: [2, 18], 22: [2, 18], 23: [2, 18], 25: [2, 18] }, { 18: [2, 45], 21: 56, 24: [2, 45], 29: 53, 30: 60, 31: 54, 32: [1, 57], 33: [1, 58], 34: [1, 59], 35: [1, 61], 36: [2, 45], 37: 55, 38: 62, 39: 63, 40: [1, 64], 42: [1, 27], 43: 26 }, { 40: [1, 65] }, { 18: [2, 37], 24: [2, 37], 32: [2, 37], 33: [2, 37], 34: [2, 37], 35: [2, 37], 36: [2, 37], 40: [2, 37], 42: [2, 37] }, { 14: [2, 17], 15: [2, 17], 16: [2, 17], 19: [2, 17], 20: [2, 17], 22: [2, 17], 23: [2, 17], 25: [2, 17] }, { 5: [2, 20], 14: [2, 20], 15: [2, 20], 16: [2, 20], 19: [2, 20], 20: [2, 20], 22: [2, 20], 23: [2, 20], 25: [2, 20] }, { 5: [2, 21], 14: [2, 21], 15: [2, 21], 16: [2, 21], 19: [2, 21], 20: [2, 21], 22: [2, 21], 23: [2, 21], 25: [2, 21] }, { 18: [1, 66] }, { 18: [2, 42] }, { 18: [1, 67] }, { 8: 17, 9: 5, 11: 6, 12: 7, 13: 8, 14: [1, 9], 15: [1, 10], 16: [1, 12], 19: [1, 11], 20: [2, 4], 22: [1, 13], 23: [1, 14], 25: [1, 15] }, { 18: [2, 24], 24: [2, 24], 36: [2, 24] }, { 18: [2, 44], 24: [2, 44], 32: [2, 44], 33: [2, 44], 34: [2, 44], 35: [2, 44], 36: [2, 44], 40: [2, 44], 42: [2, 44] }, { 18: [2, 46], 24: [2, 46], 36: [2, 46] }, { 18: [2, 26], 24: [2, 26], 32: [2, 26], 33: [2, 26], 34: [2, 26], 35: [2, 26], 36: [2, 26], 40: [2, 26], 42: [2, 26] }, { 18: [2, 27], 24: [2, 27], 32: [2, 27], 33: [2, 27], 34: [2, 27], 35: [2, 27], 36: [2, 27], 40: [2, 27], 42: [2, 27] }, { 18: [2, 28], 24: [2, 28], 32: [2, 28], 33: [2, 28], 34: [2, 28], 35: [2, 28], 36: [2, 28], 40: [2, 28], 42: [2, 28] }, { 18: [2, 29], 24: [2, 29], 32: [2, 29], 33: [2, 29], 34: [2, 29], 35: [2, 29], 36: [2, 29], 40: [2, 29], 42: [2, 29] }, { 18: [2, 30], 24: [2, 30], 32: [2, 30], 33: [2, 30], 34: [2, 30], 35: [2, 30], 36: [2, 30], 40: [2, 30], 42: [2, 30] }, { 17: 68, 21: 24, 30: 25, 40: [1, 28], 42: [1, 27], 43: 26 }, { 18: [2, 32], 24: [2, 32], 36: [2, 32], 39: 69, 40: [1, 70] }, { 18: [2, 47], 24: [2, 47], 36: [2, 47], 40: [2, 47] }, { 18: [2, 40], 24: [2, 40], 32: [2, 40], 33: [2, 40], 34: [2, 40], 35: [2, 40], 36: [2, 40], 40: [2, 40], 41: [1, 71], 42: [2, 40], 44: [2, 40] }, { 18: [2, 39], 24: [2, 39], 32: [2, 39], 33: [2, 39], 34: [2, 39], 35: [2, 39], 36: [2, 39], 40: [2, 39], 42: [2, 39], 44: [2, 39] }, { 5: [2, 22], 14: [2, 22], 15: [2, 22], 16: [2, 22], 19: [2, 22], 20: [2, 22], 22: [2, 22], 23: [2, 22], 25: [2, 22] }, { 5: [2, 19], 14: [2, 19], 15: [2, 19], 16: [2, 19], 19: [2, 19], 20: [2, 19], 22: [2, 19], 23: [2, 19], 25: [2, 19] }, { 36: [1, 72] }, { 18: [2, 48], 24: [2, 48], 36: [2, 48], 40: [2, 48] }, { 41: [1, 71] }, { 21: 56, 30: 60, 31: 73, 32: [1, 57], 33: [1, 58], 34: [1, 59], 35: [1, 61], 40: [1, 28], 42: [1, 27], 43: 26 }, { 18: [2, 31], 24: [2, 31], 32: [2, 31], 33: [2, 31], 34: [2, 31], 35: [2, 31], 36: [2, 31], 40: [2, 31], 42: [2, 31] }, { 18: [2, 33], 24: [2, 33], 36: [2, 33], 40: [2, 33] }], defaultActions: { 3: [2, 2], 16: [2, 1], 50: [2, 42] }, parseError: function (e) { throw new Error(e) }, parse: function (e) { function t() { var e; return e = n.lexer.lex() || 1, "number" != typeof e && (e = n.symbols_[e] || e), e } var n = this, i = [0], s = [null], r = [], o = this.table, a = "", l = 0, c = 0, u = 0; this.lexer.setInput(e), this.lexer.yy = this.yy, this.yy.lexer = this.lexer, this.yy.parser = this, "undefined" == typeof this.lexer.yylloc && (this.lexer.yylloc = {}); var h = this.lexer.yylloc; r.push(h); var d = this.lexer.options && this.lexer.options.ranges; "function" == typeof this.yy.parseError && (this.parseError = this.yy.parseError); for (var p, f, m, g, v, _, y, b, w, k = {}; ;) { if (m = i[i.length - 1], this.defaultActions[m] ? g = this.defaultActions[m] : ((null === p || "undefined" == typeof p) && (p = t()), g = o[m] && o[m][p]), "undefined" == typeof g || !g.length || !g[0]) { var x = ""; if (!u) { w = []; for (_ in o[m]) this.terminals_[_] && _ > 2 && w.push("'" + this.terminals_[_] + "'"); x = this.lexer.showPosition ? "Parse error on line " + (l + 1) + ":\n" + this.lexer.showPosition() + "\nExpecting " + w.join(", ") + ", got '" + (this.terminals_[p] || p) + "'" : "Parse error on line " + (l + 1) + ": Unexpected " + (1 == p ? "end of input" : "'" + (this.terminals_[p] || p) + "'"), this.parseError(x, { text: this.lexer.match, token: this.terminals_[p] || p, line: this.lexer.yylineno, loc: h, expected: w }) } } if (g[0] instanceof Array && g.length > 1) throw new Error("Parse Error: multiple actions possible at state: " + m + ", token: " + p); switch (g[0]) { case 1: i.push(p), s.push(this.lexer.yytext), r.push(this.lexer.yylloc), i.push(g[1]), p = null, f ? (p = f, f = null) : (c = this.lexer.yyleng, a = this.lexer.yytext, l = this.lexer.yylineno, h = this.lexer.yylloc, u > 0 && u--); break; case 2: if (y = this.productions_[g[1]][1], k.$ = s[s.length - y], k._$ = { first_line: r[r.length - (y || 1)].first_line, last_line: r[r.length - 1].last_line, first_column: r[r.length - (y || 1)].first_column, last_column: r[r.length - 1].last_column }, d && (k._$.range = [r[r.length - (y || 1)].range[0], r[r.length - 1].range[1]]), v = this.performAction.call(k, a, c, l, this.yy, g[1], s, r), "undefined" != typeof v) return v; y && (i = i.slice(0, -1 * y * 2), s = s.slice(0, -1 * y), r = r.slice(0, -1 * y)), i.push(this.productions_[g[1]][0]), s.push(k.$), r.push(k._$), b = o[i[i.length - 2]][i[i.length - 1]], i.push(b); break; case 3: return !0 } } return !0 } }, i = function () { var e = { EOF: 1, parseError: function (e, t) { if (!this.yy.parser) throw new Error(e); this.yy.parser.parseError(e, t) }, setInput: function (e) { return this._input = e, this._more = this._less = this.done = !1, this.yylineno = this.yyleng = 0, this.yytext = this.matched = this.match = "", this.conditionStack = ["INITIAL"], this.yylloc = { first_line: 1, first_column: 0, last_line: 1, last_column: 0 }, this.options.ranges && (this.yylloc.range = [0, 0]), this.offset = 0, this }, input: function () { var e = this._input[0]; this.yytext += e, this.yyleng++, this.offset++, this.match += e, this.matched += e; var t = e.match(/(?:\r\n?|\n).*/g); return t ? (this.yylineno++, this.yylloc.last_line++) : this.yylloc.last_column++, this.options.ranges && this.yylloc.range[1]++, this._input = this._input.slice(1), e }, unput: function (e) { var t = e.length, n = e.split(/(?:\r\n?|\n)/g); this._input = e + this._input, this.yytext = this.yytext.substr(0, this.yytext.length - t - 1), this.offset -= t; var i = this.match.split(/(?:\r\n?|\n)/g); this.match = this.match.substr(0, this.match.length - 1), this.matched = this.matched.substr(0, this.matched.length - 1), n.length - 1 && (this.yylineno -= n.length - 1); var s = this.yylloc.range; return this.yylloc = { first_line: this.yylloc.first_line, last_line: this.yylineno + 1, first_column: this.yylloc.first_column, last_column: n ? (n.length === i.length ? this.yylloc.first_column : 0) + i[i.length - n.length].length - n[0].length : this.yylloc.first_column - t }, this.options.ranges && (this.yylloc.range = [s[0], s[0] + this.yyleng - t]), this }, more: function () { return this._more = !0, this }, less: function (e) { this.unput(this.match.slice(e)) }, pastInput: function () { var e = this.matched.substr(0, this.matched.length - this.match.length); return (e.length > 20 ? "..." : "") + e.substr(-20).replace(/\n/g, "") }, upcomingInput: function () { var e = this.match; return e.length < 20 && (e += this._input.substr(0, 20 - e.length)), (e.substr(0, 20) + (e.length > 20 ? "..." : "")).replace(/\n/g, "") }, showPosition: function () { var e = this.pastInput(), t = new Array(e.length + 1).join("-"); return e + this.upcomingInput() + "\n" + t + "^" }, next: function () { if (this.done) return this.EOF; this._input || (this.done = !0); var e, t, n, i, s; this._more || (this.yytext = "", this.match = ""); for (var r = this._currentRules(), o = 0; o < r.length && (n = this._input.match(this.rules[r[o]]), !n || t && !(n[0].length > t[0].length) || (t = n, i = o, this.options.flex)) ; o++); return t ? (s = t[0].match(/(?:\r\n?|\n).*/g), s && (this.yylineno += s.length), this.yylloc = { first_line: this.yylloc.last_line, last_line: this.yylineno + 1, first_column: this.yylloc.last_column, last_column: s ? s[s.length - 1].length - s[s.length - 1].match(/\r?\n?/)[0].length : this.yylloc.last_column + t[0].length }, this.yytext += t[0], this.match += t[0], this.matches = t, this.yyleng = this.yytext.length, this.options.ranges && (this.yylloc.range = [this.offset, this.offset += this.yyleng]), this._more = !1, this._input = this._input.slice(t[0].length), this.matched += t[0], e = this.performAction.call(this, this.yy, this, r[i], this.conditionStack[this.conditionStack.length - 1]), this.done && this._input && (this.done = !1), e ? e : void 0) : "" === this._input ? this.EOF : this.parseError("Lexical error on line " + (this.yylineno + 1) + ". Unrecognized text.\n" + this.showPosition(), { text: "", token: null, line: this.yylineno }) }, lex: function () { var e = this.next(); return "undefined" != typeof e ? e : this.lex() }, begin: function (e) { this.conditionStack.push(e) }, popState: function () { return this.conditionStack.pop() }, _currentRules: function () { return this.conditions[this.conditionStack[this.conditionStack.length - 1]].rules }, topState: function () { return this.conditionStack[this.conditionStack.length - 2] }, pushState: function (e) { this.begin(e) } }; return e.options = {}, e.performAction = function (e, t, n, i) { function s(e, n) { return t.yytext = t.yytext.substr(e, t.yyleng - n) } switch (n) { case 0: if ("\\\\" === t.yytext.slice(-2) ? (s(0, 1), this.begin("mu")) : "\\" === t.yytext.slice(-1) ? (s(0, 1), this.begin("emu")) : this.begin("mu"), t.yytext) return 14; break; case 1: return 14; case 2: return this.popState(), 14; case 3: return s(0, 4), this.popState(), 15; case 4: return 35; case 5: return 36; case 6: return 25; case 7: return 16; case 8: return 20; case 9: return 19; case 10: return 19; case 11: return 23; case 12: return 22; case 13: this.popState(), this.begin("com"); break; case 14: return s(3, 5), this.popState(), 15; case 15: return 22; case 16: return 41; case 17: return 40; case 18: return 40; case 19: return 44; case 20: break; case 21: return this.popState(), 24; case 22: return this.popState(), 18; case 23: return t.yytext = s(1, 2).replace(/\\"/g, '"'), 32; case 24: return t.yytext = s(1, 2).replace(/\\'/g, "'"), 32; case 25: return 42; case 26: return 34; case 27: return 34; case 28: return 33; case 29: return 40; case 30: return t.yytext = s(1, 2), 40; case 31: return "INVALID"; case 32: return 5 } }, e.rules = [/^(?:[^\x00]*?(?=(\{\{)))/, /^(?:[^\x00]+)/, /^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/, /^(?:[\s\S]*?--\}\})/, /^(?:\()/, /^(?:\))/, /^(?:\{\{(~)?>)/, /^(?:\{\{(~)?#)/, /^(?:\{\{(~)?\/)/, /^(?:\{\{(~)?\^)/, /^(?:\{\{(~)?\s*else\b)/, /^(?:\{\{(~)?\{)/, /^(?:\{\{(~)?&)/, /^(?:\{\{!--)/, /^(?:\{\{![\s\S]*?\}\})/, /^(?:\{\{(~)?)/, /^(?:=)/, /^(?:\.\.)/, /^(?:\.(?=([=~}\s\/.)])))/, /^(?:[\/.])/, /^(?:\s+)/, /^(?:\}(~)?\}\})/, /^(?:(~)?\}\})/, /^(?:"(\\["]|[^"])*")/, /^(?:'(\\[']|[^'])*')/, /^(?:@)/, /^(?:true(?=([~}\s)])))/, /^(?:false(?=([~}\s)])))/, /^(?:-?[0-9]+(?=([~}\s)])))/, /^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)]))))/, /^(?:\[[^\]]*\])/, /^(?:.)/, /^(?:$)/], e.conditions = { mu: { rules: [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32], inclusive: !1 }, emu: { rules: [2], inclusive: !1 }, com: { rules: [3], inclusive: !1 }, INITIAL: { rules: [0, 1, 32], inclusive: !0 } }, e }(); return n.lexer = i, t.prototype = n, n.Parser = t, new t }(); return e = t }(), l = function (e, t) { "use strict"; function n(e) { return e.constructor === r.ProgramNode ? e : (s.yy = r, s.parse(e)) } var i = {}, s = e, r = t; return i.parser = s, i.parse = n, i }(a, o), c = function (e) {
                "use strict"; function t() { } function n(e, t, n) { if (null == e || "string" != typeof e && e.constructor !== n.AST.ProgramNode) throw new r("You must pass a string or Handlebars AST to Handlebars.precompile. You passed " + e); t = t || {}, "data" in t || (t.data = !0); var i = n.parse(e), s = (new n.Compiler).compile(i, t); return (new n.JavaScriptCompiler).compile(s, t) } function i(e, t, n) { function i() { var i = n.parse(e), s = (new n.Compiler).compile(i, t), r = (new n.JavaScriptCompiler).compile(s, t, void 0, !0); return n.template(r) } if (null == e || "string" != typeof e && e.constructor !== n.AST.ProgramNode) throw new r("You must pass a string or Handlebars AST to Handlebars.compile. You passed " + e); t = t || {}, "data" in t || (t.data = !0); var s; return function (e, t) { return s || (s = i()), s.call(this, e, t) } } var s = {}, r = e; return s.Compiler = t, t.prototype = {
                    compiler: t, disassemble: function () { for (var e, t, n, i = this.opcodes, s = [], r = 0, o = i.length; o > r; r++) if (e = i[r], "DECLARE" === e.opcode) s.push("DECLARE " + e.name + "=" + e.value); else { t = []; for (var a = 0; a < e.args.length; a++) n = e.args[a], "string" == typeof n && (n = '"' + n.replace("\n", "\\n") + '"'), t.push(n); s.push(e.opcode + " " + t.join(" ")) } return s.join("\n") }, equals: function (e) { var t = this.opcodes.length; if (e.opcodes.length !== t) return !1; for (var n = 0; t > n; n++) { var i = this.opcodes[n], s = e.opcodes[n]; if (i.opcode !== s.opcode || i.args.length !== s.args.length) return !1; for (var r = 0; r < i.args.length; r++) if (i.args[r] !== s.args[r]) return !1 } if (t = this.children.length, e.children.length !== t) return !1; for (n = 0; t > n; n++) if (!this.children[n].equals(e.children[n])) return !1; return !0 }, guid: 0, compile: function (e, t) { this.opcodes = [], this.children = [], this.depths = { list: [] }, this.options = t; var n = this.options.knownHelpers; if (this.options.knownHelpers = { helperMissing: !0, blockHelperMissing: !0, each: !0, "if": !0, unless: !0, "with": !0, log: !0 }, n) for (var i in n) this.options.knownHelpers[i] = n[i]; return this.accept(e) }, accept: function (e) { var t, n = e.strip || {}; return n.left && this.opcode("strip"), t = this[e.type](e), n.right && this.opcode("strip"), t }, program: function (e) { for (var t = e.statements, n = 0, i = t.length; i > n; n++) this.accept(t[n]); return this.isSimple = 1 === i, this.depths.list = this.depths.list.sort(function (e, t) { return e - t }), this }, compileProgram: function (e) { var t, n = (new this.compiler).compile(e, this.options), i = this.guid++; this.usePartial = this.usePartial || n.usePartial, this.children[i] = n; for (var s = 0, r = n.depths.list.length; r > s; s++) t = n.depths.list[s], 2 > t || this.addDepth(t - 1); return i }, block: function (e) {
                        var t = e.mustache, n = e.program, i = e.inverse; n && (n = this.compileProgram(n)), i && (i = this.compileProgram(i)); var s = t.sexpr, r = this.classifySexpr(s); "helper" === r ? this.helperSexpr(s, n, i) : "simple" === r ? (this.simpleSexpr(s), this.opcode("pushProgram", n), this.opcode("pushProgram", i), this.opcode("emptyHash"), this.opcode("blockValue")) : (this.ambiguousSexpr(s, n, i), this.opcode("pushProgram", n), this.opcode("pushProgram", i), this.opcode("emptyHash"), this.opcode("ambiguousBlockValue")), this.opcode("append")
                    }, hash: function (e) { var t, n, i = e.pairs; this.opcode("pushHash"); for (var s = 0, r = i.length; r > s; s++) t = i[s], n = t[1], this.options.stringParams ? (n.depth && this.addDepth(n.depth), this.opcode("getContext", n.depth || 0), this.opcode("pushStringParam", n.stringModeValue, n.type), "sexpr" === n.type && this.sexpr(n)) : this.accept(n), this.opcode("assignToHash", t[0]); this.opcode("popHash") }, partial: function (e) { var t = e.partialName; this.usePartial = !0, e.context ? this.ID(e.context) : this.opcode("push", "depth0"), this.opcode("invokePartial", t.name), this.opcode("append") }, content: function (e) { this.opcode("appendContent", e.string) }, mustache: function (e) { this.sexpr(e.sexpr), this.opcode(e.escaped && !this.options.noEscape ? "appendEscaped" : "append") }, ambiguousSexpr: function (e, t, n) { var i = e.id, s = i.parts[0], r = null != t || null != n; this.opcode("getContext", i.depth), this.opcode("pushProgram", t), this.opcode("pushProgram", n), this.opcode("invokeAmbiguous", s, r) }, simpleSexpr: function (e) { var t = e.id; "DATA" === t.type ? this.DATA(t) : t.parts.length ? this.ID(t) : (this.addDepth(t.depth), this.opcode("getContext", t.depth), this.opcode("pushContext")), this.opcode("resolvePossibleLambda") }, helperSexpr: function (e, t, n) { var i = this.setupFullMustacheParams(e, t, n), s = e.id.parts[0]; if (this.options.knownHelpers[s]) this.opcode("invokeKnownHelper", i.length, s); else { if (this.options.knownHelpersOnly) throw new r("You specified knownHelpersOnly, but used the unknown helper " + s, e); this.opcode("invokeHelper", i.length, s, e.isRoot) } }, sexpr: function (e) { var t = this.classifySexpr(e); "simple" === t ? this.simpleSexpr(e) : "helper" === t ? this.helperSexpr(e) : this.ambiguousSexpr(e) }, ID: function (e) { this.addDepth(e.depth), this.opcode("getContext", e.depth); var t = e.parts[0]; t ? this.opcode("lookupOnContext", e.parts[0]) : this.opcode("pushContext"); for (var n = 1, i = e.parts.length; i > n; n++) this.opcode("lookup", e.parts[n]) }, DATA: function (e) { if (this.options.data = !0, e.id.isScoped || e.id.depth) throw new r("Scoped data references are not supported: " + e.original, e); this.opcode("lookupData"); for (var t = e.id.parts, n = 0, i = t.length; i > n; n++) this.opcode("lookup", t[n]) }, STRING: function (e) { this.opcode("pushString", e.string) }, INTEGER: function (e) { this.opcode("pushLiteral", e.integer) }, BOOLEAN: function (e) { this.opcode("pushLiteral", e.bool) }, comment: function () { }, opcode: function (e) { this.opcodes.push({ opcode: e, args: [].slice.call(arguments, 1) }) }, declare: function (e, t) { this.opcodes.push({ opcode: "DECLARE", name: e, value: t }) }, addDepth: function (e) { 0 !== e && (this.depths[e] || (this.depths[e] = !0, this.depths.list.push(e))) }, classifySexpr: function (e) { var t = e.isHelper, n = e.eligibleHelper, i = this.options; if (n && !t) { var s = e.id.parts[0]; i.knownHelpers[s] ? t = !0 : i.knownHelpersOnly && (n = !1) } return t ? "helper" : n ? "ambiguous" : "simple" }, pushParams: function (e) { for (var t, n = e.length; n--;) t = e[n], this.options.stringParams ? (t.depth && this.addDepth(t.depth), this.opcode("getContext", t.depth || 0), this.opcode("pushStringParam", t.stringModeValue, t.type), "sexpr" === t.type && this.sexpr(t)) : this[t.type](t) }, setupFullMustacheParams: function (e, t, n) { var i = e.params; return this.pushParams(i), this.opcode("pushProgram", t), this.opcode("pushProgram", n), e.hash ? this.hash(e.hash) : this.opcode("emptyHash"), i }
                }, s.precompile = n, s.compile = i, s
            }(n), u = function (e, t) { "use strict"; function n(e) { this.value = e } function i() { } var s, r = e.COMPILER_REVISION, o = e.REVISION_CHANGES, a = e.log, l = t; i.prototype = { nameLookup: function (e, t) { var n, s; return 0 === e.indexOf("depth") && (n = !0), s = /^[0-9]+$/.test(t) ? e + "[" + t + "]" : i.isValidJavaScriptVariableName(t) ? e + "." + t : e + "['" + t + "']", n ? "(" + e + " && " + s + ")" : s }, compilerInfo: function () { var e = r, t = o[e]; return "this.compilerInfo = [" + e + ",'" + t + "'];\n" }, appendToBuffer: function (e) { return this.environment.isSimple ? "return " + e + ";" : { appendToBuffer: !0, content: e, toString: function () { return "buffer += " + e + ";" } } }, initializeBuffer: function () { return this.quotedString("") }, namespace: "Handlebars", compile: function (e, t, n, i) { this.environment = e, this.options = t || {}, a("debug", this.environment.disassemble() + "\n\n"), this.name = this.environment.name, this.isChild = !!n, this.context = n || { programs: [], environments: [], aliases: {} }, this.preamble(), this.stackSlot = 0, this.stackVars = [], this.registers = { list: [] }, this.hashes = [], this.compileStack = [], this.inlineStack = [], this.compileChildren(e, t); var s, r = e.opcodes; this.i = 0; for (var o = r.length; this.i < o; this.i++) s = r[this.i], "DECLARE" === s.opcode ? this[s.name] = s.value : this[s.opcode].apply(this, s.args), s.opcode !== this.stripNext && (this.stripNext = !1); if (this.pushSource(""), this.stackSlot || this.inlineStack.length || this.compileStack.length) throw new l("Compile completed with content left on stack"); return this.createFunctionContext(i) }, preamble: function () { var e = []; if (this.isChild) e.push(""); else { var t = this.namespace, n = "helpers = this.merge(helpers, " + t + ".helpers);"; this.environment.usePartial && (n = n + " partials = this.merge(partials, " + t + ".partials);"), this.options.data && (n += " data = data || {};"), e.push(n) } e.push(this.environment.isSimple ? "" : ", buffer = " + this.initializeBuffer()), this.lastContext = 0, this.source = e }, createFunctionContext: function (e) { var t = this.stackVars.concat(this.registers.list); if (t.length > 0 && (this.source[1] = this.source[1] + ", " + t.join(", ")), !this.isChild) for (var n in this.context.aliases) this.context.aliases.hasOwnProperty(n) && (this.source[1] = this.source[1] + ", " + n + "=" + this.context.aliases[n]); this.source[1] && (this.source[1] = "var " + this.source[1].substring(2) + ";"), this.isChild || (this.source[1] += "\n" + this.context.programs.join("\n") + "\n"), this.environment.isSimple || this.pushSource("return buffer;"); for (var i = this.isChild ? ["depth0", "data"] : ["Handlebars", "depth0", "helpers", "partials", "data"], s = 0, r = this.environment.depths.list.length; r > s; s++) i.push("depth" + this.environment.depths.list[s]); var o = this.mergeSource(); if (this.isChild || (o = this.compilerInfo() + o), e) return i.push(o), Function.apply(this, i); var l = "function " + (this.name || "") + "(" + i.join(",") + ") {\n  " + o + "}"; return a("debug", l + "\n\n"), l }, mergeSource: function () { for (var e, t = "", n = 0, i = this.source.length; i > n; n++) { var s = this.source[n]; s.appendToBuffer ? e = e ? e + "\n    + " + s.content : s.content : (e && (t += "buffer += " + e + ";\n  ", e = void 0), t += s + "\n  ") } return t }, blockValue: function () { this.context.aliases.blockHelperMissing = "helpers.blockHelperMissing"; var e = ["depth0"]; this.setupParams(0, e), this.replaceStack(function (t) { return e.splice(1, 0, t), "blockHelperMissing.call(" + e.join(", ") + ")" }) }, ambiguousBlockValue: function () { this.context.aliases.blockHelperMissing = "helpers.blockHelperMissing"; var e = ["depth0"]; this.setupParams(0, e); var t = this.topStack(); e.splice(1, 0, t), this.pushSource("if (!" + this.lastHelper + ") { " + t + " = blockHelperMissing.call(" + e.join(", ") + "); }") }, appendContent: function (e) { this.pendingContent && (e = this.pendingContent + e), this.stripNext && (e = e.replace(/^\s+/, "")), this.pendingContent = e }, strip: function () { this.pendingContent && (this.pendingContent = this.pendingContent.replace(/\s+$/, "")), this.stripNext = "strip" }, append: function () { this.flushInline(); var e = this.popStack(); this.pushSource("if(" + e + " || " + e + " === 0) { " + this.appendToBuffer(e) + " }"), this.environment.isSimple && this.pushSource("else { " + this.appendToBuffer("''") + " }") }, appendEscaped: function () { this.context.aliases.escapeExpression = "this.escapeExpression", this.pushSource(this.appendToBuffer("escapeExpression(" + this.popStack() + ")")) }, getContext: function (e) { this.lastContext !== e && (this.lastContext = e) }, lookupOnContext: function (e) { this.push(this.nameLookup("depth" + this.lastContext, e, "context")) }, pushContext: function () { this.pushStackLiteral("depth" + this.lastContext) }, resolvePossibleLambda: function () { this.context.aliases.functionType = '"function"', this.replaceStack(function (e) { return "typeof " + e + " === functionType ? " + e + ".apply(depth0) : " + e }) }, lookup: function (e) { this.replaceStack(function (t) { return t + " == null || " + t + " === false ? " + t + " : " + this.nameLookup(t, e, "context") }) }, lookupData: function () { this.pushStackLiteral("data") }, pushStringParam: function (e, t) { this.pushStackLiteral("depth" + this.lastContext), this.pushString(t), "sexpr" !== t && ("string" == typeof e ? this.pushString(e) : this.pushStackLiteral(e)) }, emptyHash: function () { this.pushStackLiteral("{}"), this.options.stringParams && (this.push("{}"), this.push("{}")) }, pushHash: function () { this.hash && this.hashes.push(this.hash), this.hash = { values: [], types: [], contexts: [] } }, popHash: function () { var e = this.hash; this.hash = this.hashes.pop(), this.options.stringParams && (this.push("{" + e.contexts.join(",") + "}"), this.push("{" + e.types.join(",") + "}")), this.push("{\n    " + e.values.join(",\n    ") + "\n  }") }, pushString: function (e) { this.pushStackLiteral(this.quotedString(e)) }, push: function (e) { return this.inlineStack.push(e), e }, pushLiteral: function (e) { this.pushStackLiteral(e) }, pushProgram: function (e) { this.pushStackLiteral(null != e ? this.programExpression(e) : null) }, invokeHelper: function (e, t, n) { this.context.aliases.helperMissing = "helpers.helperMissing", this.useRegister("helper"); var i = this.lastHelper = this.setupHelper(e, t, !0), s = this.nameLookup("depth" + this.lastContext, t, "context"), r = "helper = " + i.name + " || " + s; i.paramsInit && (r += "," + i.paramsInit), this.push("(" + r + ",helper ? helper.call(" + i.callParams + ") : helperMissing.call(" + i.helperMissingParams + "))"), n || this.flushInline() }, invokeKnownHelper: function (e, t) { var n = this.setupHelper(e, t); this.push(n.name + ".call(" + n.callParams + ")") }, invokeAmbiguous: function (e, t) { this.context.aliases.functionType = '"function"', this.useRegister("helper"), this.emptyHash(); var n = this.setupHelper(0, e, t), i = this.lastHelper = this.nameLookup("helpers", e, "helper"), s = this.nameLookup("depth" + this.lastContext, e, "context"), r = this.nextStack(); n.paramsInit && this.pushSource(n.paramsInit), this.pushSource("if (helper = " + i + ") { " + r + " = helper.call(" + n.callParams + "); }"), this.pushSource("else { helper = " + s + "; " + r + " = typeof helper === functionType ? helper.call(" + n.callParams + ") : helper; }") }, invokePartial: function (e) { var t = [this.nameLookup("partials", e, "partial"), "'" + e + "'", this.popStack(), "helpers", "partials"]; this.options.data && t.push("data"), this.context.aliases.self = "this", this.push("self.invokePartial(" + t.join(", ") + ")") }, assignToHash: function (e) { var t, n, i = this.popStack(); this.options.stringParams && (n = this.popStack(), t = this.popStack()); var s = this.hash; t && s.contexts.push("'" + e + "': " + t), n && s.types.push("'" + e + "': " + n), s.values.push("'" + e + "': (" + i + ")") }, compiler: i, compileChildren: function (e, t) { for (var n, i, s = e.children, r = 0, o = s.length; o > r; r++) { n = s[r], i = new this.compiler; var a = this.matchExistingProgram(n); null == a ? (this.context.programs.push(""), a = this.context.programs.length, n.index = a, n.name = "program" + a, this.context.programs[a] = i.compile(n, t, this.context), this.context.environments[a] = n) : (n.index = a, n.name = "program" + a) } }, matchExistingProgram: function (e) { for (var t = 0, n = this.context.environments.length; n > t; t++) { var i = this.context.environments[t]; if (i && i.equals(e)) return t } }, programExpression: function (e) { if (this.context.aliases.self = "this", null == e) return "self.noop"; for (var t, n = this.environment.children[e], i = n.depths.list, s = [n.index, n.name, "data"], r = 0, o = i.length; o > r; r++) t = i[r], s.push(1 === t ? "depth0" : "depth" + (t - 1)); return (0 === i.length ? "self.program(" : "self.programWithDepth(") + s.join(", ") + ")" }, register: function (e, t) { this.useRegister(e), this.pushSource(e + " = " + t + ";") }, useRegister: function (e) { this.registers[e] || (this.registers[e] = !0, this.registers.list.push(e)) }, pushStackLiteral: function (e) { return this.push(new n(e)) }, pushSource: function (e) { this.pendingContent && (this.source.push(this.appendToBuffer(this.quotedString(this.pendingContent))), this.pendingContent = void 0), e && this.source.push(e) }, pushStack: function (e) { this.flushInline(); var t = this.incrStack(); return e && this.pushSource(t + " = " + e + ";"), this.compileStack.push(t), t }, replaceStack: function (e) { var t, i, s, r = "", o = this.isInline(); if (o) { var a = this.popStack(!0); if (a instanceof n) t = a.value, s = !0; else { i = !this.stackSlot; var l = i ? this.incrStack() : this.topStackName(); r = "(" + this.push(l) + " = " + a + "),", t = this.topStack() } } else t = this.topStack(); var c = e.call(this, t); return o ? (s || this.popStack(), i && this.stackSlot--, this.push("(" + r + c + ")")) : (/^stack/.test(t) || (t = this.nextStack()), this.pushSource(t + " = (" + r + c + ");")), t }, nextStack: function () { return this.pushStack() }, incrStack: function () { return this.stackSlot++, this.stackSlot > this.stackVars.length && this.stackVars.push("stack" + this.stackSlot), this.topStackName() }, topStackName: function () { return "stack" + this.stackSlot }, flushInline: function () { var e = this.inlineStack; if (e.length) { this.inlineStack = []; for (var t = 0, i = e.length; i > t; t++) { var s = e[t]; s instanceof n ? this.compileStack.push(s) : this.pushStack(s) } } }, isInline: function () { return this.inlineStack.length }, popStack: function (e) { var t = this.isInline(), i = (t ? this.inlineStack : this.compileStack).pop(); if (!e && i instanceof n) return i.value; if (!t) { if (!this.stackSlot) throw new l("Invalid stack pop"); this.stackSlot-- } return i }, topStack: function (e) { var t = this.isInline() ? this.inlineStack : this.compileStack, i = t[t.length - 1]; return !e && i instanceof n ? i.value : i }, quotedString: function (e) { return '"' + e.replace(/\\/g, "\\\\").replace(/"/g, '\\"').replace(/\n/g, "\\n").replace(/\r/g, "\\r").replace(/\u2028/g, "\\u2028").replace(/\u2029/g, "\\u2029") + '"' }, setupHelper: function (e, t, n) { var i = [], s = this.setupParams(e, i, n), r = this.nameLookup("helpers", t, "helper"); return { params: i, paramsInit: s, name: r, callParams: ["depth0"].concat(i).join(", "), helperMissingParams: n && ["depth0", this.quotedString(t)].concat(i).join(", ") } }, setupOptions: function (e, t) { var n, i, s, r = [], o = [], a = []; r.push("hash:" + this.popStack()), this.options.stringParams && (r.push("hashTypes:" + this.popStack()), r.push("hashContexts:" + this.popStack())), i = this.popStack(), s = this.popStack(), (s || i) && (s || (this.context.aliases.self = "this", s = "self.noop"), i || (this.context.aliases.self = "this", i = "self.noop"), r.push("inverse:" + i), r.push("fn:" + s)); for (var l = 0; e > l; l++) n = this.popStack(), t.push(n), this.options.stringParams && (a.push(this.popStack()), o.push(this.popStack())); return this.options.stringParams && (r.push("contexts:[" + o.join(",") + "]"), r.push("types:[" + a.join(",") + "]")), this.options.data && r.push("data:data"), r }, setupParams: function (e, t, n) { var i = "{" + this.setupOptions(e, t).join(",") + "}"; return n ? (this.useRegister("options"), t.push("options"), "options=" + i) : (t.push(i), "") } }; for (var c = "break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield".split(" "), u = i.RESERVED_WORDS = {}, h = 0, d = c.length; d > h; h++) u[c[h]] = !0; return i.isValidJavaScriptVariableName = function (e) { return !i.RESERVED_WORDS[e] && /^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(e) ? !0 : !1 }, s = i }(i, n), h = function (e, t, n, i, s) { "use strict"; var r, o = e, a = t, l = n.parser, c = n.parse, u = i.Compiler, h = i.compile, d = i.precompile, p = s, f = o.create, m = function () { var e = f(); return e.compile = function (t, n) { return h(t, n, e) }, e.precompile = function (t, n) { return d(t, n, e) }, e.AST = a, e.Compiler = u, e.JavaScriptCompiler = p, e.Parser = l, e.parse = c, e }; return o = m(), o.create = m, r = o }(r, o, l, c, u); return h
        }(); return e
    }), define("hbs/underscore", {}), define("hbs/i18nprecompile", ["hbs/handlebars", "hbs/underscore"], function (e, t) { function n(i, s, r) { return r = r || {}, s = s || {}, i && "program" === i.type && i.statements && (t(i.statements).forEach(function (t, o) { var a = "<!-- i18n error -->"; if ("mustache" === t.type && t.id && "$" === t.id.original) { if (t.params.length && t.params[0].string) { var l = t.params[0].string; a = s[l] || (r.originalKeyFallback ? l : a) } i.statements[o] = new e.AST.ContentNode(a) } else t.program && (t.program = n(t.program, s, r)) }), i.inverse && n(i.inverse, s, r)), i } return function (t, i, s) { s = s || {}; var r, o; return r = e.parse(t), i !== !1 && (r = n(r, i, s)), o = (new e.Compiler).compile(r, s), (new e.JavaScriptCompiler).compile(o, s) } }), function (window) { var JSON = window.JSON || {}; !function () { "use strict"; function f(e) { return 10 > e ? "0" + e : e } function quote(e) { return escapable.lastIndex = 0, escapable.test(e) ? '"' + e.replace(escapable, function (e) { var t = meta[e]; return "string" == typeof t ? t : "\\u" + ("0000" + e.charCodeAt(0).toString(16)).slice(-4) }) + '"' : '"' + e + '"' } function str(e, t) { var n, i, s, r, o, a = gap, l = t[e]; switch (l && "object" == typeof l && "function" == typeof l.toJSON && (l = l.toJSON(e)), "function" == typeof rep && (l = rep.call(t, e, l)), typeof l) { case "string": return quote(l); case "number": return isFinite(l) ? String(l) : "null"; case "boolean": case "null": return String(l); case "object": if (!l) return "null"; if (gap += indent, o = [], "[object Array]" === Object.prototype.toString.apply(l)) { for (r = l.length, n = 0; r > n; n += 1) o[n] = str(n, l) || "null"; return s = 0 === o.length ? "[]" : gap ? "[\n" + gap + o.join(",\n" + gap) + "\n" + a + "]" : "[" + o.join(",") + "]", gap = a, s } if (rep && "object" == typeof rep) for (r = rep.length, n = 0; r > n; n += 1) "string" == typeof rep[n] && (i = rep[n], s = str(i, l), s && o.push(quote(i) + (gap ? ": " : ":") + s)); else for (i in l) Object.prototype.hasOwnProperty.call(l, i) && (s = str(i, l), s && o.push(quote(i) + (gap ? ": " : ":") + s)); return s = 0 === o.length ? "{}" : gap ? "{\n" + gap + o.join(",\n" + gap) + "\n" + a + "}" : "{" + o.join(",") + "}", gap = a, s } } "function" != typeof Date.prototype.toJSON && (Date.prototype.toJSON = function () { return isFinite(this.valueOf()) ? this.getUTCFullYear() + "-" + f(this.getUTCMonth() + 1) + "-" + f(this.getUTCDate()) + "T" + f(this.getUTCHours()) + ":" + f(this.getUTCMinutes()) + ":" + f(this.getUTCSeconds()) + "Z" : null }, String.prototype.toJSON = Number.prototype.toJSON = Boolean.prototype.toJSON = function () { return this.valueOf() }); var cx = /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g, escapable = /[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g, gap, indent, meta = { "\b": "\\b", "	": "\\t", "\n": "\\n", "\f": "\\f", "\r": "\\r", '"': '\\"', "\\": "\\\\" }, rep; "function" != typeof JSON.stringify && (JSON.stringify = function (e, t, n) { var i; if (gap = "", indent = "", "number" == typeof n) for (i = 0; n > i; i += 1) indent += " "; else "string" == typeof n && (indent = n); if (rep = t, t && "function" != typeof t && ("object" != typeof t || "number" != typeof t.length)) throw new Error("JSON.stringify"); return str("", { "": e }) }), "function" != typeof JSON.parse && (JSON.parse = function (text, reviver) { function walk(e, t) { var n, i, s = e[t]; if (s && "object" == typeof s) for (n in s) Object.prototype.hasOwnProperty.call(s, n) && (i = walk(s, n), void 0 !== i ? s[n] = i : delete s[n]); return reviver.call(e, t, s) } var j; if (text = String(text), cx.lastIndex = 0, cx.test(text) && (text = text.replace(cx, function (e) { return "\\u" + ("0000" + e.charCodeAt(0).toString(16)).slice(-4) })), /^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, "@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, "]").replace(/(?:^|:|,)(?:\s*\[)+/g, ""))) return j = eval("(" + text + ")"), "function" == typeof reviver ? walk({ "": j }, "") : j; throw new SyntaxError("JSON.parse") }) }(), define("hbs/json2", [], function () { return JSON }) }.call(this, this), define("hbs", { load: function (e) { throw new Error("Dynamic load not allowed: " + e) } }), define("hbs!templates/talkArticle", ["hbs", "hbs/handlebars"], function (e, t) { var n = t.template(function (e, t, n) { return this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers), '<div class="talk-article">\n  <div class="container">\n    <div class="talk-article__container">\n    </div>\n  </div>\n</div>\n' }); return n }), function (e, t) { "object" == typeof exports ? module.exports = t() : "function" == typeof define && define.amd ? define("spinjs", t) : e.Spinner = t() }(this, function () { "use strict"; function e(e, t) { var n, i = document.createElement(e || "div"); for (n in t) i[n] = t[n]; return i } function t(e) { for (var t = 1, n = arguments.length; n > t; t++) e.appendChild(arguments[t]); return e } function n(e, t, n, i) { var s = ["opacity", t, ~~(100 * e), n, i].join("-"), r = .01 + n / i * 100, o = Math.max(1 - (1 - e) / t * (100 - r), e), a = u.substring(0, u.indexOf("Animation")).toLowerCase(), l = a && "-" + a + "-" || ""; return d[s] || (p.insertRule("@" + l + "keyframes " + s + "{0%{opacity:" + o + "}" + r + "%{opacity:" + e + "}" + (r + .01) + "%{opacity:1}" + (r + t) % 100 + "%{opacity:" + e + "}100%{opacity:" + o + "}}", p.cssRules.length), d[s] = 1), s } function i(e, t) { var n, i, s = e.style; for (t = t.charAt(0).toUpperCase() + t.slice(1), i = 0; i < h.length; i++) if (n = h[i] + t, void 0 !== s[n]) return n; return void 0 !== s[t] ? t : void 0 } function s(e, t) { for (var n in t) e.style[i(e, n) || n] = t[n]; return e } function r(e) { for (var t = 1; t < arguments.length; t++) { var n = arguments[t]; for (var i in n) void 0 === e[i] && (e[i] = n[i]) } return e } function o(e) { for (var t = { x: e.offsetLeft, y: e.offsetTop }; e = e.offsetParent;) t.x += e.offsetLeft, t.y += e.offsetTop; return t } function a(e, t) { return "string" == typeof e ? e : e[t % e.length] } function l(e) { return "undefined" == typeof this ? new l(e) : void (this.opts = r(e || {}, l.defaults, f)) } function c() { function n(t, n) { return e("<" + t + ' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">', n) } p.addRule(".spin-vml", "behavior:url(#default#VML)"), l.prototype.lines = function (e, i) { function r() { return s(n("group", { coordsize: u + " " + u, coordorigin: -c + " " + -c }), { width: u, height: u }) } function o(e, o, l) { t(d, t(s(r(), { rotation: 360 / i.lines * e + "deg", left: ~~o }), t(s(n("roundrect", { arcsize: i.corners }), { width: c, height: i.width, left: i.radius, top: -i.width >> 1, filter: l }), n("fill", { color: a(i.color, e), opacity: i.opacity }), n("stroke", { opacity: 0 })))) } var l, c = i.length + i.width, u = 2 * c, h = 2 * -(i.width + i.length) + "px", d = s(r(), { position: "absolute", top: h, left: h }); if (i.shadow) for (l = 1; l <= i.lines; l++) o(l, -2, "progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)"); for (l = 1; l <= i.lines; l++) o(l); return t(e, d) }, l.prototype.opacity = function (e, t, n, i) { var s = e.firstChild; i = i.shadow && i.lines || 0, s && t + i < s.childNodes.length && (s = s.childNodes[t + i], s = s && s.firstChild, s = s && s.firstChild, s && (s.opacity = n)) } } var u, h = ["webkit", "Moz", "ms", "O"], d = {}, p = function () { var n = e("style", { type: "text/css" }); return t(document.getElementsByTagName("head")[0], n), n.sheet || n.styleSheet }(), f = { lines: 12, length: 7, width: 5, radius: 10, rotate: 0, corners: 1, color: "#000", direction: 1, speed: 1, trail: 100, opacity: .25, fps: 20, zIndex: 2e9, className: "spinner", top: "auto", left: "auto", position: "relative" }; l.defaults = {}, r(l.prototype, { spin: function (t) { this.stop(); var n, i, r = this, a = r.opts, l = r.el = s(e(0, { className: a.className }), { position: a.position, width: 0, zIndex: a.zIndex }), c = a.radius + a.length + a.width; if (t && (t.insertBefore(l, t.firstChild || null), i = o(t), n = o(l), s(l, { left: ("auto" == a.left ? i.x - n.x + (t.offsetWidth >> 1) : parseInt(a.left, 10) + c) + "px", top: ("auto" == a.top ? i.y - n.y + (t.offsetHeight >> 1) : parseInt(a.top, 10) + c) + "px" })), l.setAttribute("role", "progressbar"), r.lines(l, r.opts), !u) { var h, d = 0, p = (a.lines - 1) * (1 - a.direction) / 2, f = a.fps, m = f / a.speed, g = (1 - a.opacity) / (m * a.trail / 100), v = m / a.lines; !function _() { d++; for (var e = 0; e < a.lines; e++) h = Math.max(1 - (d + (a.lines - e) * v) % m * g, a.opacity), r.opacity(l, e * a.direction + p, h, a); r.timeout = r.el && setTimeout(_, ~~(1e3 / f)) }() } return r }, stop: function () { var e = this.el; return e && (clearTimeout(this.timeout), e.parentNode && e.parentNode.removeChild(e), this.el = void 0), this }, lines: function (i, r) { function o(t, n) { return s(e(), { position: "absolute", width: r.length + r.width + "px", height: r.width + "px", background: t, boxShadow: n, transformOrigin: "left", transform: "rotate(" + ~~(360 / r.lines * c + r.rotate) + "deg) translate(" + r.radius + "px,0)", borderRadius: (r.corners * r.width >> 1) + "px" }) } for (var l, c = 0, h = (r.lines - 1) * (1 - r.direction) / 2; c < r.lines; c++) l = s(e(), { position: "absolute", top: 1 + ~(r.width / 2) + "px", transform: r.hwaccel ? "translate3d(0,0,0)" : "", opacity: r.opacity, animation: u && n(r.opacity, r.trail, h + c * r.direction, r.lines) + " " + 1 / r.speed + "s linear infinite" }), r.shadow && t(l, s(o("#000", "0 0 4px #000"), { top: "2px" })), t(i, t(l, o(a(r.color, c), "0 0 1px rgba(0,0,0,.1)"))); return i }, opacity: function (e, t, n) { t < e.childNodes.length && (e.childNodes[t].style.opacity = n) } }); var m = s(e("group"), { behavior: "url(#default#VML)" }); return !i(m, "transform") && m.adj ? c() : u = i(m, "animation"), l }), define("jqueryui/widget", ["jquery"], function () { return function (e, t) { var n = 0, i = Array.prototype.slice, s = e.cleanData; e.cleanData = function (t) { for (var n, i = 0; null != (n = t[i]) ; i++) try { e(n).triggerHandler("remove") } catch (r) { } s(t) }, e.widget = function (t, n, i) { var s, r, o, a, l = {}, c = t.split(".")[0]; t = t.split(".")[1], s = c + "-" + t, i || (i = n, n = e.Widget), e.expr[":"][s.toLowerCase()] = function (t) { return !!e.data(t, s) }, e[c] = e[c] || {}, r = e[c][t], o = e[c][t] = function (e, t) { return this._createWidget ? void (arguments.length && this._createWidget(e, t)) : new o(e, t) }, e.extend(o, r, { version: i.version, _proto: e.extend({}, i), _childConstructors: [] }), a = new n, a.options = e.widget.extend({}, a.options), e.each(i, function (t, i) { return e.isFunction(i) ? void (l[t] = function () { var e = function () { return n.prototype[t].apply(this, arguments) }, s = function (e) { return n.prototype[t].apply(this, e) }; return function () { var t, n = this._super, r = this._superApply; return this._super = e, this._superApply = s, t = i.apply(this, arguments), this._super = n, this._superApply = r, t } }()) : void (l[t] = i) }), o.prototype = e.widget.extend(a, { widgetEventPrefix: r ? a.widgetEventPrefix || t : t }, l, { constructor: o, namespace: c, widgetName: t, widgetFullName: s }), r ? (e.each(r._childConstructors, function (t, n) { var i = n.prototype; e.widget(i.namespace + "." + i.widgetName, o, n._proto) }), delete r._childConstructors) : n._childConstructors.push(o), e.widget.bridge(t, o) }, e.widget.extend = function (n) { for (var s, r, o = i.call(arguments, 1), a = 0, l = o.length; l > a; a++) for (s in o[a]) r = o[a][s], o[a].hasOwnProperty(s) && r !== t && (n[s] = e.isPlainObject(r) ? e.isPlainObject(n[s]) ? e.widget.extend({}, n[s], r) : e.widget.extend({}, r) : r); return n }, e.widget.bridge = function (n, s) { var r = s.prototype.widgetFullName || n; e.fn[n] = function (o) { var a = "string" == typeof o, l = i.call(arguments, 1), c = this; return o = !a && l.length ? e.widget.extend.apply(null, [o].concat(l)) : o, this.each(a ? function () { var i, s = e.data(this, r); return s ? e.isFunction(s[o]) && "_" !== o.charAt(0) ? (i = s[o].apply(s, l), i !== s && i !== t ? (c = i && i.jquery ? c.pushStack(i.get()) : i, !1) : void 0) : e.error("no such method '" + o + "' for " + n + " widget instance") : e.error("cannot call methods on " + n + " prior to initialization; attempted to call method '" + o + "'") } : function () { var t = e.data(this, r); t ? t.option(o || {})._init() : e.data(this, r, new s(o, this)) }), c } }, e.Widget = function () { }, e.Widget._childConstructors = [], e.Widget.prototype = { widgetName: "widget", widgetEventPrefix: "", defaultElement: "<div>", options: { disabled: !1, create: null }, _createWidget: function (t, i) { i = e(i || this.defaultElement || this)[0], this.element = e(i), this.uuid = n++, this.eventNamespace = "." + this.widgetName + this.uuid, this.options = e.widget.extend({}, this.options, this._getCreateOptions(), t), this.bindings = e(), this.hoverable = e(), this.focusable = e(), i !== this && (e.data(i, this.widgetFullName, this), this._on(!0, this.element, { remove: function (e) { e.target === i && this.destroy() } }), this.document = e(i.style ? i.ownerDocument : i.document || i), this.window = e(this.document[0].defaultView || this.document[0].parentWindow)), this._create(), this._trigger("create", null, this._getCreateEventData()), this._init() }, _getCreateOptions: e.noop, _getCreateEventData: e.noop, _create: e.noop, _init: e.noop, destroy: function () { this._destroy(), this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)), this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName + "-disabled ui-state-disabled"), this.bindings.unbind(this.eventNamespace), this.hoverable.removeClass("ui-state-hover"), this.focusable.removeClass("ui-state-focus") }, _destroy: e.noop, widget: function () { return this.element }, option: function (n, i) { var s, r, o, a = n; if (0 === arguments.length) return e.widget.extend({}, this.options); if ("string" == typeof n) if (a = {}, s = n.split("."), n = s.shift(), s.length) { for (r = a[n] = e.widget.extend({}, this.options[n]), o = 0; o < s.length - 1; o++) r[s[o]] = r[s[o]] || {}, r = r[s[o]]; if (n = s.pop(), 1 === arguments.length) return r[n] === t ? null : r[n]; r[n] = i } else { if (1 === arguments.length) return this.options[n] === t ? null : this.options[n]; a[n] = i } return this._setOptions(a), this }, _setOptions: function (e) { var t; for (t in e) this._setOption(t, e[t]); return this }, _setOption: function (e, t) { return this.options[e] = t, "disabled" === e && (this.widget().toggleClass(this.widgetFullName + "-disabled ui-state-disabled", !!t).attr("aria-disabled", t), this.hoverable.removeClass("ui-state-hover"), this.focusable.removeClass("ui-state-focus")), this }, enable: function () { return this._setOption("disabled", !1) }, disable: function () { return this._setOption("disabled", !0) }, _on: function (t, n, i) { var s, r = this; "boolean" != typeof t && (i = n, n = t, t = !1), i ? (n = s = e(n), this.bindings = this.bindings.add(n)) : (i = n, n = this.element, s = this.widget()), e.each(i, function (i, o) { function a() { return t || r.options.disabled !== !0 && !e(this).hasClass("ui-state-disabled") ? ("string" == typeof o ? r[o] : o).apply(r, arguments) : void 0 } "string" != typeof o && (a.guid = o.guid = o.guid || a.guid || e.guid++); var l = i.match(/^(\w+)\s*(.*)$/), c = l[1] + r.eventNamespace, u = l[2]; u ? s.delegate(u, c, a) : n.bind(c, a) }) }, _off: function (e, t) { t = (t || "").split(" ").join(this.eventNamespace + " ") + this.eventNamespace, e.unbind(t).undelegate(t) }, _delay: function (e, t) { function n() { return ("string" == typeof e ? i[e] : e).apply(i, arguments) } var i = this; return setTimeout(n, t || 0) }, _hoverable: function (t) { this.hoverable = this.hoverable.add(t), this._on(t, { mouseenter: function (t) { e(t.currentTarget).addClass("ui-state-hover") }, mouseleave: function (t) { e(t.currentTarget).removeClass("ui-state-hover") } }) }, _focusable: function (t) { this.focusable = this.focusable.add(t), this._on(t, { focusin: function (t) { e(t.currentTarget).addClass("ui-state-focus") }, focusout: function (t) { e(t.currentTarget).removeClass("ui-state-focus") } }) }, _trigger: function (t, n, i) { var s, r, o = this.options[t]; if (i = i || {}, n = e.Event(n), n.type = (t === this.widgetEventPrefix ? t : this.widgetEventPrefix + t).toLowerCase(), n.target = this.element[0], r = n.originalEvent) for (s in r) s in n || (n[s] = r[s]); return this.element.trigger(n, i), !(e.isFunction(o) && o.apply(this.element[0], [n].concat(i)) === !1 || n.isDefaultPrevented()) } }, e.each({ show: "fadeIn", hide: "fadeOut" }, function (t, n) { e.Widget.prototype["_" + t] = function (i, s, r) { "string" == typeof s && (s = { effect: s }); var o, a = s ? s === !0 || "number" == typeof s ? n : s.effect || n : t; s = s || {}, "number" == typeof s && (s = { duration: s }), o = !e.isEmptyObject(s), s.complete = r, s.delay && i.delay(s.delay), o && e.effects && e.effects.effect[a] ? i[t](s) : a !== t && i[a] ? i[a](s.duration, s.easing, r) : i.queue(function (n) { e(this)[t](), r && r.call(i[0]), n() }) } }) }(jQuery), jQuery }), define("transit", ["jquery"], function () {
        return function (e) {
            function t(e) { if (e in h.style) return e; var t = ["Moz", "Webkit", "O", "ms"], n = e.charAt(0).toUpperCase() + e.substr(1); if (e in h.style) return e; for (var i = 0; i < t.length; ++i) { var s = t[i] + n; if (s in h.style) return s } } function n() { return h.style[d.transform] = "", h.style[d.transform] = "rotateY(90deg)", "" !== h.style[d.transform] } function i(e) { return "string" == typeof e && this.parse(e), this } function s(e, t, n) { t === !0 ? e.queue(n) : t ? e.queue(t, n) : n() } function r(t) { var n = []; return e.each(t, function (t) { t = e.camelCase(t), t = e.transit.propertyMap[t] || e.cssProps[t] || t, t = l(t), -1 === e.inArray(t, n) && n.push(t) }), n } function o(t, n, i, s) { var o = r(t); e.cssEase[i] && (i = e.cssEase[i]); var a = "" + u(n) + " " + i; parseInt(s, 10) > 0 && (a += " " + u(s)); var l = []; return e.each(o, function (e, t) { l.push(t + " " + a) }), l.join(", ") } function a(t, n) { n || (e.cssNumber[t] = !0), e.transit.propertyMap[t] = d.transform, e.cssHooks[t] = { get: function (n) { var i = e(n).css("transit:transform"); return i.get(t) }, set: function (n, i) { var s = e(n).css("transit:transform"); s.setFromString(t, i), e(n).css({ "transit:transform": s }) } } } function l(e) { return e.replace(/([A-Z])/g, function (e) { return "-" + e.toLowerCase() }) } function c(e, t) { return "string" != typeof e || e.match(/^[\-0-9\.]+$/) ? "" + e + t : e } function u(t) { var n = t; return e.fx.speeds[n] && (n = e.fx.speeds[n]), c(n, "ms") } e.transit = { version: "0.9.9", propertyMap: { marginLeft: "margin", marginRight: "margin", marginBottom: "margin", marginTop: "margin", paddingLeft: "padding", paddingRight: "padding", paddingBottom: "padding", paddingTop: "padding" }, enabled: !0, useTransitionEnd: !1 }; var h = document.createElement("div"), d = {}, p = navigator.userAgent.toLowerCase().indexOf("chrome") > -1; d.transition = t("transition"), d.transitionDelay = t("transitionDelay"), d.transform = t("transform"), d.transformOrigin = t("transformOrigin"), d.transform3d = n(); var f = { transition: "transitionEnd", MozTransition: "transitionend", OTransition: "oTransitionEnd", WebkitTransition: "webkitTransitionEnd", msTransition: "MSTransitionEnd" }, m = d.transitionEnd = f[d.transition] || null;
            for (var g in d) d.hasOwnProperty(g) && "undefined" == typeof e.support[g] && (e.support[g] = d[g]); h = null, e.cssEase = { _default: "ease", "in": "ease-in", out: "ease-out", "in-out": "ease-in-out", snap: "cubic-bezier(0,1,.5,1)", easeOutCubic: "cubic-bezier(.215,.61,.355,1)", easeInOutCubic: "cubic-bezier(.645,.045,.355,1)", easeInCirc: "cubic-bezier(.6,.04,.98,.335)", easeOutCirc: "cubic-bezier(.075,.82,.165,1)", easeInOutCirc: "cubic-bezier(.785,.135,.15,.86)", easeInExpo: "cubic-bezier(.95,.05,.795,.035)", easeOutExpo: "cubic-bezier(.19,1,.22,1)", easeInOutExpo: "cubic-bezier(1,0,0,1)", easeInQuad: "cubic-bezier(.55,.085,.68,.53)", easeOutQuad: "cubic-bezier(.25,.46,.45,.94)", easeInOutQuad: "cubic-bezier(.455,.03,.515,.955)", easeInQuart: "cubic-bezier(.895,.03,.685,.22)", easeOutQuart: "cubic-bezier(.165,.84,.44,1)", easeInOutQuart: "cubic-bezier(.77,0,.175,1)", easeInQuint: "cubic-bezier(.755,.05,.855,.06)", easeOutQuint: "cubic-bezier(.23,1,.32,1)", easeInOutQuint: "cubic-bezier(.86,0,.07,1)", easeInSine: "cubic-bezier(.47,0,.745,.715)", easeOutSine: "cubic-bezier(.39,.575,.565,1)", easeInOutSine: "cubic-bezier(.445,.05,.55,.95)", easeInBack: "cubic-bezier(.6,-.28,.735,.045)", easeOutBack: "cubic-bezier(.175, .885,.32,1.275)", easeInOutBack: "cubic-bezier(.68,-.55,.265,1.55)" }, e.cssHooks["transit:transform"] = { get: function (t) { return e(t).data("transform") || new i }, set: function (t, n) { var s = n; s instanceof i || (s = new i(s)), t.style[d.transform] = "WebkitTransform" !== d.transform || p ? s.toString() : s.toString(!0), e(t).data("transform", s) } }, e.cssHooks.transform = { set: e.cssHooks["transit:transform"].set }, e.fn.jquery < "1.8" && (e.cssHooks.transformOrigin = { get: function (e) { return e.style[d.transformOrigin] }, set: function (e, t) { e.style[d.transformOrigin] = t } }, e.cssHooks.transition = { get: function (e) { return e.style[d.transition] }, set: function (e, t) { e.style[d.transition] = t } }), a("scale"), a("translate"), a("rotate"), a("rotateX"), a("rotateY"), a("rotate3d"), a("perspective"), a("skewX"), a("skewY"), a("x", !0), a("y", !0), i.prototype = { setFromString: function (e, t) { var n = "string" == typeof t ? t.split(",") : t.constructor === Array ? t : [t]; n.unshift(e), i.prototype.set.apply(this, n) }, set: function (e) { var t = Array.prototype.slice.apply(arguments, [1]); this.setter[e] ? this.setter[e].apply(this, t) : this[e] = t.join(",") }, get: function (e) { return this.getter[e] ? this.getter[e].apply(this) : this[e] || 0 }, setter: { rotate: function (e) { this.rotate = c(e, "deg") }, rotateX: function (e) { this.rotateX = c(e, "deg") }, rotateY: function (e) { this.rotateY = c(e, "deg") }, scale: function (e, t) { void 0 === t && (t = e), this.scale = e + "," + t }, skewX: function (e) { this.skewX = c(e, "deg") }, skewY: function (e) { this.skewY = c(e, "deg") }, perspective: function (e) { this.perspective = c(e, "px") }, x: function (e) { this.set("translate", e, null) }, y: function (e) { this.set("translate", null, e) }, translate: function (e, t) { void 0 === this._translateX && (this._translateX = 0), void 0 === this._translateY && (this._translateY = 0), null !== e && void 0 !== e && (this._translateX = c(e, "px")), null !== t && void 0 !== t && (this._translateY = c(t, "px")), this.translate = this._translateX + "," + this._translateY } }, getter: { x: function () { return this._translateX || 0 }, y: function () { return this._translateY || 0 }, scale: function () { var e = (this.scale || "1,1").split(","); return e[0] && (e[0] = parseFloat(e[0])), e[1] && (e[1] = parseFloat(e[1])), e[0] === e[1] ? e[0] : e }, rotate3d: function () { for (var e = (this.rotate3d || "0,0,0,0deg").split(","), t = 0; 3 >= t; ++t) e[t] && (e[t] = parseFloat(e[t])); return e[3] && (e[3] = c(e[3], "deg")), e } }, parse: function (e) { var t = this; e.replace(/([a-zA-Z0-9]+)\((.*?)\)/g, function (e, n, i) { t.setFromString(n, i) }) }, toString: function (e) { var t = []; for (var n in this) if (this.hasOwnProperty(n)) { if (!d.transform3d && ("rotateX" === n || "rotateY" === n || "perspective" === n || "transformOrigin" === n)) continue; "_" !== n[0] && t.push(e && "scale" === n ? n + "3d(" + this[n] + ",1)" : e && "translate" === n ? n + "3d(" + this[n] + ",0)" : n + "(" + this[n] + ")") } return t.join(" ") } }, e.fn.transition = e.fn.transit = function (t, n, i, r) { var a = this, l = 0, c = !0; "function" == typeof n && (r = n, n = void 0), "function" == typeof i && (r = i, i = void 0), "undefined" != typeof t.easing && (i = t.easing, delete t.easing), "undefined" != typeof t.duration && (n = t.duration, delete t.duration), "undefined" != typeof t.complete && (r = t.complete, delete t.complete), "undefined" != typeof t.queue && (c = t.queue, delete t.queue), "undefined" != typeof t.delay && (l = t.delay, delete t.delay), "undefined" == typeof n && (n = e.fx.speeds._default), "undefined" == typeof i && (i = e.cssEase._default), n = u(n); var h = o(t, n, i, l), p = e.transit.enabled && d.transition, f = p ? parseInt(n, 10) + parseInt(l, 10) : 0; if (0 === f) { var g = function (e) { a.css(t), r && r.apply(a), e && e() }; return s(a, c, g), a } var v = {}, _ = function (n) { var i = !1, s = function () { i && a.unbind(m, s), f > 0 && a.each(function () { this.style[d.transition] = v[this] || null }), "function" == typeof r && r.apply(a), "function" == typeof n && n() }; f > 0 && m && e.transit.useTransitionEnd ? (i = !0, a.bind(m, s)) : window.setTimeout(s, f), a.each(function () { f > 0 && (this.style[d.transition] = h), e(this).css(t) }) }, y = function (e) { var t = 0; "MozTransition" === d.transition && 25 > t && (t = 25), window.setTimeout(function () { _(e) }, t) }; return s(a, c, y), this }, e.transit.getTransitionValue = o
        }(jQuery), jQuery
    }), define("widgets/talkArticle", ["jquery", "lodash", "jqueryui/widget", "transit"], function (e, t) { "use strict"; function n() { r.show(), r.removeClass(u) } function i() { r.hide() } var s, r, o, a, l, c = 300, u = "talk-article--main--collapsed", h = t.once(function () { s = e("#talk-pusher"), r = e("#talk"), o = e("body,html"), a = e("#talk-hero"), l = a.find("div.talk-hero__banner") }); return e.widget("ted.talkArticle", { options: { autoShow: !0 }, _create: function () { var e = this; h(), this.element.hide(), r.after(this.element), this._on("a.talk-article__return__link", { click: function (t) { t.preventDefault(), e.hide() } }), this.options.autoShow && this.show() }, show: function () { this.element.fadeIn(c), r.addClass(u), s.transition({ duration: c, marginTop: 0 - r.outerHeight(), complete: i }), o.animate({ scrollTop: l.offset().top + l.outerHeight() }, c), this._trigger("show") }, hide: function () { this.element.fadeOut(c), r.show(), s.transition({ duration: c, marginTop: 0, complete: n }), this._trigger("hide") } }), function (t, n) { return e(t).talkArticle(n) } }), define("widgets/talkArticleLink", ["jquery", "lodash", "hbs!templates/talkArticle", "spinjs", "widgets/talkArticle"], function (e, t, n, i) { "use strict"; var s = "talk-article-link", r = "talk-article-link--loading"; return e.widget("ted.talkArticleLink", { options: { articleUrl: null, returnUrl: window.location.href, unpopped: !1 }, _create: function () { var e = this; this.options.articleUrl || (this.options.articleUrl = this.element.attr("href")), this.element.addClass(s), this._on(this.element, this._handleEvents), this._on(window, { popstate: function () { e.options.unpopped && (e.options.unpopped = !1, e.article.talkArticle("hide")) } }) }, _handleEvents: { click: function (e) { e.preventDefault(), this.showArticle() } }, _onShow: function () { this._trigger("show") }, _onHide: function () { window.history && history.pushState && this.options.unpopped && (this.options.unpopped = !1, history.back()), this._trigger("hide") }, article: null, loadUrl: function (s) { var o = this; o.article && o.article.remove(), o.article = e(n()).addClass("talk-article--loading"), o.article.talkArticle({ show: t.bind(o._onShow, o), hide: t.bind(o._onHide, o) }), this.article.talkArticle("show"), this._spinner || (this._spinner = new i), this._spinner.spin(o.article.find("div.talk-article__container")[0]), this.options.articleUrl = s, this.element.addClass(r), e.get(s).then(t.bind(this.loadHtml, this)) }, loadHtml: function (n) { var i = !0, s = this; window.history && window.history.pushState && !s.options.unpopped && (i = !1), s.article && (this._spinner.stop(), s.article.remove()), s.article = e(n).find("div.talk-article"), s.article.talkArticle({ autoShow: i, show: t.bind(s._onShow, s), hide: t.bind(s._onHide, s) }), s.element.removeClass(r) }, showArticle: function () { var e = this; e.element.hasClass(r) || (this.article ? this.article.talkArticle("show") : this.loadUrl(this.options.articleUrl), window.history && history.pushState && (history.pushState(null, null, this.options.articleUrl), this.options.unpopped = !0)) } }), function (t, n) { return e(t).talkArticle(n) } }), define("talk/transcript", ["jquery", "lodash", "lib/ga", "widgets/talkArticleLink"], function (e, t, n) { "use strict"; function i(e) { var n, i; return n = t.findIndex(_, function (t) { return i = t === e, i || t > e }), 1 > n && !i ? !1 : g.eq(n - (i ? 0 : 1)) } function s(t) { v = t, p = e("#open-transcript"), h(), p.talkArticleLink({ show: a }), p.on("click", function () { n.sendEvent("talk.transcript", "show", "talk details") }), e("#hero-transcript-link").on("click", function (e) { e.preventDefault(), p.data("ted-talkArticleLink").showArticle(), n.sendEvent("talk.transcript", "show", "hero") }), e("#talk-hero").on("click", "a.controls__transcript", function (e) { e.preventDefault(), p.data("ted-talkArticleLink").showArticle(), n.sendEvent("talk.transcript", "show", "controls") }) } function r() { d || (d = e("div.talk-transcript").first()), g = d.find("span.talk-transcript__fragment"), _ = g.map(function (t, n) { return +e(n).data("time") }).toArray(), d.on("click", "span.talk-transcript__fragment", l), k.player && k.player.on("playercurrenttime", function (e, t) { c(t.currentTime) }), c() } function o() { d && d.parent().length || (d = p.data("ted-talkArticleLink").article, r()) } function a() { o() } function l() { var t = +e(this).data("time"), i = Math.floor((v.offset + t) / 1e3); k.player && (k.player.player("seek", i), n.sendEvent("player", "seek", "transcript", i)), window.history && history.pushState && history.pushState(null, null, location.href.split("#")[0] + "#t-" + t) } function c(e) { e || (e = w), u(1e3 * e - v.offset), w = e } function u(e) { var t = i(e); t && t !== f && (f && (f.removeClass(y), m.removeClass(b)), f = t.addClass(y), m = t.closest("p.talk-transcript__para").addClass(b)) } function h() { e(document).on("change", "select.talk-transcript__language", function () { var t = e(this), n = "/talks/" + t.data("slug") + "/transcript?lang=" + t.val(); p ? p.talkArticleLink("loadUrl", n) : location.href = n }) } var d, p, f, m, g, v, _, y = "talk-transcript__fragment--current", b = "talk-transcript__para--current", w = 0, k = { player: null }; return k.initArticle = r, k.initLanguages = t.once(h), k.initLink = s, k }), define("widgets/ad", ["lodash", "jquery", "jqueryui/widget"], function (e, t) { "use strict"; t.widget("ted.ad", { _rendered: !1, $image: null, $text: null, $link: null, blocked: function () { this.element.hide() }, refresh: function () { if (this.options.blocked) return void this.blocked(); if (this._rendered || (this.element.addClass("ad"), this.element.html(""), this.options.ad.houseAd || (this.$text = t('<div class="ad__text">TED Talks are free thanks to our partners</div>').appendTo(this.element)), this.$link = t('<a class="ad__unit" href="#" rel="nofollow" target="_blank">').appendTo(this.element), this.$image = t("<img>").appendTo(this.$link), this._rendered = !0), !this.options.ad) return void this.element.hide(); var e = this._getRenderDetails(); this.$link.attr("href", e.click), this.$image.attr({ src: e.currentCreative.url, width: e.dimensions.width, height: e.dimensions.height }), this.element[this.options.ad.hasDisplay === !1 ? "hide" : "show"](), this._impress() }, _create: function () { this.refresh() }, _fireImpression: function (e) { var t = new Image; t.src = e }, _impress: function () { this._fireImpression(this.options.ad.impression), e.forEach(this.options.ad.thirdPartyImpressions, this._fireImpression) }, _getCreative: function () { var t = e.filter(this.options.ad.creative, function (e) { return "" !== e.url }), n = Math.max(window.devicePixelRatio || 1, 1); return e.reduce(t, function (e, t) { return t.density <= n ? t : e || t }, {}) }, _getRenderDetails: function () { return e.extend({ currentCreative: this._getCreative() }, this.options.ad) }, _setOption: function (e, t) { this._super(e, t), this.refresh() } }) }), define("hbs!templates/sponsorshipBug", ["hbs", "hbs/handlebars"], function (e, t) { var n = t.template(function (e, t, n) { this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var i = ""; return i += '\n\n<a class="sponsorship-bug__link media" href="#" rel="nofollow">\n  <div class="sponsorship-bug__image media__image media__image--alt">\n    <img src="" alt="">\n  </div>\n  <div class="sponsorship-bug__message media__message">\n    TED Talks are free<br>\n    thanks to our partners\n  </div>\n</a>\n' }); return n }), define("templates/helpers/assetUrl", ["Handlebars"], function (e) { "use strict"; function t(e) { return TED.assetHost + e } return e.registerHelper("assetUrl", t), t }), define("hbs!templates/sponsorshipBugBlocked", ["hbs", "hbs/handlebars", "templates/helpers/assetUrl"], function (e, t) { var n = t.template(function (e, t, n) { this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var i, s, r = "", o = n.helperMissing, a = this.escapeExpression; return r += '\n\n<a class="sponsorship-bug__nag" href="http://support.ted.com/customer/portal/articles/1532436-how-can-i-support-ted-by-modifying-my-ad-blocker-settings" target="_blank">\n  <img class="sponsorship-bug__nag__image" src="' + a((i = n.assetUrl || t && t.assetUrl, s = { hash: {} }, i ? i.call(t, "/temp/ad-blocker-bug.png", s) : o.call(t, "assetUrl", "/temp/ad-blocker-bug.png", s))) + '" alt="Show your support by unblocking ted.com from ad blockers">\n</a>\n' }); return n }), define("widgets/sponsorshipBug", ["jquery", "hbs!templates/sponsorshipBug", "hbs!templates/sponsorshipBugBlocked", "widgets/ad"], function (e, t, n) { "use strict"; e.widget("ted.sponsorshipBug", e.ted.ad, { blocked: function () { this.element.html(n()), this.element.show(), this._rendered = !1 }, refresh: function () { return this.options.blocked ? this.blocked() : (this._rendered || (this.element.html(t()), this.$image = this.element.find("img"), this.$link = this.element.find("a.sponsorship-bug__link"), this._rendered = !0), void this._super()) }, _create: function () { this.element.addClass("sponsorship-bug"), this.refresh() } }) }), define("lib/ads", ["jquery", "widgets/ad", "widgets/sponsorshipBug"], function (e) { "use strict"; function t(t) { var n = i[t.type]; void 0 === n ? window.console && console.log && (console.log("Unknown ad type"), console.log(t)) : e(n.id)[n.widget]({ ad: t }) } function n(n) { var r = s.player = n; r && (["flash", "hls"].indexOf(r.player("mode")) > -1 ? r.on({ playerad: function (e, n) { t(n.ad) }, playeradblock: function () { var t = i.bug; e(t.id)[t.widget]({ blocked: !0 }) } }) : googletag.cmd.push(function () { googletag.display("ad-unit") })) } var i = { bug: { id: "#sponsorship-bug-placeholder", widget: "sponsorshipBug" }, companion: { id: "#ad-unit", widget: "ad" }, "companion-mobile": { id: "#ad-unit-mobile", widget: "ad" }, devil: { id: "#devil-ad", widget: "ad" }, onPage: { id: "#ad-unit", widget: "ad" } }, s = { player: null }; return s.initPlayer = n, s.gptAd = function (e) { t(e.ad) }, s }), define("flot", ["jquery"], function () {
        return function (e) { e.color = {}, e.color.make = function (t, n, i, s) { var r = {}; return r.r = t || 0, r.g = n || 0, r.b = i || 0, r.a = null != s ? s : 1, r.add = function (e, t) { for (var n = 0; n < e.length; ++n) r[e.charAt(n)] += t; return r.normalize() }, r.scale = function (e, t) { for (var n = 0; n < e.length; ++n) r[e.charAt(n)] *= t; return r.normalize() }, r.toString = function () { return r.a >= 1 ? "rgb(" + [r.r, r.g, r.b].join(",") + ")" : "rgba(" + [r.r, r.g, r.b, r.a].join(",") + ")" }, r.normalize = function () { function e(e, t, n) { return e > t ? e : t > n ? n : t } return r.r = e(0, parseInt(r.r), 255), r.g = e(0, parseInt(r.g), 255), r.b = e(0, parseInt(r.b), 255), r.a = e(0, r.a, 1), r }, r.clone = function () { return e.color.make(r.r, r.b, r.g, r.a) }, r.normalize() }, e.color.extract = function (t, n) { var i; do { if (i = t.css(n).toLowerCase(), "" != i && "transparent" != i) break; t = t.parent() } while (t.length && !e.nodeName(t.get(0), "body")); return "rgba(0, 0, 0, 0)" == i && (i = "transparent"), e.color.parse(i) }, e.color.parse = function (n) { var i, s = e.color.make; if (i = /rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(n)) return s(parseInt(i[1], 10), parseInt(i[2], 10), parseInt(i[3], 10)); if (i = /rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(n)) return s(parseInt(i[1], 10), parseInt(i[2], 10), parseInt(i[3], 10), parseFloat(i[4])); if (i = /rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(n)) return s(2.55 * parseFloat(i[1]), 2.55 * parseFloat(i[2]), 2.55 * parseFloat(i[3])); if (i = /rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(n)) return s(2.55 * parseFloat(i[1]), 2.55 * parseFloat(i[2]), 2.55 * parseFloat(i[3]), parseFloat(i[4])); if (i = /#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(n)) return s(parseInt(i[1], 16), parseInt(i[2], 16), parseInt(i[3], 16)); if (i = /#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(n)) return s(parseInt(i[1] + i[1], 16), parseInt(i[2] + i[2], 16), parseInt(i[3] + i[3], 16)); var r = e.trim(n).toLowerCase(); return "transparent" == r ? s(255, 255, 255, 0) : (i = t[r] || [0, 0, 0], s(i[0], i[1], i[2])) }; var t = { aqua: [0, 255, 255], azure: [240, 255, 255], beige: [245, 245, 220], black: [0, 0, 0], blue: [0, 0, 255], brown: [165, 42, 42], cyan: [0, 255, 255], darkblue: [0, 0, 139], darkcyan: [0, 139, 139], darkgrey: [169, 169, 169], darkgreen: [0, 100, 0], darkkhaki: [189, 183, 107], darkmagenta: [139, 0, 139], darkolivegreen: [85, 107, 47], darkorange: [255, 140, 0], darkorchid: [153, 50, 204], darkred: [139, 0, 0], darksalmon: [233, 150, 122], darkviolet: [148, 0, 211], fuchsia: [255, 0, 255], gold: [255, 215, 0], green: [0, 128, 0], indigo: [75, 0, 130], khaki: [240, 230, 140], lightblue: [173, 216, 230], lightcyan: [224, 255, 255], lightgreen: [144, 238, 144], lightgrey: [211, 211, 211], lightpink: [255, 182, 193], lightyellow: [255, 255, 224], lime: [0, 255, 0], magenta: [255, 0, 255], maroon: [128, 0, 0], navy: [0, 0, 128], olive: [128, 128, 0], orange: [255, 165, 0], pink: [255, 192, 203], purple: [128, 0, 128], violet: [128, 0, 128], red: [255, 0, 0], silver: [192, 192, 192], white: [255, 255, 255], yellow: [255, 255, 0] } }(jQuery), function (e) {
            function t(t, n) { var i = n.children("." + t)[0]; if (null == i && (i = document.createElement("canvas"), i.className = t, e(i).css({ direction: "ltr", position: "absolute", left: 0, top: 0 }).appendTo(n), !i.getContext)) { if (!window.G_vmlCanvasManager) throw new Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode."); i = window.G_vmlCanvasManager.initElement(i) } this.element = i; var s = this.context = i.getContext("2d"), r = window.devicePixelRatio || 1, o = s.webkitBackingStorePixelRatio || s.mozBackingStorePixelRatio || s.msBackingStorePixelRatio || s.oBackingStorePixelRatio || s.backingStorePixelRatio || 1; this.pixelRatio = r / o, this.resize(n.width(), n.height()), this.textContainer = null, this.text = {}, this._textCache = {} } function n(n, s, r, o) {
                function a(e, t) { t = [gt].concat(t); for (var n = 0; n < e.length; ++n) e[n].apply(this, t) } function l() { for (var n = { Canvas: t }, i = 0; i < o.length; ++i) { var s = o[i]; s.init(gt, n), s.options && e.extend(!0, st, s.options) } } function c(t) { e.extend(!0, st, t), t && t.colors && (st.colors = t.colors), null == st.xaxis.color && (st.xaxis.color = e.color.parse(st.grid.color).scale("a", .22).toString()), null == st.yaxis.color && (st.yaxis.color = e.color.parse(st.grid.color).scale("a", .22).toString()), null == st.xaxis.tickColor && (st.xaxis.tickColor = st.grid.tickColor || st.xaxis.color), null == st.yaxis.tickColor && (st.yaxis.tickColor = st.grid.tickColor || st.yaxis.color), null == st.grid.borderColor && (st.grid.borderColor = st.grid.color), null == st.grid.tickColor && (st.grid.tickColor = e.color.parse(st.grid.color).scale("a", .22).toString()); var i, s, r, o = n.css("font-size"), l = o ? +o.replace("px", "") : 13, c = { style: n.css("font-style"), size: Math.round(.8 * l), variant: n.css("font-variant"), weight: n.css("font-weight"), family: n.css("font-family") }; for (r = st.xaxes.length || 1, i = 0; r > i; ++i) s = st.xaxes[i], s && !s.tickColor && (s.tickColor = s.color), s = e.extend(!0, {}, st.xaxis, s), st.xaxes[i] = s, s.font && (s.font = e.extend({}, c, s.font), s.font.color || (s.font.color = s.color), s.font.lineHeight || (s.font.lineHeight = Math.round(1.15 * s.font.size))); for (r = st.yaxes.length || 1, i = 0; r > i; ++i) s = st.yaxes[i], s && !s.tickColor && (s.tickColor = s.color), s = e.extend(!0, {}, st.yaxis, s), st.yaxes[i] = s, s.font && (s.font = e.extend({}, c, s.font), s.font.color || (s.font.color = s.color), s.font.lineHeight || (s.font.lineHeight = Math.round(1.15 * s.font.size))); for (st.xaxis.noTicks && null == st.xaxis.ticks && (st.xaxis.ticks = st.xaxis.noTicks), st.yaxis.noTicks && null == st.yaxis.ticks && (st.yaxis.ticks = st.yaxis.noTicks), st.x2axis && (st.xaxes[1] = e.extend(!0, {}, st.xaxis, st.x2axis), st.xaxes[1].position = "top"), st.y2axis && (st.yaxes[1] = e.extend(!0, {}, st.yaxis, st.y2axis), st.yaxes[1].position = "right"), st.grid.coloredAreas && (st.grid.markings = st.grid.coloredAreas), st.grid.coloredAreasColor && (st.grid.markingsColor = st.grid.coloredAreasColor), st.lines && e.extend(!0, st.series.lines, st.lines), st.points && e.extend(!0, st.series.points, st.points), st.bars && e.extend(!0, st.series.bars, st.bars), null != st.shadowSize && (st.series.shadowSize = st.shadowSize), null != st.highlightColor && (st.series.highlightColor = st.highlightColor), i = 0; i < st.xaxes.length; ++i) g(ut, i + 1).options = st.xaxes[i]; for (i = 0; i < st.yaxes.length; ++i) g(ht, i + 1).options = st.yaxes[i]; for (var u in mt) st.hooks[u] && st.hooks[u].length && (mt[u] = mt[u].concat(st.hooks[u])); a(mt.processOptions, [st]) } function u(e) { it = h(e), v(), _() } function h(t) { for (var n = [], i = 0; i < t.length; ++i) { var s = e.extend(!0, {}, st.series); null != t[i].data ? (s.data = t[i].data, delete t[i].data, e.extend(!0, s, t[i]), t[i].data = s.data) : s.data = t[i], n.push(s) } return n } function d(e, t) { var n = e[t + "axis"]; return "object" == typeof n && (n = n.n), "number" != typeof n && (n = 1), n } function p() { return e.grep(ut.concat(ht), function (e) { return e }) } function f(e) { var t, n, i = {}; for (t = 0; t < ut.length; ++t) n = ut[t], n && n.used && (i["x" + n.n] = n.c2p(e.left)); for (t = 0; t < ht.length; ++t) n = ht[t], n && n.used && (i["y" + n.n] = n.c2p(e.top)); return void 0 !== i.x1 && (i.x = i.x1), void 0 !== i.y1 && (i.y = i.y1), i } function m(e) { var t, n, i, s = {}; for (t = 0; t < ut.length; ++t) if (n = ut[t], n && n.used && (i = "x" + n.n, null == e[i] && 1 == n.n && (i = "x"), null != e[i])) { s.left = n.p2c(e[i]); break } for (t = 0; t < ht.length; ++t) if (n = ht[t], n && n.used && (i = "y" + n.n, null == e[i] && 1 == n.n && (i = "y"), null != e[i])) { s.top = n.p2c(e[i]); break } return s } function g(t, n) { return t[n - 1] || (t[n - 1] = { n: n, direction: t == ut ? "x" : "y", options: e.extend(!0, {}, t == ut ? st.xaxis : st.yaxis) }), t[n - 1] } function v() { var t, n = it.length, i = -1; for (t = 0; t < it.length; ++t) { var s = it[t].color; null != s && (n--, "number" == typeof s && s > i && (i = s)) } i >= n && (n = i + 1); var r, o = [], a = st.colors, l = a.length, c = 0; for (t = 0; n > t; t++) r = e.color.parse(a[t % l] || "#666"), t % l == 0 && t && (c = c >= 0 ? .5 > c ? -c - .2 : 0 : -c), o[t] = r.scale("rgb", 1 + c); var u, h = 0; for (t = 0; t < it.length; ++t) { if (u = it[t], null == u.color ? (u.color = o[h].toString(), ++h) : "number" == typeof u.color && (u.color = o[u.color].toString()), null == u.lines.show) { var p, f = !0; for (p in u) if (u[p] && u[p].show) { f = !1; break } f && (u.lines.show = !0) } null == u.lines.zero && (u.lines.zero = !!u.lines.fill), u.xaxis = g(ut, d(u, "x")), u.yaxis = g(ht, d(u, "y")) } } function _() { function t(e, t, n) { t < e.datamin && t != -_ && (e.datamin = t), n > e.datamax && n != _ && (e.datamax = n) } var n, i, s, r, o, l, c, u, h, d, f, m, g = Number.POSITIVE_INFINITY, v = Number.NEGATIVE_INFINITY, _ = Number.MAX_VALUE; for (e.each(p(), function (e, t) { t.datamin = g, t.datamax = v, t.used = !1 }), n = 0; n < it.length; ++n) o = it[n], o.datapoints = { points: [] }, a(mt.processRawData, [o, o.data, o.datapoints]); for (n = 0; n < it.length; ++n) { if (o = it[n], f = o.data, m = o.datapoints.format, !m) { if (m = [], m.push({ x: !0, number: !0, required: !0 }), m.push({ y: !0, number: !0, required: !0 }), o.bars.show || o.lines.show && o.lines.fill) { var y = !!(o.bars.show && o.bars.zero || o.lines.show && o.lines.zero); m.push({ y: !0, number: !0, required: !1, defaultValue: 0, autoscale: y }), o.bars.horizontal && (delete m[m.length - 1].y, m[m.length - 1].x = !0) } o.datapoints.format = m } if (null == o.datapoints.pointsize) { o.datapoints.pointsize = m.length, c = o.datapoints.pointsize, l = o.datapoints.points; var b = o.lines.show && o.lines.steps; for (o.xaxis.used = o.yaxis.used = !0, i = s = 0; i < f.length; ++i, s += c) { d = f[i]; var w = null == d; if (!w) for (r = 0; c > r; ++r) u = d[r], h = m[r], h && (h.number && null != u && (u = +u, isNaN(u) ? u = null : 1 / 0 == u ? u = _ : u == -1 / 0 && (u = -_)), null == u && (h.required && (w = !0), null != h.defaultValue && (u = h.defaultValue))), l[s + r] = u; if (w) for (r = 0; c > r; ++r) u = l[s + r], null != u && (h = m[r], h.autoscale !== !1 && (h.x && t(o.xaxis, u, u), h.y && t(o.yaxis, u, u))), l[s + r] = null; else if (b && s > 0 && null != l[s - c] && l[s - c] != l[s] && l[s - c + 1] != l[s + 1]) { for (r = 0; c > r; ++r) l[s + c + r] = l[s + r]; l[s + 1] = l[s - c + 1], s += c } } } } for (n = 0; n < it.length; ++n) o = it[n], a(mt.processDatapoints, [o, o.datapoints]); for (n = 0; n < it.length; ++n) { o = it[n], l = o.datapoints.points, c = o.datapoints.pointsize, m = o.datapoints.format; var k = g, x = g, S = v, C = v; for (i = 0; i < l.length; i += c) if (null != l[i]) for (r = 0; c > r; ++r) u = l[i + r], h = m[r], h && h.autoscale !== !1 && u != _ && u != -_ && (h.x && (k > u && (k = u), u > S && (S = u)), h.y && (x > u && (x = u), u > C && (C = u))); if (o.bars.show) { var T; switch (o.bars.align) { case "left": T = 0; break; case "right": T = -o.bars.barWidth; break; default: T = -o.bars.barWidth / 2 } o.bars.horizontal ? (x += T, C += T + o.bars.barWidth) : (k += T, S += T + o.bars.barWidth) } t(o.xaxis, k, S), t(o.yaxis, x, C) } e.each(p(), function (e, t) { t.datamin == g && (t.datamin = null), t.datamax == v && (t.datamax = null) }) } function y() { n.css("padding", 0).children().filter(function () { return !e(this).hasClass("flot-overlay") && !e(this).hasClass("flot-base") }).remove(), "static" == n.css("position") && n.css("position", "relative"), rt = new t("flot-base", n), ot = new t("flot-overlay", n), lt = rt.context, ct = ot.context, at = e(ot.element).unbind(); var i = n.data("plot"); i && (i.shutdown(), ot.clear()), n.data("plot", gt) } function b() { st.grid.hoverable && (at.mousemove(V), at.bind("mouseleave", B)), st.grid.clickable && at.click(Y), a(mt.bindEvents, [at]) } function w() { _t && clearTimeout(_t), at.unbind("mousemove", V), at.unbind("mouseleave", B), at.unbind("click", Y), a(mt.shutdown, [at]) } function k(e) { function t(e) { return e } var n, i, s = e.options.transform || t, r = e.options.inverseTransform; "x" == e.direction ? (n = e.scale = pt / Math.abs(s(e.max) - s(e.min)), i = Math.min(s(e.max), s(e.min))) : (n = e.scale = ft / Math.abs(s(e.max) - s(e.min)), n = -n, i = Math.max(s(e.max), s(e.min))), e.p2c = s == t ? function (e) { return (e - i) * n } : function (e) { return (s(e) - i) * n }, e.c2p = r ? function (e) { return r(i + e / n) } : function (e) { return i + e / n } } function x(e) { for (var t = e.options, n = e.ticks || [], i = t.labelWidth || 0, s = t.labelHeight || 0, r = i || ("x" == e.direction ? Math.floor(rt.width / (n.length || 1)) : null), o = e.direction + "Axis " + e.direction + e.n + "Axis", a = "flot-" + e.direction + "-axis flot-" + e.direction + e.n + "-axis " + o, l = t.font || "flot-tick-label tickLabel", c = 0; c < n.length; ++c) { var u = n[c]; if (u.label) { var h = rt.getTextInfo(a, u.label, l, null, r); i = Math.max(i, h.width), s = Math.max(s, h.height) } } e.labelWidth = t.labelWidth || i, e.labelHeight = t.labelHeight || s } function S(t) { var n = t.labelWidth, i = t.labelHeight, s = t.options.position, r = "x" === t.direction, o = t.options.tickLength, a = st.grid.axisMargin, l = st.grid.labelMargin, c = !0, u = !0, h = !0, d = !1; e.each(r ? ut : ht, function (e, n) { n && n.reserveSpace && (n === t ? d = !0 : n.options.position === s && (d ? u = !1 : c = !1), d || (h = !1)) }), u && (a = 0), null == o && (o = h ? "full" : 5), isNaN(+o) || (l += +o), r ? (i += l, "bottom" == s ? (dt.bottom += i + a, t.box = { top: rt.height - dt.bottom, height: i }) : (t.box = { top: dt.top + a, height: i }, dt.top += i + a)) : (n += l, "left" == s ? (t.box = { left: dt.left + a, width: n }, dt.left += n + a) : (dt.right += n + a, t.box = { left: rt.width - dt.right, width: n })), t.position = s, t.tickLength = o, t.box.padding = l, t.innermost = c } function C(e) { "x" == e.direction ? (e.box.left = dt.left - e.labelWidth / 2, e.box.width = rt.width - dt.left - dt.right + e.labelWidth) : (e.box.top = dt.top - e.labelHeight / 2, e.box.height = rt.height - dt.bottom - dt.top + e.labelHeight) } function T() { var t, n = st.grid.minBorderMargin; if (null == n) for (n = 0, t = 0; t < it.length; ++t) n = Math.max(n, 2 * (it[t].points.radius + it[t].points.lineWidth / 2)); var i = { left: n, right: n, top: n, bottom: n }; e.each(p(), function (e, t) { if (t.reserveSpace && t.ticks && t.ticks.length) { var n = t.ticks[t.ticks.length - 1]; "x" === t.direction ? (i.left = Math.max(i.left, t.labelWidth / 2), n.v <= t.max && (i.right = Math.max(i.right, t.labelWidth / 2))) : (i.bottom = Math.max(i.bottom, t.labelHeight / 2), n.v <= t.max && (i.top = Math.max(i.top, t.labelHeight / 2))) } }), dt.left = Math.ceil(Math.max(i.left, dt.left)), dt.right = Math.ceil(Math.max(i.right, dt.right)), dt.top = Math.ceil(Math.max(i.top, dt.top)), dt.bottom = Math.ceil(Math.max(i.bottom, dt.bottom)) } function E() { var t, n = p(), i = st.grid.show; for (var s in dt) { var r = st.grid.margin || 0; dt[s] = "number" == typeof r ? r : r[s] || 0 } a(mt.processOffset, [dt]); for (var s in dt) dt[s] += "object" == typeof st.grid.borderWidth ? i ? st.grid.borderWidth[s] : 0 : i ? st.grid.borderWidth : 0; if (e.each(n, function (e, t) { t.show = t.options.show, null == t.show && (t.show = t.used), t.reserveSpace = t.show || t.options.reserveSpace, M(t) }), i) { var o = e.grep(n, function (e) { return e.reserveSpace }); for (e.each(o, function (e, t) { D(t), I(t), O(t, t.ticks), x(t) }), t = o.length - 1; t >= 0; --t) S(o[t]); T(), e.each(o, function (e, t) { C(t) }) } pt = rt.width - dt.left - dt.right, ft = rt.height - dt.bottom - dt.top, e.each(n, function (e, t) { k(t) }), i && L(), U() } function M(e) { var t = e.options, n = +(null != t.min ? t.min : e.datamin), i = +(null != t.max ? t.max : e.datamax), s = i - n; if (0 == s) { var r = 0 == i ? 1 : .01; null == t.min && (n -= r), (null == t.max || null != t.min) && (i += r) } else { var o = t.autoscaleMargin; null != o && (null == t.min && (n -= s * o, 0 > n && null != e.datamin && e.datamin >= 0 && (n = 0)), null == t.max && (i += s * o, i > 0 && null != e.datamax && e.datamax <= 0 && (i = 0))) } e.min = n, e.max = i } function D(t) { var n, s = t.options; n = "number" == typeof s.ticks && s.ticks > 0 ? s.ticks : .3 * Math.sqrt("x" == t.direction ? rt.width : rt.height); var r = (t.max - t.min) / n, o = -Math.floor(Math.log(r) / Math.LN10), a = s.tickDecimals; null != a && o > a && (o = a); var l, c = Math.pow(10, -o), u = r / c; if (1.5 > u ? l = 1 : 3 > u ? (l = 2, u > 2.25 && (null == a || a >= o + 1) && (l = 2.5, ++o)) : l = 7.5 > u ? 5 : 10, l *= c, null != s.minTickSize && l < s.minTickSize && (l = s.minTickSize), t.delta = r, t.tickDecimals = Math.max(0, null != a ? a : o), t.tickSize = s.tickSize || l, "time" == s.mode && !t.tickGenerator) throw new Error("Time mode requires the flot.time plugin."); if (t.tickGenerator || (t.tickGenerator = function (e) { var t, n = [], s = i(e.min, e.tickSize), r = 0, o = Number.NaN; do t = o, o = s + r * e.tickSize, n.push(o), ++r; while (o < e.max && o != t); return n }, t.tickFormatter = function (e, t) { var n = t.tickDecimals ? Math.pow(10, t.tickDecimals) : 1, i = "" + Math.round(e * n) / n; if (null != t.tickDecimals) { var s = i.indexOf("."), r = -1 == s ? 0 : i.length - s - 1; if (r < t.tickDecimals) return (r ? i : i + ".") + ("" + n).substr(1, t.tickDecimals - r) } return i }), e.isFunction(s.tickFormatter) && (t.tickFormatter = function (e, t) { return "" + s.tickFormatter(e, t) }), null != s.alignTicksWithAxis) { var h = ("x" == t.direction ? ut : ht)[s.alignTicksWithAxis - 1]; if (h && h.used && h != t) { var d = t.tickGenerator(t); if (d.length > 0 && (null == s.min && (t.min = Math.min(t.min, d[0])), null == s.max && d.length > 1 && (t.max = Math.max(t.max, d[d.length - 1]))), t.tickGenerator = function (e) { var t, n, i = []; for (n = 0; n < h.ticks.length; ++n) t = (h.ticks[n].v - h.min) / (h.max - h.min), t = e.min + t * (e.max - e.min), i.push(t); return i }, !t.mode && null == s.tickDecimals) { var p = Math.max(0, -Math.floor(Math.log(t.delta) / Math.LN10) + 1), f = t.tickGenerator(t); f.length > 1 && /\..*0$/.test((f[1] - f[0]).toFixed(p)) || (t.tickDecimals = p) } } } } function I(t) { var n = t.options.ticks, i = []; null == n || "number" == typeof n && n > 0 ? i = t.tickGenerator(t) : n && (i = e.isFunction(n) ? n(t) : n); var s, r; for (t.ticks = [], s = 0; s < i.length; ++s) { var o = null, a = i[s]; "object" == typeof a ? (r = +a[0], a.length > 1 && (o = a[1])) : r = +a, null == o && (o = t.tickFormatter(r, t)), isNaN(r) || t.ticks.push({ v: r, label: o }) } } function O(e, t) { e.options.autoscaleMargin && t.length > 0 && (null == e.options.min && (e.min = Math.min(e.min, t[0].v)), null == e.options.max && t.length > 1 && (e.max = Math.max(e.max, t[t.length - 1].v))) } function P() { rt.clear(), a(mt.drawBackground, [lt]); var e = st.grid; e.show && e.backgroundColor && A(), e.show && !e.aboveData && j(); for (var t = 0; t < it.length; ++t) a(mt.drawSeries, [lt, it[t]]), z(it[t]); a(mt.draw, [lt]), e.show && e.aboveData && j(), rt.render(), J() } function N(e, t) { for (var n, i, s, r, o = p(), a = 0; a < o.length; ++a) if (n = o[a], n.direction == t && (r = t + n.n + "axis", e[r] || 1 != n.n || (r = t + "axis"), e[r])) { i = e[r].from, s = e[r].to; break } if (e[r] || (n = "x" == t ? ut[0] : ht[0], i = e[t + "1"], s = e[t + "2"]), null != i && null != s && i > s) { var l = i; i = s, s = l } return { from: i, to: s, axis: n } } function A() { lt.save(), lt.translate(dt.left, dt.top), lt.fillStyle = nt(st.grid.backgroundColor, ft, 0, "rgba(255, 255, 255, 0)"), lt.fillRect(0, 0, pt, ft), lt.restore() } function j() {
                    var t, n, i, s; lt.save(), lt.translate(dt.left, dt.top); var r = st.grid.markings; if (r) for (e.isFunction(r) && (n = gt.getAxes(), n.xmin = n.xaxis.min, n.xmax = n.xaxis.max, n.ymin = n.yaxis.min, n.ymax = n.yaxis.max, r = r(n)), t = 0; t < r.length; ++t) {
                        var o = r[t], a = N(o, "x"), l = N(o, "y"); null == a.from && (a.from = a.axis.min), null == a.to && (a.to = a.axis.max), null == l.from && (l.from = l.axis.min), null == l.to && (l.to = l.axis.max), a.to < a.axis.min || a.from > a.axis.max || l.to < l.axis.min || l.from > l.axis.max || (a.from = Math.max(a.from, a.axis.min), a.to = Math.min(a.to, a.axis.max), l.from = Math.max(l.from, l.axis.min), l.to = Math.min(l.to, l.axis.max), (a.from != a.to || l.from != l.to) && (a.from = a.axis.p2c(a.from), a.to = a.axis.p2c(a.to), l.from = l.axis.p2c(l.from), l.to = l.axis.p2c(l.to), a.from == a.to || l.from == l.to ? (lt.beginPath(), lt.strokeStyle = o.color || st.grid.markingsColor, lt.lineWidth = o.lineWidth || st.grid.markingsLineWidth, lt.moveTo(a.from, l.from), lt.lineTo(a.to, l.to), lt.stroke()) : (lt.fillStyle = o.color || st.grid.markingsColor, lt.fillRect(a.from, l.to, a.to - a.from, l.from - l.to))))
                    } n = p(), i = st.grid.borderWidth; for (var c = 0; c < n.length; ++c) { var u, h, d, f, m = n[c], g = m.box, v = m.tickLength; if (m.show && 0 != m.ticks.length) { for (lt.lineWidth = 1, "x" == m.direction ? (u = 0, h = "full" == v ? "top" == m.position ? 0 : ft : g.top - dt.top + ("top" == m.position ? g.height : 0)) : (h = 0, u = "full" == v ? "left" == m.position ? 0 : pt : g.left - dt.left + ("left" == m.position ? g.width : 0)), m.innermost || (lt.strokeStyle = m.options.color, lt.beginPath(), d = f = 0, "x" == m.direction ? d = pt + 1 : f = ft + 1, 1 == lt.lineWidth && ("x" == m.direction ? h = Math.floor(h) + .5 : u = Math.floor(u) + .5), lt.moveTo(u, h), lt.lineTo(u + d, h + f), lt.stroke()), lt.strokeStyle = m.options.tickColor, lt.beginPath(), t = 0; t < m.ticks.length; ++t) { var _ = m.ticks[t].v; d = f = 0, isNaN(_) || _ < m.min || _ > m.max || "full" == v && ("object" == typeof i && i[m.position] > 0 || i > 0) && (_ == m.min || _ == m.max) || ("x" == m.direction ? (u = m.p2c(_), f = "full" == v ? -ft : v, "top" == m.position && (f = -f)) : (h = m.p2c(_), d = "full" == v ? -pt : v, "left" == m.position && (d = -d)), 1 == lt.lineWidth && ("x" == m.direction ? u = Math.floor(u) + .5 : h = Math.floor(h) + .5), lt.moveTo(u, h), lt.lineTo(u + d, h + f)) } lt.stroke() } } i && (s = st.grid.borderColor, "object" == typeof i || "object" == typeof s ? ("object" != typeof i && (i = { top: i, right: i, bottom: i, left: i }), "object" != typeof s && (s = { top: s, right: s, bottom: s, left: s }), i.top > 0 && (lt.strokeStyle = s.top, lt.lineWidth = i.top, lt.beginPath(), lt.moveTo(0 - i.left, 0 - i.top / 2), lt.lineTo(pt, 0 - i.top / 2), lt.stroke()), i.right > 0 && (lt.strokeStyle = s.right, lt.lineWidth = i.right, lt.beginPath(), lt.moveTo(pt + i.right / 2, 0 - i.top), lt.lineTo(pt + i.right / 2, ft), lt.stroke()), i.bottom > 0 && (lt.strokeStyle = s.bottom, lt.lineWidth = i.bottom, lt.beginPath(), lt.moveTo(pt + i.right, ft + i.bottom / 2), lt.lineTo(0, ft + i.bottom / 2), lt.stroke()), i.left > 0 && (lt.strokeStyle = s.left, lt.lineWidth = i.left, lt.beginPath(), lt.moveTo(0 - i.left / 2, ft + i.bottom), lt.lineTo(0 - i.left / 2, 0), lt.stroke())) : (lt.lineWidth = i, lt.strokeStyle = st.grid.borderColor, lt.strokeRect(-i / 2, -i / 2, pt + i, ft + i))), lt.restore()
                } function L() { e.each(p(), function (e, t) { var n, i, s, r, o, a = t.box, l = t.direction + "Axis " + t.direction + t.n + "Axis", c = "flot-" + t.direction + "-axis flot-" + t.direction + t.n + "-axis " + l, u = t.options.font || "flot-tick-label tickLabel"; if (rt.removeText(c), t.show && 0 != t.ticks.length) for (var h = 0; h < t.ticks.length; ++h) n = t.ticks[h], !n.label || n.v < t.min || n.v > t.max || ("x" == t.direction ? (r = "center", i = dt.left + t.p2c(n.v), "bottom" == t.position ? s = a.top + a.padding : (s = a.top + a.height - a.padding, o = "bottom")) : (o = "middle", s = dt.top + t.p2c(n.v), "left" == t.position ? (i = a.left + a.width - a.padding, r = "right") : i = a.left + a.padding), rt.addText(c, i, s, n.label, u, null, null, r, o)) }) } function z(e) { e.lines.show && F(e), e.bars.show && q(e), e.points.show && $(e) } function F(e) { function t(e, t, n, i, s) { var r = e.points, o = e.pointsize, a = null, l = null; lt.beginPath(); for (var c = o; c < r.length; c += o) { var u = r[c - o], h = r[c - o + 1], d = r[c], p = r[c + 1]; if (null != u && null != d) { if (p >= h && h < s.min) { if (p < s.min) continue; u = (s.min - h) / (p - h) * (d - u) + u, h = s.min } else if (h >= p && p < s.min) { if (h < s.min) continue; d = (s.min - h) / (p - h) * (d - u) + u, p = s.min } if (h >= p && h > s.max) { if (p > s.max) continue; u = (s.max - h) / (p - h) * (d - u) + u, h = s.max } else if (p >= h && p > s.max) { if (h > s.max) continue; d = (s.max - h) / (p - h) * (d - u) + u, p = s.max } if (d >= u && u < i.min) { if (d < i.min) continue; h = (i.min - u) / (d - u) * (p - h) + h, u = i.min } else if (u >= d && d < i.min) { if (u < i.min) continue; p = (i.min - u) / (d - u) * (p - h) + h, d = i.min } if (u >= d && u > i.max) { if (d > i.max) continue; h = (i.max - u) / (d - u) * (p - h) + h, u = i.max } else if (d >= u && d > i.max) { if (u > i.max) continue; p = (i.max - u) / (d - u) * (p - h) + h, d = i.max } (u != a || h != l) && lt.moveTo(i.p2c(u) + t, s.p2c(h) + n), a = d, l = p, lt.lineTo(i.p2c(d) + t, s.p2c(p) + n) } } lt.stroke() } function n(e, t, n) { for (var i = e.points, s = e.pointsize, r = Math.min(Math.max(0, n.min), n.max), o = 0, a = !1, l = 1, c = 0, u = 0; ;) { if (s > 0 && o > i.length + s) break; o += s; var h = i[o - s], d = i[o - s + l], p = i[o], f = i[o + l]; if (a) { if (s > 0 && null != h && null == p) { u = o, s = -s, l = 2; continue } if (0 > s && o == c + s) { lt.fill(), a = !1, s = -s, l = 1, o = c = u + s; continue } } if (null != h && null != p) { if (p >= h && h < t.min) { if (p < t.min) continue; d = (t.min - h) / (p - h) * (f - d) + d, h = t.min } else if (h >= p && p < t.min) { if (h < t.min) continue; f = (t.min - h) / (p - h) * (f - d) + d, p = t.min } if (h >= p && h > t.max) { if (p > t.max) continue; d = (t.max - h) / (p - h) * (f - d) + d, h = t.max } else if (p >= h && p > t.max) { if (h > t.max) continue; f = (t.max - h) / (p - h) * (f - d) + d, p = t.max } if (a || (lt.beginPath(), lt.moveTo(t.p2c(h), n.p2c(r)), a = !0), d >= n.max && f >= n.max) lt.lineTo(t.p2c(h), n.p2c(n.max)), lt.lineTo(t.p2c(p), n.p2c(n.max)); else if (d <= n.min && f <= n.min) lt.lineTo(t.p2c(h), n.p2c(n.min)), lt.lineTo(t.p2c(p), n.p2c(n.min)); else { var m = h, g = p; f >= d && d < n.min && f >= n.min ? (h = (n.min - d) / (f - d) * (p - h) + h, d = n.min) : d >= f && f < n.min && d >= n.min && (p = (n.min - d) / (f - d) * (p - h) + h, f = n.min), d >= f && d > n.max && f <= n.max ? (h = (n.max - d) / (f - d) * (p - h) + h, d = n.max) : f >= d && f > n.max && d <= n.max && (p = (n.max - d) / (f - d) * (p - h) + h, f = n.max), h != m && lt.lineTo(t.p2c(m), n.p2c(d)), lt.lineTo(t.p2c(h), n.p2c(d)), lt.lineTo(t.p2c(p), n.p2c(f)), p != g && (lt.lineTo(t.p2c(p), n.p2c(f)), lt.lineTo(t.p2c(g), n.p2c(f))) } } } } lt.save(), lt.translate(dt.left, dt.top), lt.lineJoin = "round"; var i = e.lines.lineWidth, s = e.shadowSize; if (i > 0 && s > 0) { lt.lineWidth = s, lt.strokeStyle = "rgba(0,0,0,0.1)"; var r = Math.PI / 18; t(e.datapoints, Math.sin(r) * (i / 2 + s / 2), Math.cos(r) * (i / 2 + s / 2), e.xaxis, e.yaxis), lt.lineWidth = s / 2, t(e.datapoints, Math.sin(r) * (i / 2 + s / 4), Math.cos(r) * (i / 2 + s / 4), e.xaxis, e.yaxis) } lt.lineWidth = i, lt.strokeStyle = e.color; var o = H(e.lines, e.color, 0, ft); o && (lt.fillStyle = o, n(e.datapoints, e.xaxis, e.yaxis)), i > 0 && t(e.datapoints, 0, 0, e.xaxis, e.yaxis), lt.restore() } function $(e) { function t(e, t, n, i, s, r, o, a) { for (var l = e.points, c = e.pointsize, u = 0; u < l.length; u += c) { var h = l[u], d = l[u + 1]; null == h || h < r.min || h > r.max || d < o.min || d > o.max || (lt.beginPath(), h = r.p2c(h), d = o.p2c(d) + i, "circle" == a ? lt.arc(h, d, t, 0, s ? Math.PI : 2 * Math.PI, !1) : a(lt, h, d, t, s), lt.closePath(), n && (lt.fillStyle = n, lt.fill()), lt.stroke()) } } lt.save(), lt.translate(dt.left, dt.top); var n = e.points.lineWidth, i = e.shadowSize, s = e.points.radius, r = e.points.symbol; if (0 == n && (n = 1e-4), n > 0 && i > 0) { var o = i / 2; lt.lineWidth = o, lt.strokeStyle = "rgba(0,0,0,0.1)", t(e.datapoints, s, null, o + o / 2, !0, e.xaxis, e.yaxis, r), lt.strokeStyle = "rgba(0,0,0,0.2)", t(e.datapoints, s, null, o / 2, !0, e.xaxis, e.yaxis, r) } lt.lineWidth = n, lt.strokeStyle = e.color, t(e.datapoints, s, H(e.points, e.color), 0, !1, e.xaxis, e.yaxis, r), lt.restore() } function R(e, t, n, i, s, r, o, a, l, c, u) { var h, d, p, f, m, g, v, _, y; c ? (_ = g = v = !0, m = !1, h = n, d = e, f = t + i, p = t + s, h > d && (y = d, d = h, h = y, m = !0, g = !1)) : (m = g = v = !0, _ = !1, h = e + i, d = e + s, p = n, f = t, p > f && (y = f, f = p, p = y, _ = !0, v = !1)), d < o.min || h > o.max || f < a.min || p > a.max || (h < o.min && (h = o.min, m = !1), d > o.max && (d = o.max, g = !1), p < a.min && (p = a.min, _ = !1), f > a.max && (f = a.max, v = !1), h = o.p2c(h), p = a.p2c(p), d = o.p2c(d), f = a.p2c(f), r && (l.fillStyle = r(p, f), l.fillRect(h, f, d - h, p - f)), u > 0 && (m || g || v || _) && (l.beginPath(), l.moveTo(h, p), m ? l.lineTo(h, f) : l.moveTo(h, f), v ? l.lineTo(d, f) : l.moveTo(d, f), g ? l.lineTo(d, p) : l.moveTo(d, p), _ ? l.lineTo(h, p) : l.moveTo(h, p), l.stroke())) } function q(e) { function t(t, n, i, s, r, o) { for (var a = t.points, l = t.pointsize, c = 0; c < a.length; c += l) null != a[c] && R(a[c], a[c + 1], a[c + 2], n, i, s, r, o, lt, e.bars.horizontal, e.bars.lineWidth) } lt.save(), lt.translate(dt.left, dt.top), lt.lineWidth = e.bars.lineWidth, lt.strokeStyle = e.color; var n; switch (e.bars.align) { case "left": n = 0; break; case "right": n = -e.bars.barWidth; break; default: n = -e.bars.barWidth / 2 } var i = e.bars.fill ? function (t, n) { return H(e.bars, e.color, t, n) } : null; t(e.datapoints, n, n + e.bars.barWidth, i, e.xaxis, e.yaxis), lt.restore() } function H(t, n, i, s) { var r = t.fill; if (!r) return null; if (t.fillColor) return nt(t.fillColor, i, s, n); var o = e.color.parse(n); return o.a = "number" == typeof r ? r : .4, o.normalize(), o.toString() } function U() { if (null != st.legend.container ? e(st.legend.container).html("") : n.find(".legend").remove(), st.legend.show) { for (var t, i, s = [], r = [], o = !1, a = st.legend.labelFormatter, l = 0; l < it.length; ++l) t = it[l], t.label && (i = a ? a(t.label, t) : t.label, i && r.push({ label: i, color: t.color })); if (st.legend.sorted) if (e.isFunction(st.legend.sorted)) r.sort(st.legend.sorted); else if ("reverse" == st.legend.sorted) r.reverse(); else { var c = "descending" != st.legend.sorted; r.sort(function (e, t) { return e.label == t.label ? 0 : e.label < t.label != c ? 1 : -1 }) } for (var l = 0; l < r.length; ++l) { var u = r[l]; l % st.legend.noColumns == 0 && (o && s.push("</tr>"), s.push("<tr>"), o = !0), s.push('<td class="legendColorBox"><div style="border:1px solid ' + st.legend.labelBoxBorderColor + ';padding:1px"><div style="width:4px;height:0;border:5px solid ' + u.color + ';overflow:hidden"></div></div></td><td class="legendLabel">' + u.label + "</td>") } if (o && s.push("</tr>"), 0 != s.length) { var h = '<table style="font-size:smaller;color:' + st.grid.color + '">' + s.join("") + "</table>"; if (null != st.legend.container) e(st.legend.container).html(h); else { var d = "", p = st.legend.position, f = st.legend.margin; null == f[0] && (f = [f, f]), "n" == p.charAt(0) ? d += "top:" + (f[1] + dt.top) + "px;" : "s" == p.charAt(0) && (d += "bottom:" + (f[1] + dt.bottom) + "px;"), "e" == p.charAt(1) ? d += "right:" + (f[0] + dt.right) + "px;" : "w" == p.charAt(1) && (d += "left:" + (f[0] + dt.left) + "px;"); var m = e('<div class="legend">' + h.replace('style="', 'style="position:absolute;' + d + ";") + "</div>").appendTo(n); if (0 != st.legend.backgroundOpacity) { var g = st.legend.backgroundColor; null == g && (g = st.grid.backgroundColor, g = g && "string" == typeof g ? e.color.parse(g) : e.color.extract(m, "background-color"), g.a = 1, g = g.toString()); var v = m.children(); e('<div style="position:absolute;width:' + v.width() + "px;height:" + v.height() + "px;" + d + "background-color:" + g + ';"> </div>').prependTo(m).css("opacity", st.legend.backgroundOpacity) } } } } } function W(e, t, n) { var i, s, r, o = st.grid.mouseActiveRadius, a = o * o + 1, l = null; for (i = it.length - 1; i >= 0; --i) if (n(it[i])) { var c = it[i], u = c.xaxis, h = c.yaxis, d = c.datapoints.points, p = u.c2p(e), f = h.c2p(t), m = o / u.scale, g = o / h.scale; if (r = c.datapoints.pointsize, u.options.inverseTransform && (m = Number.MAX_VALUE), h.options.inverseTransform && (g = Number.MAX_VALUE), c.lines.show || c.points.show) for (s = 0; s < d.length; s += r) { var v = d[s], _ = d[s + 1]; if (null != v && !(v - p > m || -m > v - p || _ - f > g || -g > _ - f)) { var y = Math.abs(u.p2c(v) - e), b = Math.abs(h.p2c(_) - t), w = y * y + b * b; a > w && (a = w, l = [i, s / r]) } } if (c.bars.show && !l) { var k, x; switch (c.bars.align) { case "left": k = 0; break; case "right": k = -c.bars.barWidth; break; default: k = -c.bars.barWidth / 2 } for (x = k + c.bars.barWidth, s = 0; s < d.length; s += r) { var v = d[s], _ = d[s + 1], S = d[s + 2]; null != v && (it[i].bars.horizontal ? p <= Math.max(S, v) && p >= Math.min(S, v) && f >= _ + k && _ + x >= f : p >= v + k && v + x >= p && f >= Math.min(S, _) && f <= Math.max(S, _)) && (l = [i, s / r]) } } } return l ? (i = l[0], s = l[1], r = it[i].datapoints.pointsize, { datapoint: it[i].datapoints.points.slice(s * r, (s + 1) * r), dataIndex: s, series: it[i], seriesIndex: i }) : null } function V(e) { st.grid.hoverable && G("plothover", e, function (e) { return 0 != e.hoverable }) } function B(e) { st.grid.hoverable && G("plothover", e, function () { return !1 }) } function Y(e) { G("plotclick", e, function (e) { return 0 != e.clickable }) } function G(e, t, i) { var s = at.offset(), r = t.pageX - s.left - dt.left, o = t.pageY - s.top - dt.top, a = f({ left: r, top: o }); a.pageX = t.pageX, a.pageY = t.pageY; var l = W(r, o, i); if (l && (l.pageX = parseInt(l.series.xaxis.p2c(l.datapoint[0]) + s.left + dt.left, 10), l.pageY = parseInt(l.series.yaxis.p2c(l.datapoint[1]) + s.top + dt.top, 10)), st.grid.autoHighlight) { for (var c = 0; c < vt.length; ++c) { var u = vt[c]; u.auto != e || l && u.series == l.series && u.point[0] == l.datapoint[0] && u.point[1] == l.datapoint[1] || X(u.series, u.point) } l && Z(l.series, l.datapoint, e) } n.trigger(e, [a, l]) } function J() { var e = st.interaction.redrawOverlayInterval; return -1 == e ? void Q() : void (_t || (_t = setTimeout(Q, e))) } function Q() { _t = null, ct.save(), ot.clear(), ct.translate(dt.left, dt.top); var e, t; for (e = 0; e < vt.length; ++e) t = vt[e], t.series.bars.show ? tt(t.series, t.point) : et(t.series, t.point); ct.restore(), a(mt.drawOverlay, [ct]) } function Z(e, t, n) { if ("number" == typeof e && (e = it[e]), "number" == typeof t) { var i = e.datapoints.pointsize; t = e.datapoints.points.slice(i * t, i * (t + 1)) } var s = K(e, t); -1 == s ? (vt.push({ series: e, point: t, auto: n }), J()) : n || (vt[s].auto = !1) } function X(e, t) { if (null == e && null == t) return vt = [], void J(); if ("number" == typeof e && (e = it[e]), "number" == typeof t) { var n = e.datapoints.pointsize; t = e.datapoints.points.slice(n * t, n * (t + 1)) } var i = K(e, t); -1 != i && (vt.splice(i, 1), J()) } function K(e, t) { for (var n = 0; n < vt.length; ++n) { var i = vt[n]; if (i.series == e && i.point[0] == t[0] && i.point[1] == t[1]) return n } return -1 } function et(t, n) { var i = n[0], s = n[1], r = t.xaxis, o = t.yaxis, a = "string" == typeof t.highlightColor ? t.highlightColor : e.color.parse(t.color).scale("a", .5).toString(); if (!(i < r.min || i > r.max || s < o.min || s > o.max)) { var l = t.points.radius + t.points.lineWidth / 2; ct.lineWidth = l, ct.strokeStyle = a; var c = 1.5 * l; i = r.p2c(i), s = o.p2c(s), ct.beginPath(), "circle" == t.points.symbol ? ct.arc(i, s, c, 0, 2 * Math.PI, !1) : t.points.symbol(ct, i, s, c, !1), ct.closePath(), ct.stroke() } } function tt(t, n) { var i, s = "string" == typeof t.highlightColor ? t.highlightColor : e.color.parse(t.color).scale("a", .5).toString(), r = s; switch (t.bars.align) { case "left": i = 0; break; case "right": i = -t.bars.barWidth; break; default: i = -t.bars.barWidth / 2 } ct.lineWidth = t.bars.lineWidth, ct.strokeStyle = s, R(n[0], n[1], n[2] || 0, i, i + t.bars.barWidth, function () { return r }, t.xaxis, t.yaxis, ct, t.bars.horizontal, t.bars.lineWidth) } function nt(t, n, i, s) { if ("string" == typeof t) return t; for (var r = lt.createLinearGradient(0, i, 0, n), o = 0, a = t.colors.length; a > o; ++o) { var l = t.colors[o]; if ("string" != typeof l) { var c = e.color.parse(s); null != l.brightness && (c = c.scale("rgb", l.brightness)), null != l.opacity && (c.a *= l.opacity), l = c.toString() } r.addColorStop(o / (a - 1), l) } return r } var it = [], st = { colors: ["#edc240", "#afd8f8", "#cb4b4b", "#4da74d", "#9440ed"], legend: { show: !0, noColumns: 1, labelFormatter: null, labelBoxBorderColor: "#ccc", container: null, position: "ne", margin: 5, backgroundColor: null, backgroundOpacity: .85, sorted: null }, xaxis: { show: null, position: "bottom", mode: null, font: null, color: null, tickColor: null, transform: null, inverseTransform: null, min: null, max: null, autoscaleMargin: null, ticks: null, tickFormatter: null, labelWidth: null, labelHeight: null, reserveSpace: null, tickLength: null, alignTicksWithAxis: null, tickDecimals: null, tickSize: null, minTickSize: null }, yaxis: { autoscaleMargin: .02, position: "left" }, xaxes: [], yaxes: [], series: { points: { show: !1, radius: 3, lineWidth: 2, fill: !0, fillColor: "#ffffff", symbol: "circle" }, lines: { lineWidth: 2, fill: !1, fillColor: null, steps: !1 }, bars: { show: !1, lineWidth: 2, barWidth: 1, fill: !0, fillColor: null, align: "left", horizontal: !1, zero: !0 }, shadowSize: 3, highlightColor: null }, grid: { show: !0, aboveData: !1, color: "#545454", backgroundColor: null, borderColor: null, tickColor: null, margin: 0, labelMargin: 5, axisMargin: 8, borderWidth: 2, minBorderMargin: null, markings: null, markingsColor: "#f4f4f4", markingsLineWidth: 2, clickable: !1, hoverable: !1, autoHighlight: !0, mouseActiveRadius: 10 }, interaction: { redrawOverlayInterval: 1e3 / 60 }, hooks: {} }, rt = null, ot = null, at = null, lt = null, ct = null, ut = [], ht = [], dt = { left: 0, right: 0, top: 0, bottom: 0 }, pt = 0, ft = 0, mt = { processOptions: [], processRawData: [], processDatapoints: [], processOffset: [], drawBackground: [], drawSeries: [], draw: [], bindEvents: [], drawOverlay: [], shutdown: [] }, gt = this; gt.setData = u, gt.setupGrid = E, gt.draw = P, gt.getPlaceholder = function () { return n }, gt.getCanvas = function () { return rt.element }, gt.getPlotOffset = function () { return dt }, gt.width = function () { return pt }, gt.height = function () { return ft }, gt.offset = function () { var e = at.offset(); return e.left += dt.left, e.top += dt.top, e }, gt.getData = function () { return it }, gt.getAxes = function () { var t = {}; return e.each(ut.concat(ht), function (e, n) { n && (t[n.direction + (1 != n.n ? n.n : "") + "axis"] = n) }), t }, gt.getXAxes = function () { return ut }, gt.getYAxes = function () { return ht }, gt.c2p = f, gt.p2c = m, gt.getOptions = function () { return st }, gt.highlight = Z, gt.unhighlight = X, gt.triggerRedrawOverlay = J, gt.pointOffset = function (e) { return { left: parseInt(ut[d(e, "x") - 1].p2c(+e.x) + dt.left, 10), top: parseInt(ht[d(e, "y") - 1].p2c(+e.y) + dt.top, 10) } }, gt.shutdown = w, gt.destroy = function () { w(), n.removeData("plot").empty(), it = [], st = null, rt = null, ot = null, at = null, lt = null, ct = null, ut = [], ht = [], mt = null, vt = [], gt = null }, gt.resize = function () { var e = n.width(), t = n.height(); rt.resize(e, t), ot.resize(e, t) }, gt.hooks = mt, l(gt), c(r), y(), u(s), E(), P(), b(); var vt = [], _t = null
            } function i(e, t) { return t * Math.floor(e / t) } var s = Object.prototype.hasOwnProperty; t.prototype.resize = function (e, t) { if (0 >= e || 0 >= t) throw new Error("Invalid dimensions for plot, width = " + e + ", height = " + t); var n = this.element, i = this.context, s = this.pixelRatio; this.width != e && (n.width = e * s, n.style.width = e + "px", this.width = e), this.height != t && (n.height = t * s, n.style.height = t + "px", this.height = t), i.restore(), i.save(), i.scale(s, s) }, t.prototype.clear = function () { this.context.clearRect(0, 0, this.width, this.height) }, t.prototype.render = function () { var e = this._textCache; for (var t in e) if (s.call(e, t)) { var n = this.getTextLayer(t), i = e[t]; n.hide(); for (var r in i) if (s.call(i, r)) { var o = i[r]; for (var a in o) if (s.call(o, a)) { for (var l, c = o[a].positions, u = 0; l = c[u]; u++) l.active ? l.rendered || (n.append(l.element), l.rendered = !0) : (c.splice(u--, 1), l.rendered && l.element.detach()); 0 == c.length && delete o[a] } } n.show() } }, t.prototype.getTextLayer = function (t) { var n = this.text[t]; return null == n && (null == this.textContainer && (this.textContainer = e("<div class='flot-text'></div>").css({ position: "absolute", top: 0, left: 0, bottom: 0, right: 0, "font-size": "smaller", color: "#545454" }).insertAfter(this.element)), n = this.text[t] = e("<div></div>").addClass(t).css({ position: "absolute", top: 0, left: 0, bottom: 0, right: 0 }).appendTo(this.textContainer)), n }, t.prototype.getTextInfo = function (t, n, i, s, r) { var o, a, l, c; if (n = "" + n, o = "object" == typeof i ? i.style + " " + i.variant + " " + i.weight + " " + i.size + "px/" + i.lineHeight + "px " + i.family : i, a = this._textCache[t], null == a && (a = this._textCache[t] = {}), l = a[o], null == l && (l = a[o] = {}), c = l[n], null == c) { var u = e("<div></div>").html(n).css({ position: "absolute", "max-width": r, top: -9999 }).appendTo(this.getTextLayer(t)); "object" == typeof i ? u.css({ font: o, color: i.color }) : "string" == typeof i && u.addClass(i), c = l[n] = { width: u.outerWidth(!0), height: u.outerHeight(!0), element: u, positions: [] }, u.detach() } return c }, t.prototype.addText = function (e, t, n, i, s, r, o, a, l) { var c = this.getTextInfo(e, i, s, r, o), u = c.positions; "center" == a ? t -= c.width / 2 : "right" == a && (t -= c.width), "middle" == l ? n -= c.height / 2 : "bottom" == l && (n -= c.height); for (var h, d = 0; h = u[d]; d++) if (h.x == t && h.y == n) return void (h.active = !0); h = { active: !0, rendered: !1, element: u.length ? c.element.clone() : c.element, x: t, y: n }, u.push(h), h.element.css({ top: Math.round(n), left: Math.round(t), "text-align": a }) }, t.prototype.removeText = function (e, t, n, i, r, o) { if (null == i) { var a = this._textCache[e]; if (null != a) for (var l in a) if (s.call(a, l)) { var c = a[l]; for (var u in c) if (s.call(c, u)) for (var h, d = c[u].positions, p = 0; h = d[p]; p++) h.active = !1 } } else for (var h, d = this.getTextInfo(e, i, r, o).positions, p = 0; h = d[p]; p++) h.x == t && h.y == n && (h.active = !1) }, e.plot = function (t, i, s) { var r = new n(e(t), i, s, e.plot.plugins); return r }, e.plot.version = "0.8.2", e.plot.plugins = [], e.fn.plot = function (t, n) { return this.each(function () { e.plot(this, t, n) }) }
        }(jQuery), jQuery
    }), define("widgets/continuousGraph", ["jquery", "jqueryui/widget", "flot"], function (e) { "use strict"; e.widget("ted.continuousGraph", { options: { label: "Label", numberOfDataPoints: 120, initialValue: 0, flotConfig: { series: { shadowSize: 0, lines: { fill: !0 } }, colors: ["#ff0000"], yaxis: { min: 0, max: 5e3 }, xaxis: { show: !1 }, legend: { backgroundOpacity: 0 } } }, _create: function () { this.data = []; for (var t = 0; t < this.options.numberOfDataPoints; t++) this.data.push([t, this.options.initialValue]); this.ui = e.plot(this.element, [{ label: this.options.label, data: this.data }], this.options.flotConfig), this._refresh() }, _refresh: function () { this.ui.draw() }, _setOption: function (e, t) { this._super(e, t), this._refresh() }, update: function (e) { this.data.length === this.options.numberOfDataPoints && (this.data = this.data.slice(1)), this.data.push(Math.min(e, this.options.flotConfig.yaxis.max)); for (var t = [], n = 0; n < this.data.length; n++) t.push([n, this.data[n]]); this.ui.setData([{ label: this.options.label, data: t }]), this._refresh() } }) }), define("widgets/videoQos", ["lodash", "jquery", "jqueryui/widget", "widgets/continuousGraph"], function (e, t) { "use strict"; t.widget("ted.videoQos", { options: { bandwidth: 0, bufferLength: 0, fps: 0, droppedFps: 0, bitrate: 0 }, _create: function () { var n = ""; e(["bandwidth", "buffer", "bitrate", "frames", "dropped-frames"]).forEach(function (e) { n += '<div id="' + e + '-graph" class="qos-player-graph"></div>' }), this.element.append('<div class="qos-graph-container">' + n + "</div>"), this.bwGraph = t("#bandwidth-graph"), this.bwGraph.continuousGraph({ label: "Bandwidth (Kbps)", numberOfDataPoints: 120, initialValue: 0, flotConfig: { series: { shadowSize: 0, lines: { fill: !0 } }, colors: ["#ff0000"], yaxis: { min: 0, max: 5e3 }, xaxis: { show: !1 }, legend: { backgroundOpacity: 0 } } }), this.bufferGraph = t("#buffer-graph"), this.bufferGraph.continuousGraph({ label: "Buffer Length (sec)", numberOfDataPoints: 120, initialValue: 0, flotConfig: { series: { shadowSize: 0, lines: { fill: !0 } }, colors: ["#00ff00"], yaxis: { min: 0, max: 20 }, xaxis: { show: !1 }, legend: { backgroundOpacity: 0 } } }), this.bitrateGraph = t("#bitrate-graph"), this.bitrateGraph.continuousGraph({ label: "Bitrate (Kbps)", numberOfDataPoints: 120, initialValue: 0, flotConfig: { series: { shadowSize: 0, lines: { fill: !0 } }, colors: ["#dbe66b"], yaxis: { min: 0, max: 1500 }, xaxis: { show: !1 }, legend: { backgroundOpacity: 0 } } }), this.framesGraph = t("#frames-graph"), this.framesGraph.continuousGraph({ label: "Frames/sec", numberOfDataPoints: 120, initialValue: 0, flotConfig: { series: { shadowSize: 0, lines: { fill: !0 } }, colors: ["#0000ff"], yaxis: { min: 0, max: 30 }, xaxis: { show: !1 }, legend: { backgroundOpacity: 0 } } }), this.droppedFramesGraph = t("#dropped-frames-graph"), this.droppedFramesGraph.continuousGraph({ label: "Dropped Frames/sec", numberOfDataPoints: 120, initialValue: 0, flotConfig: { series: { shadowSize: 0, lines: { fill: !0 } }, colors: ["#644089"], yaxis: { min: 0, max: 30 }, xaxis: { show: !1 }, legend: { backgroundOpacity: 0 } } }), this._refresh() }, _refresh: function () { this.bwGraph.continuousGraph("update", parseInt(this.options.bandwidth, 10)), this.bufferGraph.continuousGraph("update", parseInt(this.options.bufferLength, 10)), this.bitrateGraph.continuousGraph("update", parseInt(this.options.bitrate, 10)), this.framesGraph.continuousGraph("update", parseInt(this.options.fps, 10)), this.droppedFramesGraph.continuousGraph("update", parseInt(this.options.droppedFps, 10)) }, _setOption: function (e, t) { this._super(e, t), this._refresh() }, _destroy: function () { this.element.children(".qos-graph-container").remove() } }) }), define("jqueryui/core", ["jquery"], function () { return function (e, t) { function n(t, n) { var s, r, o, a = t.nodeName.toLowerCase(); return "area" === a ? (s = t.parentNode, r = s.name, t.href && r && "map" === s.nodeName.toLowerCase() ? (o = e("img[usemap=#" + r + "]")[0], !!o && i(o)) : !1) : (/input|select|textarea|button|object/.test(a) ? !t.disabled : "a" === a ? t.href || n : n) && i(t) } function i(t) { return e.expr.filters.visible(t) && !e(t).parents().addBack().filter(function () { return "hidden" === e.css(this, "visibility") }).length } var s = 0, r = /^ui-id-\d+$/; e.ui = e.ui || {}, e.extend(e.ui, { version: "@VERSION", keyCode: { BACKSPACE: 8, COMMA: 188, DELETE: 46, DOWN: 40, END: 35, ENTER: 13, ESCAPE: 27, HOME: 36, LEFT: 37, NUMPAD_ADD: 107, NUMPAD_DECIMAL: 110, NUMPAD_DIVIDE: 111, NUMPAD_ENTER: 108, NUMPAD_MULTIPLY: 106, NUMPAD_SUBTRACT: 109, PAGE_DOWN: 34, PAGE_UP: 33, PERIOD: 190, RIGHT: 39, SPACE: 32, TAB: 9, UP: 38 } }), e.fn.extend({ focus: function (t) { return function (n, i) { return "number" == typeof n ? this.each(function () { var t = this; setTimeout(function () { e(t).focus(), i && i.call(t) }, n) }) : t.apply(this, arguments) } }(e.fn.focus), scrollParent: function () { var t; return t = e.ui.ie && /(static|relative)/.test(this.css("position")) || /absolute/.test(this.css("position")) ? this.parents().filter(function () { return /(relative|absolute|fixed)/.test(e.css(this, "position")) && /(auto|scroll)/.test(e.css(this, "overflow") + e.css(this, "overflow-y") + e.css(this, "overflow-x")) }).eq(0) : this.parents().filter(function () { return /(auto|scroll)/.test(e.css(this, "overflow") + e.css(this, "overflow-y") + e.css(this, "overflow-x")) }).eq(0), /fixed/.test(this.css("position")) || !t.length ? e(document) : t }, zIndex: function (n) { if (n !== t) return this.css("zIndex", n); if (this.length) for (var i, s, r = e(this[0]) ; r.length && r[0] !== document;) { if (i = r.css("position"), ("absolute" === i || "relative" === i || "fixed" === i) && (s = parseInt(r.css("zIndex"), 10), !isNaN(s) && 0 !== s)) return s; r = r.parent() } return 0 }, uniqueId: function () { return this.each(function () { this.id || (this.id = "ui-id-" + ++s) }) }, removeUniqueId: function () { return this.each(function () { r.test(this.id) && e(this).removeAttr("id") }) } }), e.extend(e.expr[":"], { data: e.expr.createPseudo ? e.expr.createPseudo(function (t) { return function (n) { return !!e.data(n, t) } }) : function (t, n, i) { return !!e.data(t, i[3]) }, focusable: function (t) { return n(t, !isNaN(e.attr(t, "tabindex"))) }, tabbable: function (t) { var i = e.attr(t, "tabindex"), s = isNaN(i); return (s || i >= 0) && n(t, !s) } }), e("<a>").outerWidth(1).jquery || e.each(["Width", "Height"], function (n, i) { function s(t, n, i, s) { return e.each(r, function () { n -= parseFloat(e.css(t, "padding" + this)) || 0, i && (n -= parseFloat(e.css(t, "border" + this + "Width")) || 0), s && (n -= parseFloat(e.css(t, "margin" + this)) || 0) }), n } var r = "Width" === i ? ["Left", "Right"] : ["Top", "Bottom"], o = i.toLowerCase(), a = { innerWidth: e.fn.innerWidth, innerHeight: e.fn.innerHeight, outerWidth: e.fn.outerWidth, outerHeight: e.fn.outerHeight }; e.fn["inner" + i] = function (n) { return n === t ? a["inner" + i].call(this) : this.each(function () { e(this).css(o, s(this, n) + "px") }) }, e.fn["outer" + i] = function (t, n) { return "number" != typeof t ? a["outer" + i].call(this, t) : this.each(function () { e(this).css(o, s(this, t, !0, n) + "px") }) } }), e.fn.addBack || (e.fn.addBack = function (e) { return this.add(null == e ? this.prevObject : this.prevObject.filter(e)) }), e("<a>").data("a-b", "a").removeData("a-b").data("a-b") && (e.fn.removeData = function (t) { return function (n) { return arguments.length ? t.call(this, e.camelCase(n)) : t.call(this) } }(e.fn.removeData)), e.ui.ie = !!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()), e.support.selectstart = "onselectstart" in document.createElement("div"), e.fn.extend({ disableSelection: function () { return this.bind((e.support.selectstart ? "selectstart" : "mousedown") + ".ui-disableSelection", function (e) { e.preventDefault() }) }, enableSelection: function () { return this.unbind(".ui-disableSelection") } }), e.extend(e.ui, { plugin: { add: function (t, n, i) { var s, r = e.ui[t].prototype; for (s in i) r.plugins[s] = r.plugins[s] || [], r.plugins[s].push([n, i[s]]) }, call: function (e, t, n) { var i, s = e.plugins[t]; if (s && e.element[0].parentNode && 11 !== e.element[0].parentNode.nodeType) for (i = 0; i < s.length; i++) e.options[s[i][0]] && s[i][1].apply(e.element, n) } }, hasScroll: function (t, n) { if ("hidden" === e(t).css("overflow")) return !1; var i = n && "left" === n ? "scrollLeft" : "scrollTop", s = !1; return t[i] > 0 ? !0 : (t[i] = 1, s = t[i] > 0, t[i] = 0, s) } }) }(jQuery), jQuery }), define("lib/qos", ["widgets/videoQos", "jqueryui/core"], function () { "use strict"; function e() { var e = n.player, i = !1; "flash" === e.player("mode") && (e.on("playermetricsdata", function (n, s) { i && t() && e.videoQos("option", s.metricsData) }), e.on("playermetricstoggle", function () { i = !i, i ? t() || e.videoQos() : t() && e.videoQos("destroy") })) } function t() { return n.player.is(":data(tedVideoQos)") } var n = { player: null }; return n.initQos = e, n }), define("lib/currentUserId", [], function () { "use strict"; return { get: function () { return window._uid ? +window._uid : window._uid } } }), define("lib/favorite", ["exports", "jquery", "lib/ga", "lib/currentUserId", "lib/pubSub"], function (e, t, n, i, s) { "use strict"; function r(e) { var t = !!i.get(); return t || e.reject(new Error("Not logged in")), t } var o = t.Deferred; e.add = function (e) { var i = new o, a = i.promise(); return r(i) ? (t.post("/favorites", e).then(function (e) { s("favorite.add").publish(e), i.resolve(e), n.sendEvent("favorite", "add", e.itemType.toLowerCase()) }, function () { i.reject(new Error("Rejected by server")) }), a) : a }, e.get = function (e) { var n = new o, i = n.promise(); return r(n) ? (t.get("/favorites/find", e).then(function (e) { n.resolve(e) }, function () { n.reject(new Error("Rejected by server")) }), i) : i }, e.remove = function (e) { var n = new o, i = n.promise(); if (!r(n)) return i; var a = { data: e, dataType: "json", type: "DELETE", url: "/favorites/" + e.id }; return t.ajax(a).then(function (e) { s("favorite.remove").publish(e), n.resolve(e) }, function () { n.reject(new Error("Rejected by server")) }), i } }), define("Modernizr", [], function () { "use strict"; return window.Modernizr }), define("lib/personalStorage", ["lodash", "exports", "lib/currentUserId"], function (e, t, n) { "use strict"; function i(n, i) { var s = e.toArray(arguments); return s[1] = t.getKey(i), n.apply(t.storageAdapter, s.slice(1)) } t.storageAdapter = window.localStorage, t.storageAdapter && (t.getKey = function (e) { var t = n.get(); return t || (t = "0"), t + "-" + e }, t.getItem = e.wrap(function (e) { return t.storageAdapter.getItem(e) }, i), t.setItem = e.wrap(function (e, n) { t.storageAdapter.setItem(e, n) }, i), t.removeItem = e.wrap(function (e) { t.storageAdapter.removeItem(e) }, i)) }), define("lib/watchLaterLocal", ["exports", "jquery", "lodash", "Modernizr", "lib/currentUserId", "lib/personalStorage"], function (e, t, n, i, s, r) { "use strict"; function o(e) { return +e.split("|", 1).pop() } function a(e) { return (e.match(/(\|\d+)+/) || "|")[0] + "|" } function l(t) { var n = new c, i = n.promise(), s = e._checkCapability(); return s !== !0 ? (n.reject(s), i) : (t.apply(n, Array.prototype.splice.call(arguments, 1)), i) } var c = t.Deferred, u = "wl", h = null, d = 18e4, p = null; e.addPlaylist = function (t) { return e._add("playlists", t) }, e.addTalk = function (t) { return e._add("talks", t) }, e.checkPlaylist = function (t) { return e._check("playlists", t) }, e.checkTalk = function (t) { return e._check("talks", t) }, e.count = n.wrap(function () { var t = this; e._getCache().then(function (e) { t.resolve({ total: e.talksCount + e.playlistsCount, talks: e.talksCount, playlists: e.playlistsCount }) }, function (e) { t.reject(e) }) }, l), e.removePlaylist = function (t) { return e._remove("playlists", t) }, e.removeTalk = function (t) { return e._remove("talks", t) }, e.sync = n.wrap(function () { if (p) return p; var i = this; return p = i.promise(), t.get("/saved_items/sync.txt").then(function (t) { return t = +new Date + ";" + t, (h = e._fromS(t)) ? (r.setItem(u, t), void i.resolve(h)) : void i.reject(new Error("Invalid response")) }, function () { i.reject(new Error("Rejected by server")) }).always(n.delay(function () { p = null }, d)), p }, l), e._add = n.wrap(function (t, n) { var i = this; e._check(t, n).then(function (s) { s || (h[t + "List"] += n + "|", h[t + "Count"]++, r.setItem(u, e._toS(h))), i.resolve(h) }, function (e) { i.reject(e) }) }, l), e._check = n.wrap(function (t, n) { var i = this; e._getCache().then(function (e) { i.resolve(-1 !== e[t + "List"].indexOf("|" + n + "|")) }, function (e) { i.reject(e) }) }, l), e._checkCapability = function () { return i.localstorage ? s.get() ? !0 : new Error("Not logged in") : new Error("No localStorage") }, e._getCache = function () { var t = new c, n = t.promise(); return h ? (t.resolve(h), n) : (h = e._fromS(r.getItem(u)), h ? (t.resolve(h), +new Date - +h.lastSync > d && e.sync()) : e.sync().then(function () { t.resolve(h) }, function (e) { t.reject(e) }), n) }, e._remove = n.wrap(function (t, n) { var i = this; e._check(t, n).then(function (s) { s && (h[t + "List"] = h[t + "List"].replace("|" + n + "|", "|"), h[t + "Count"]--, r.setItem(u, e._toS(h))), i.resolve(h) }, function (e) { i.reject(e) }) }, l), e._reset = function () { h = null, p = null }, e._fromS = function (e) { if (!e) return null; if (!e.match(/^\d+;\d+(\|\d+)*;\d+(\|\d+)*$/)) return null; var t = e.split(";"); return { lastSync: +t[0], talksCount: o(t[1]), talksList: a(t[1]), playlistsCount: o(t[2]), playlistsList: a(t[2]) } }, e._toS = function (e) { return e ? [e.lastSync, e.talksCount + e.talksList.slice(0, -1), e.playlistsCount + e.playlistsList.slice(0, -1)].join(";") : null } }), define("lib/watchLater", ["exports", "jquery", "lodash", "Modernizr", "lib/ga", "lib/currentUserId", "lib/watchLaterLocal", "lib/pubSub"], function (e, t, n, i, s, r, o, a) {
        "use strict"; function l(e) { return i.localstorage ? r.get() ? !0 : (e.reject(new Error("Not logged in")), !1) : (e.reject(new Error("No localStorage")), !1) } var c = t.Deferred, u = []; e.add = function (e) { var n = new c, i = n.promise(); return l(n) ? (t.post("/saved_items", e).then(function (e) { o["add" + e.itemType](e.itemId), a("watchLater.add").publish(e), n.resolve(e), s.sendEvent("watchLater", "add", e.itemType.toLowerCase()) }, function () { n.reject(new Error("Rejected by server")) }), i) : i }, e.get = function (e) { var i = new c, s = i.promise(); if (!l(i)) return s; var r = { itemId: e.itemId, itemType: e.itemType }, o = n.find(u, r); return o ? o.promise : (r.promise = s, u.push(r), t.get("/saved_items/find", e).then(function (e) { i.resolve(e) }, function () { i.reject(new Error("Rejected by server")) }), s) }, e.remove = function (e) { var n = new c, i = n.promise(); if (!l(n)) return i; var s = { data: e, dataType: "json", type: "DELETE", url: "/saved_items/" + e.id }; return t.ajax(s).then(function (e) { o["remove" + e.itemType](e.itemId), a("watchLater.remove").publish(e), n.resolve(e) }, function () { n.reject(new Error("Rejected by server")) }), i }, e.update = function (e) { var n = new c, i = n.promise(); if (!l(n)) return i; var s = { data: e, dataType: "json", type: "PUT", url: "/saved_items/" + e.id }; return t.ajax(s).then(function (e) { n.resolve(e) }, function () { n.reject(new Error("Rejected by server")) }), i }, e._reset = function () {
            u = []
        }
    }), define("utils/is_mobile", [], function () { "use strict"; var e = navigator ? navigator.userAgent : "", t = function (t) { return t.test(e) }, n = function (e) { return function () { return t(e) } }, i = function () { return i.isIOS() || i.isAndroid() }; return i.isIOS = n(/(iPad|iPhone|iPod)/g), i.isAndroid = n(/Android/g), i }), define("utils/share", ["lodash", "lib/ga", "utils/is_mobile"], function (e, t, n) { "use strict"; var i = { height: 450, message: "", url: location.href, width: 500 }, s = encodeURIComponent, r = { email: { href: "//api.addthis.com/oexchange/0.8/forward/email/offer?url=<%= url %>&title=<%= message %>", ga: "email" }, facebook: { href: "//www.facebook.com/sharer/sharer.php?u=<%= url %>", ga: "facebook" }, gplus: { href: "//plus.google.com/share?url=<%= url %>", ga: "googlePlus" }, linkedin: { href: "//www.linkedin.com/shareArticle?mini=true&url=<%= url %>&title=<%= message %>&source=TED", ga: "linkedIn", height: 500 }, twitter: { href: "//twitter.com/intent/tweet?url=<%= url %>&text=<%= message %>", ga: "twitter" } }; return function (o, a, l) { var c, u = r[o]; if (!u) return !1; a = e.merge({}, i, u, a), c = l ? "" : e.template(a.href, { url: s(a.url), message: s(a.message) }); var h; return h = n.isIOS() && !c ? window : window.open(c, "sharingpopup", ["scrollbars=1", "resizable=1", "height=" + a.height, "width=" + a.width].join(",")), t.sendSocial(o, "start", a.url), h.focus(), h.goToRightUrl = function (t) { c = e.template(a.href, { url: s(t), message: s(a.message) }), h.location = c, h.focus() }, h } }), define("utils/timeFromUrl", [], function () { "use strict"; return function (e) { var t, n, i, s = { offset: !0 }; return e || (e = document.location.href), t = e.match(/#t=(\d+)m(\d+)s[^\/]*/), t && (n = parseInt(t[1], 10), i = parseInt(t[2], 10) + 60 * n, s.offset = !1), t = e.match(/#t-(\d+)[^\/]*/), t && (i = parseInt(t[1], 10) / 1e3), t = e.match(/#(\d+)[^\/]*/), t && (i = parseInt(t[1], 10)), s.seconds = i, s } }), define("templates/helpers/t", ["Handlebars"], function (e) { "use strict"; e.registerHelper("t", function (e) { return e }) }), define("utils/formatDuration", [], function () { "use strict"; function e(e) { return (e > 9 ? "" : "0") + e } return function (t) { var n = t % 60 | 0, i = t / 3600 | 0, s = t % 3600 / 60 | 0; return (i ? i + ":" + e(s) : s) + ":" + e(n) } }), define("templates/helpers/formatDuration", ["Handlebars", "utils/formatDuration"], function (e, t) { "use strict"; e.registerHelper("formatDuration", t) }), define("hbs!templates/talkEndCard", ["hbs", "hbs/handlebars", "templates/helpers/t", "templates/helpers/formatDuration"], function (e, t) { var n = t.template(function (e, t, n, i, s) { function r(e) { var t, i, s, r = ""; return r += '\n        <li class="talk-end-card__item">\n          <a class="l3 talk-end-card__link ga-link" href="/talks/', (i = n.slug) ? t = i.call(e, { hash: {} }) : (i = e && e.slug, t = typeof i === u ? i.call(e, { hash: {} }) : i), r += h(t) + '" data-ga-category="talk.relatedTalk">\n            <img class="talk-end-card__image" src="', (i = n.image) ? t = i.call(e, { hash: {} }) : (i = e && e.image, t = typeof i === u ? i.call(e, { hash: {} }) : i), r += h(t) + '" alt="', (i = n.title) ? t = i.call(e, { hash: {} }) : (i = e && e.title, t = typeof i === u ? i.call(e, { hash: {} }) : i), r += h(t) + '">\n\n            <div class="talk-end-card__speaker">', (i = n.speaker) ? t = i.call(e, { hash: {} }) : (i = e && e.speaker, t = typeof i === u ? i.call(e, { hash: {} }) : i), r += h(t) + '</div>\n            <div class="talk-end-card__title">', (i = n.title) ? t = i.call(e, { hash: {} }) : (i = e && e.title, t = typeof i === u ? i.call(e, { hash: {} }) : i), r += h(t) + '</div>\n            <div class="talk-end-card__duration">' + h((i = n.formatDuration || e && e.formatDuration, s = { hash: {} }, i ? i.call(e, e && e.duration, s) : d.call(e, "formatDuration", e && e.duration, s))) + "</div>\n          </a>\n        </li>\n      " } this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var o, a, l, c = "", u = "function", h = this.escapeExpression, d = n.helperMissing, p = this; return c += '\n\n<div class="talk-end-card">\n  <h2 class="talk-end-card__headline">' + h((a = n.t || t && t.t, l = { hash: {} }, a ? a.call(t, "More TED Talks", l) : d.call(t, "t", "More TED Talks", l))) + '</h2>\n\n  <div class="talk-end-card__container">\n    <ul class="talk-end-card__list">\n      ', o = n.each.call(t, t && t.relatedTalks, { hash: {}, inverse: p.noop, fn: p.program(1, r, s) }), (o || 0 === o) && (c += o), c += "\n    </ul>\n  </div>\n</div>\n" }); return n }), define("hbs!templates/talkViewsBreakdown", ["hbs", "hbs/handlebars"], function (e, t) { var n = t.template(function (e, t, n, i, s) { function r(e) { var t, i, s = ""; return s += '\n      <li class="talk-breakdown__source">\n        <span class="talk-breakdown__source__bar" style="width:', (i = n.width) ? t = i.call(e, { hash: {} }) : (i = e && e.width, t = typeof i === l ? i.call(e, { hash: {} }) : i), s += c(t) + '%"></span>\n        <span class="talk-breakdown__source__label">', (i = n.value) ? t = i.call(e, { hash: {} }) : (i = e && e.value, t = typeof i === l ? i.call(e, { hash: {} }) : i), s += c(t) + "% ", (i = n.label) ? t = i.call(e, { hash: {} }) : (i = e && e.label, t = typeof i === l ? i.call(e, { hash: {} }) : i), s += c(t) + "</span>\n      </li>\n    " } this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var o, a = "", l = "function", c = this.escapeExpression, u = this; return a += '\n\n<div class="talk-breakdown">\n  <p><strong>This number combines views from the following outlets:</strong></p>\n\n  <ul class="sl talk-breakdown__sources">\n    ', o = n.each.call(t, t && t.sources, { hash: {}, inverse: u.noop, fn: u.program(1, r, s) }), (o || 0 === o) && (a += o), a += "\n  </ul>\n</div>\n" }); return n }), function (e, t) { "undefined" != typeof exports ? t(e, exports, require("underscore")) : "function" == typeof define && define.amd ? define("Backbone", ["underscore", "jquery", "exports"], function (n, i, s) { e.Backbone = t(e, s, n, i) }) : e.Backbone = t(e, {}, e._, e.jQuery || e.Zepto || e.ender || e.$) }(this, function (e, t, n, i) { var s = e.Backbone, r = [], o = r.push, a = r.slice, l = r.splice; t.VERSION = "1.0.0", t.$ = i, t.noConflict = function () { return e.Backbone = s, this }, t.emulateHTTP = !1, t.emulateJSON = !1; var c = t.Events = { on: function (e, t, n) { if (!h(this, "on", e, [t, n]) || !t) return this; this._events || (this._events = {}); var i = this._events[e] || (this._events[e] = []); return i.push({ callback: t, context: n, ctx: n || this }), this }, once: function (e, t, i) { if (!h(this, "once", e, [t, i]) || !t) return this; var s = this, r = n.once(function () { s.off(e, r), t.apply(this, arguments) }); return r._callback = t, this.on(e, r, i) }, off: function (e, t, i) { var s, r, o, a, l, c, u, d; if (!this._events || !h(this, "off", e, [t, i])) return this; if (!e && !t && !i) return this._events = {}, this; for (a = e ? [e] : n.keys(this._events), l = 0, c = a.length; c > l; l++) if (e = a[l], o = this._events[e]) { if (this._events[e] = s = [], t || i) for (u = 0, d = o.length; d > u; u++) r = o[u], (t && t !== r.callback && t !== r.callback._callback || i && i !== r.context) && s.push(r); s.length || delete this._events[e] } return this }, trigger: function (e) { if (!this._events) return this; var t = a.call(arguments, 1); if (!h(this, "trigger", e, t)) return this; var n = this._events[e], i = this._events.all; return n && d(n, t), i && d(i, arguments), this }, stopListening: function (e, t, n) { var i = this._listeners; if (!i) return this; var s = !t && !n; "object" == typeof t && (n = this), e && ((i = {})[e._listenerId] = e); for (var r in i) i[r].off(t, n, this), s && delete this._listeners[r]; return this } }, u = /\s+/, h = function (e, t, n, i) { if (!n) return !0; if ("object" == typeof n) { for (var s in n) e[t].apply(e, [s, n[s]].concat(i)); return !1 } if (u.test(n)) { for (var r = n.split(u), o = 0, a = r.length; a > o; o++) e[t].apply(e, [r[o]].concat(i)); return !1 } return !0 }, d = function (e, t) { var n, i = -1, s = e.length, r = t[0], o = t[1], a = t[2]; switch (t.length) { case 0: for (; ++i < s;) (n = e[i]).callback.call(n.ctx); return; case 1: for (; ++i < s;) (n = e[i]).callback.call(n.ctx, r); return; case 2: for (; ++i < s;) (n = e[i]).callback.call(n.ctx, r, o); return; case 3: for (; ++i < s;) (n = e[i]).callback.call(n.ctx, r, o, a); return; default: for (; ++i < s;) (n = e[i]).callback.apply(n.ctx, t) } }, p = { listenTo: "on", listenToOnce: "once" }; n.each(p, function (e, t) { c[t] = function (t, i, s) { var r = this._listeners || (this._listeners = {}), o = t._listenerId || (t._listenerId = n.uniqueId("l")); return r[o] = t, "object" == typeof i && (s = this), t[e](i, s, this), this } }), c.bind = c.on, c.unbind = c.off, n.extend(t, c); var f = t.Model = function (e, t) { var i, s = e || {}; t || (t = {}), this.cid = n.uniqueId("c"), this.attributes = {}, n.extend(this, n.pick(t, m)), t.parse && (s = this.parse(s, t) || {}), (i = n.result(this, "defaults")) && (s = n.defaults({}, s, i)), this.set(s, t), this.changed = {}, this.initialize.apply(this, arguments) }, m = ["url", "urlRoot", "collection"]; n.extend(f.prototype, c, { changed: null, validationError: null, idAttribute: "id", initialize: function () { }, toJSON: function () { return n.clone(this.attributes) }, sync: function () { return t.sync.apply(this, arguments) }, get: function (e) { return this.attributes[e] }, escape: function (e) { return n.escape(this.get(e)) }, has: function (e) { return null != this.get(e) }, set: function (e, t, i) { var s, r, o, a, l, c, u, h; if (null == e) return this; if ("object" == typeof e ? (r = e, i = t) : (r = {})[e] = t, i || (i = {}), !this._validate(r, i)) return !1; o = i.unset, l = i.silent, a = [], c = this._changing, this._changing = !0, c || (this._previousAttributes = n.clone(this.attributes), this.changed = {}), h = this.attributes, u = this._previousAttributes, this.idAttribute in r && (this.id = r[this.idAttribute]); for (s in r) t = r[s], n.isEqual(h[s], t) || a.push(s), n.isEqual(u[s], t) ? delete this.changed[s] : this.changed[s] = t, o ? delete h[s] : h[s] = t; if (!l) { a.length && (this._pending = !0); for (var d = 0, p = a.length; p > d; d++) this.trigger("change:" + a[d], this, h[a[d]], i) } if (c) return this; if (!l) for (; this._pending;) this._pending = !1, this.trigger("change", this, i); return this._pending = !1, this._changing = !1, this }, unset: function (e, t) { return this.set(e, void 0, n.extend({}, t, { unset: !0 })) }, clear: function (e) { var t = {}; for (var i in this.attributes) t[i] = void 0; return this.set(t, n.extend({}, e, { unset: !0 })) }, hasChanged: function (e) { return null == e ? !n.isEmpty(this.changed) : n.has(this.changed, e) }, changedAttributes: function (e) { if (!e) return this.hasChanged() ? n.clone(this.changed) : !1; var t, i = !1, s = this._changing ? this._previousAttributes : this.attributes; for (var r in e) n.isEqual(s[r], t = e[r]) || ((i || (i = {}))[r] = t); return i }, previous: function (e) { return null != e && this._previousAttributes ? this._previousAttributes[e] : null }, previousAttributes: function () { return n.clone(this._previousAttributes) }, fetch: function (e) { e = e ? n.clone(e) : {}, void 0 === e.parse && (e.parse = !0); var t = this, i = e.success; return e.success = function (n) { return t.set(t.parse(n, e), e) ? (i && i(t, n, e), void t.trigger("sync", t, n, e)) : !1 }, F(this, e), this.sync("read", this, e) }, save: function (e, t, i) { var s, r, o, a = this.attributes; if (null == e || "object" == typeof e ? (s = e, i = t) : (s = {})[e] = t, !(!s || i && i.wait || this.set(s, i))) return !1; if (i = n.extend({ validate: !0 }, i), !this._validate(s, i)) return !1; s && i.wait && (this.attributes = n.extend({}, a, s)), void 0 === i.parse && (i.parse = !0); var l = this, c = i.success; return i.success = function (e) { l.attributes = a; var t = l.parse(e, i); return i.wait && (t = n.extend(s || {}, t)), n.isObject(t) && !l.set(t, i) ? !1 : (c && c(l, e, i), void l.trigger("sync", l, e, i)) }, F(this, i), r = this.isNew() ? "create" : i.patch ? "patch" : "update", "patch" === r && (i.attrs = s), o = this.sync(r, this, i), s && i.wait && (this.attributes = a), o }, destroy: function (e) { e = e ? n.clone(e) : {}; var t = this, i = e.success, s = function () { t.trigger("destroy", t, t.collection, e) }; if (e.success = function (n) { (e.wait || t.isNew()) && s(), i && i(t, n, e), t.isNew() || t.trigger("sync", t, n, e) }, this.isNew()) return e.success(), !1; F(this, e); var r = this.sync("delete", this, e); return e.wait || s(), r }, url: function () { var e = n.result(this, "urlRoot") || n.result(this.collection, "url") || z(); return this.isNew() ? e : e + ("/" === e.charAt(e.length - 1) ? "" : "/") + encodeURIComponent(this.id) }, parse: function (e) { return e }, clone: function () { return new this.constructor(this.attributes) }, isNew: function () { return null == this.id }, isValid: function (e) { return this._validate({}, n.extend(e || {}, { validate: !0 })) }, _validate: function (e, t) { if (!t.validate || !this.validate) return !0; e = n.extend({}, this.attributes, e); var i = this.validationError = this.validate(e, t) || null; return i ? (this.trigger("invalid", this, i, n.extend(t || {}, { validationError: i })), !1) : !0 } }); var g = ["keys", "values", "pairs", "invert", "pick", "omit"]; n.each(g, function (e) { f.prototype[e] = function () { var t = a.call(arguments); return t.unshift(this.attributes), n[e].apply(n, t) } }); var v = t.Collection = function (e, t) { t || (t = {}), t.url && (this.url = t.url), t.model && (this.model = t.model), void 0 !== t.comparator && (this.comparator = t.comparator), this._reset(), this.initialize.apply(this, arguments), e && this.reset(e, n.extend({ silent: !0 }, t)) }, _ = { add: !0, remove: !0, merge: !0 }, y = { add: !0, merge: !1, remove: !1 }; n.extend(v.prototype, c, { model: f, initialize: function () { }, toJSON: function (e) { return this.map(function (t) { return t.toJSON(e) }) }, sync: function () { return t.sync.apply(this, arguments) }, add: function (e, t) { return this.set(e, n.defaults(t || {}, y)) }, remove: function (e, t) { e = n.isArray(e) ? e.slice() : [e], t || (t = {}); var i, s, r, o; for (i = 0, s = e.length; s > i; i++) o = this.get(e[i]), o && (delete this._byId[o.id], delete this._byId[o.cid], r = this.indexOf(o), this.models.splice(r, 1), this.length--, t.silent || (t.index = r, o.trigger("remove", o, this, t)), this._removeReference(o)); return this }, set: function (e, t) { t = n.defaults(t || {}, _), t.parse && (e = this.parse(e, t)), n.isArray(e) || (e = e ? [e] : []); var i, s, r, a, c, u = t.at, h = this.comparator && null == u && t.sort !== !1, d = n.isString(this.comparator) ? this.comparator : null, p = [], f = [], m = {}; for (i = 0, s = e.length; s > i; i++) (r = this._prepareModel(e[i], t)) && ((a = this.get(r)) ? (t.remove && (m[a.cid] = !0), t.merge && (a.set(r.attributes, t), h && !c && a.hasChanged(d) && (c = !0))) : t.add && (p.push(r), r.on("all", this._onModelEvent, this), this._byId[r.cid] = r, null != r.id && (this._byId[r.id] = r))); if (t.remove) { for (i = 0, s = this.length; s > i; ++i) m[(r = this.models[i]).cid] || f.push(r); f.length && this.remove(f, t) } if (p.length && (h && (c = !0), this.length += p.length, null != u ? l.apply(this.models, [u, 0].concat(p)) : o.apply(this.models, p)), c && this.sort({ silent: !0 }), t.silent) return this; for (i = 0, s = p.length; s > i; i++) (r = p[i]).trigger("add", r, this, t); return c && this.trigger("sort", this, t), this }, reset: function (e, t) { t || (t = {}); for (var i = 0, s = this.models.length; s > i; i++) this._removeReference(this.models[i]); return t.previousModels = this.models, this._reset(), this.add(e, n.extend({ silent: !0 }, t)), t.silent || this.trigger("reset", this, t), this }, push: function (e, t) { return e = this._prepareModel(e, t), this.add(e, n.extend({ at: this.length }, t)), e }, pop: function (e) { var t = this.at(this.length - 1); return this.remove(t, e), t }, unshift: function (e, t) { return e = this._prepareModel(e, t), this.add(e, n.extend({ at: 0 }, t)), e }, shift: function (e) { var t = this.at(0); return this.remove(t, e), t }, slice: function (e, t) { return this.models.slice(e, t) }, get: function (e) { return null == e ? void 0 : this._byId[null != e.id ? e.id : e.cid || e] }, at: function (e) { return this.models[e] }, where: function (e, t) { return n.isEmpty(e) ? t ? void 0 : [] : this[t ? "find" : "filter"](function (t) { for (var n in e) if (e[n] !== t.get(n)) return !1; return !0 }) }, findWhere: function (e) { return this.where(e, !0) }, sort: function (e) { if (!this.comparator) throw new Error("Cannot sort a set without a comparator"); return e || (e = {}), n.isString(this.comparator) || 1 === this.comparator.length ? this.models = this.sortBy(this.comparator, this) : this.models.sort(n.bind(this.comparator, this)), e.silent || this.trigger("sort", this, e), this }, sortedIndex: function (e, t, i) { t || (t = this.comparator); var s = n.isFunction(t) ? t : function (e) { return e.get(t) }; return n.sortedIndex(this.models, e, s, i) }, pluck: function (e) { return n.invoke(this.models, "get", e) }, fetch: function (e) { e = e ? n.clone(e) : {}, void 0 === e.parse && (e.parse = !0); var t = e.success, i = this; return e.success = function (n) { var s = e.reset ? "reset" : "set"; i[s](n, e), t && t(i, n, e), i.trigger("sync", i, n, e) }, F(this, e), this.sync("read", this, e) }, create: function (e, t) { if (t = t ? n.clone(t) : {}, !(e = this._prepareModel(e, t))) return !1; t.wait || this.add(e, t); var i = this, s = t.success; return t.success = function (n) { t.wait && i.add(e, t), s && s(e, n, t) }, e.save(null, t), e }, parse: function (e) { return e }, clone: function () { return new this.constructor(this.models) }, _reset: function () { this.length = 0, this.models = [], this._byId = {} }, _prepareModel: function (e, t) { if (e instanceof f) return e.collection || (e.collection = this), e; t || (t = {}), t.collection = this; var n = new this.model(e, t); return n._validate(e, t) ? n : (this.trigger("invalid", this, e, t), !1) }, _removeReference: function (e) { this === e.collection && delete e.collection, e.off("all", this._onModelEvent, this) }, _onModelEvent: function (e, t, n, i) { ("add" !== e && "remove" !== e || n === this) && ("destroy" === e && this.remove(t, i), t && e === "change:" + t.idAttribute && (delete this._byId[t.previous(t.idAttribute)], null != t.id && (this._byId[t.id] = t)), this.trigger.apply(this, arguments)) } }); var b = ["forEach", "each", "map", "collect", "reduce", "foldl", "inject", "reduceRight", "foldr", "find", "detect", "filter", "select", "reject", "every", "all", "some", "any", "include", "contains", "invoke", "max", "min", "toArray", "size", "first", "head", "take", "initial", "rest", "tail", "drop", "last", "without", "indexOf", "shuffle", "lastIndexOf", "isEmpty", "chain"]; n.each(b, function (e) { v.prototype[e] = function () { var t = a.call(arguments); return t.unshift(this.models), n[e].apply(n, t) } }); var w = ["groupBy", "countBy", "sortBy"]; n.each(w, function (e) { v.prototype[e] = function (t, i) { var s = n.isFunction(t) ? t : function (e) { return e.get(t) }; return n[e](this.models, s, i) } }); var k = t.View = function (e) { this.cid = n.uniqueId("view"), this._configure(e || {}), this._ensureElement(), this.initialize.apply(this, arguments), this.delegateEvents() }, x = /^(\S+)\s*(.*)$/, S = ["model", "collection", "el", "id", "attributes", "className", "tagName", "events"]; n.extend(k.prototype, c, { tagName: "div", $: function (e) { return this.$el.find(e) }, initialize: function () { }, render: function () { return this }, remove: function () { return this.$el.remove(), this.stopListening(), this }, setElement: function (e, n) { return this.$el && this.undelegateEvents(), this.$el = e instanceof t.$ ? e : t.$(e), this.el = this.$el[0], n !== !1 && this.delegateEvents(), this }, delegateEvents: function (e) { if (!e && !(e = n.result(this, "events"))) return this; this.undelegateEvents(); for (var t in e) { var i = e[t]; if (n.isFunction(i) || (i = this[e[t]]), i) { var s = t.match(x), r = s[1], o = s[2]; i = n.bind(i, this), r += ".delegateEvents" + this.cid, "" === o ? this.$el.on(r, i) : this.$el.on(r, o, i) } } return this }, undelegateEvents: function () { return this.$el.off(".delegateEvents" + this.cid), this }, _configure: function (e) { this.options && (e = n.extend({}, n.result(this, "options"), e)), n.extend(this, n.pick(e, S)), this.options = e }, _ensureElement: function () { if (this.el) this.setElement(n.result(this, "el"), !1); else { var e = n.extend({}, n.result(this, "attributes")); this.id && (e.id = n.result(this, "id")), this.className && (e["class"] = n.result(this, "className")); var i = t.$("<" + n.result(this, "tagName") + ">").attr(e); this.setElement(i, !1) } } }), t.sync = function (e, i, s) { var r = C[e]; n.defaults(s || (s = {}), { emulateHTTP: t.emulateHTTP, emulateJSON: t.emulateJSON }); var o = { type: r, dataType: "json" }; if (s.url || (o.url = n.result(i, "url") || z()), null != s.data || !i || "create" !== e && "update" !== e && "patch" !== e || (o.contentType = "application/json", o.data = JSON.stringify(s.attrs || i.toJSON(s))), s.emulateJSON && (o.contentType = "application/x-www-form-urlencoded", o.data = o.data ? { model: o.data } : {}), s.emulateHTTP && ("PUT" === r || "DELETE" === r || "PATCH" === r)) { o.type = "POST", s.emulateJSON && (o.data._method = r); var a = s.beforeSend; s.beforeSend = function (e) { return e.setRequestHeader("X-HTTP-Method-Override", r), a ? a.apply(this, arguments) : void 0 } } "GET" === o.type || s.emulateJSON || (o.processData = !1), "PATCH" !== o.type || !window.ActiveXObject || window.external && window.external.msActiveXFilteringEnabled || (o.xhr = function () { return new ActiveXObject("Microsoft.XMLHTTP") }); var l = s.xhr = t.ajax(n.extend(o, s)); return i.trigger("request", i, l, s), l }; var C = { create: "POST", update: "PUT", patch: "PATCH", "delete": "DELETE", read: "GET" }; t.ajax = function () { return t.$.ajax.apply(t.$, arguments) }; var T = t.Router = function (e) { e || (e = {}), e.routes && (this.routes = e.routes), this._bindRoutes(), this.initialize.apply(this, arguments) }, E = /\((.*?)\)/g, M = /(\(\?)?:\w+/g, D = /\*\w+/g, I = /[\-{}\[\]+?.,\\\^$|#\s]/g; n.extend(T.prototype, c, { initialize: function () { }, route: function (e, i, s) { n.isRegExp(e) || (e = this._routeToRegExp(e)), n.isFunction(i) && (s = i, i = ""), s || (s = this[i]); var r = this; return t.history.route(e, function (n) { var o = r._extractParameters(e, n); s && s.apply(r, o), r.trigger.apply(r, ["route:" + i].concat(o)), r.trigger("route", i, o), t.history.trigger("route", r, i, o) }), this }, navigate: function (e, n) { return t.history.navigate(e, n), this }, _bindRoutes: function () { if (this.routes) { this.routes = n.result(this, "routes"); for (var e, t = n.keys(this.routes) ; null != (e = t.pop()) ;) this.route(e, this.routes[e]) } }, _routeToRegExp: function (e) { return e = e.replace(I, "\\$&").replace(E, "(?:$1)?").replace(M, function (e, t) { return t ? e : "([^/]+)" }).replace(D, "(.*?)"), new RegExp("^" + e + "$") }, _extractParameters: function (e, t) { var i = e.exec(t).slice(1); return n.map(i, function (e) { return e ? decodeURIComponent(e) : null }) } }); var O = t.History = function () { this.handlers = [], n.bindAll(this, "checkUrl"), "undefined" != typeof window && (this.location = window.location, this.history = window.history) }, P = /^[#\/]|\s+$/g, N = /^\/+|\/+$/g, A = /msie [\w.]+/, j = /\/$/; O.started = !1, n.extend(O.prototype, c, { interval: 50, getHash: function (e) { var t = (e || this).location.href.match(/#(.*)$/); return t ? t[1] : "" }, getFragment: function (e, t) { if (null == e) if (this._hasPushState || !this._wantsHashChange || t) { e = this.location.pathname; var n = this.root.replace(j, ""); e.indexOf(n) || (e = e.substr(n.length)) } else e = this.getHash(); return e.replace(P, "") }, start: function (e) { if (O.started) throw new Error("Backbone.history has already been started"); O.started = !0, this.options = n.extend({}, { root: "/" }, this.options, e), this.root = this.options.root, this._wantsHashChange = this.options.hashChange !== !1, this._wantsPushState = !!this.options.pushState, this._hasPushState = !!(this.options.pushState && this.history && this.history.pushState); var i = this.getFragment(), s = document.documentMode, r = A.exec(navigator.userAgent.toLowerCase()) && (!s || 7 >= s); this.root = ("/" + this.root + "/").replace(N, "/"), r && this._wantsHashChange && (this.iframe = t.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow, this.navigate(i)), this._hasPushState ? t.$(window).on("popstate", this.checkUrl) : this._wantsHashChange && "onhashchange" in window && !r ? t.$(window).on("hashchange", this.checkUrl) : this._wantsHashChange && (this._checkUrlInterval = setInterval(this.checkUrl, this.interval)), this.fragment = i; var o = this.location, a = o.pathname.replace(/[^\/]$/, "$&/") === this.root; return this._wantsHashChange && this._wantsPushState && !this._hasPushState && !a ? (this.fragment = this.getFragment(null, !0), this.location.replace(this.root + this.location.search + "#" + this.fragment), !0) : (this._wantsPushState && this._hasPushState && a && o.hash && (this.fragment = this.getHash().replace(P, ""), this.history.replaceState({}, document.title, this.root + this.fragment + o.search)), this.options.silent ? void 0 : this.loadUrl()) }, stop: function () { t.$(window).off("popstate", this.checkUrl).off("hashchange", this.checkUrl), clearInterval(this._checkUrlInterval), O.started = !1 }, route: function (e, t) { this.handlers.unshift({ route: e, callback: t }) }, checkUrl: function () { var e = this.getFragment(); return e === this.fragment && this.iframe && (e = this.getFragment(this.getHash(this.iframe))), e === this.fragment ? !1 : (this.iframe && this.navigate(e), void (this.loadUrl() || this.loadUrl(this.getHash()))) }, loadUrl: function (e) { var t = this.fragment = this.getFragment(e), i = n.any(this.handlers, function (e) { return e.route.test(t) ? (e.callback(t), !0) : void 0 }); return i }, navigate: function (e, t) { if (!O.started) return !1; if (t && t !== !0 || (t = { trigger: t }), e = this.getFragment(e || ""), this.fragment !== e) { this.fragment = e; var n = this.root + e; if (this._hasPushState) this.history[t.replace ? "replaceState" : "pushState"]({}, document.title, n); else { if (!this._wantsHashChange) return this.location.assign(n); this._updateHash(this.location, e, t.replace), this.iframe && e !== this.getFragment(this.getHash(this.iframe)) && (t.replace || this.iframe.document.open().close(), this._updateHash(this.iframe.location, e, t.replace)) } t.trigger && this.loadUrl(e) } }, _updateHash: function (e, t, n) { if (n) { var i = e.href.replace(/(javascript:|#).*$/, ""); e.replace(i + "#" + t) } else e.hash = "#" + t } }), t.history = new O; var L = function (e, t) { var i, s = this; i = e && n.has(e, "constructor") ? e.constructor : function () { return s.apply(this, arguments) }, n.extend(i, s, t); var r = function () { this.constructor = i }; return r.prototype = s.prototype, i.prototype = new r, e && n.extend(i.prototype, e), i.__super__ = s.prototype, i }; f.extend = v.extend = T.extend = k.extend = O.extend = L; var z = function () { throw new Error('A "url" property or function must be specified') }, F = function (e, t) { var n = t.error; t.error = function (i) { n && n(e, i, t), e.trigger("error", e, i, t) } }; return t }), define("hbs!templates/commentApologyModal", ["hbs", "hbs/handlebars", "templates/helpers/t"], function (e, t) { var n = t.template(function (e, t, n) { this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var i, s, r = "", o = n.helperMissing, a = this.escapeExpression; return r += '\n\n<div>\n  \n  <div class="modal__head">\n    <a class="modal__close modal__head__close" href="#">\n      <i class="g-button-modal-close">' + a((i = n.t || t && t.t, s = { hash: {} }, i ? i.call(t, "Close", s) : o.call(t, "t", "Close", s))) + '</i>\n    </a>\n    <h3 class="modal__head__title">' + a((i = n.t || t && t.t, s = { hash: {} }, i ? i.call(t, "Could not save comment", s) : o.call(t, "t", "Could not save comment", s))) + "</h3>\n  </div>\n\n  <p>" + a((i = n.t || t && t.t, s = { hash: {} }, i ? i.call(t, "Sorry: we're currently experiencing difficulties and were unable to save your comment.", s) : o.call(t, "t", "Sorry: we're currently experiencing difficulties and were unable to save your comment.", s))) + "</p>\n</div>\n" }); return n }), define("lib/currentUser", ["jquery", "lodash", "lib/currentUserId", "lib/personalStorage"], function (e, t, n, i) { "use strict"; function s(e) { return t.isFinite(e) ? +e : null } function r(e) { return e ? "" + e : null } function o(e) { return e = t.pick(e, S), t.forOwn(e, function (t, n) { e[n] = x[n](t) }), e } function a(e) { return e && JSON.parse(e) } function l() { return o(a(b.storageAdapter.getItem(w))) } function c() { return e.get("/me.json", { c: n.get() + "-" + Math.round(+new Date / 1e3 / 120) }) } function u(e) { c().then(t.bind(h, b, e), t.bind(d, b, e)) } function h(e, t) { return t ? (t.lastDownloaded = (new Date).getTime(), v = o(t), void (g(e) && b.storageAdapter.setItem(w, JSON.stringify(v)))) : void d(e, t) } function d(e) { p(), e.reject() } function p() { v = null, b.storageAdapter.removeItem(w), e(document.documentElement).removeClass("loggedin").addClass("loggedout") } function f(e, t) { var n = (new Date).getTime(); return e > n - (t || 0) } function m() { return b._check(v) } function g(e) { var t = m(); return t ? e.resolve(v) : (p(), e.reject()), t } var v, _ = function (e) { return !!e }, y = e.Deferred, b = {}, w = "me", k = !0, x = { id: s, profileId: s, firstName: r, lastName: r, avatarUrl: r, hasConferences: _, isCommentModerator: _, hasEdActivity: _, isTEDxOrganizer: _, lastDownloaded: s }, S = t.keys(x); return b.storageAdapter = i, b.getDetails = function () { var e = new y; return v = v || l(), m() || (v = null), v ? (e.resolve(v), k && !f(18e4, v.lastDownloaded) && (k = !1, u(new y))) : n.get() ? u(e) : e.reject(), e.promise() }, b._check = function (e) { var i = 864e5; return e && +e.id === +n.get() && S.length === t.keys(t.pick(e, S)).length && f(i, e.lastDownloaded) }, b._reset = function () { v = void 0, k = !0 }, b }), define("hbs!templates/authRequest", ["hbs", "hbs/handlebars", "templates/helpers/t"], function (e, t) { var n = t.template(function (e, t, n) { this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var i, s, r = "", o = n.helperMissing, a = this.escapeExpression; return r += '\n\n<div>\n  \n  <div class="modal__head">\n    <a class="modal__close modal__head__close" href="#">\n      <i class="g-button-modal-close">' + a((i = n.t || t && t.t, s = { hash: {} }, i ? i.call(t, "Close", s) : o.call(t, "t", "Close", s))) + '</i>\n    </a>\n    <h3 class="modal__head__title">' + a((i = n.t || t && t.t, s = { hash: {} }, i ? i.call(t, "Please log in", s) : o.call(t, "t", "Please log in", s))) + "</h3>\n  </div>\n\n  <p>" + a((i = n.t || t && t.t, s = { hash: {} }, i ? i.call(t, "Please log in or sign up to complete this action.", s) : o.call(t, "t", "Please log in or sign up to complete this action.", s))) + '</p>\n  <p><a class="l3" href="/session/new">' + a((i = n.t || t && t.t, s = { hash: {} }, i ? i.call(t, "Log in or sign up", s) : o.call(t, "t", "Log in or sign up", s))) + "</a></p>\n</div>\n" }); return n }), define("hbs!templates/modalDefault", ["hbs", "hbs/handlebars", "templates/helpers/t"], function (e, t) { var n = t.template(function (e, t, n) { this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var i, s, r, o = "", a = n.helperMissing, l = this.escapeExpression, c = "function"; return o += '\n\n<div class="modal__head">\n  <a class="modal__close modal__head__close" href="#">\n    <i class="g-button-modal-close">' + l((s = n.t || t && t.t, r = { hash: {} }, s ? s.call(t, "Close", r) : a.call(t, "t", "Close", r))) + '</i>\n  </a>\n  <h3 class="modal__head__title">', (s = n.title) ? i = s.call(t, { hash: {} }) : (s = t && t.title, i = typeof s === c ? s.call(t, { hash: {} }) : s), o += l(i) + "</h3>\n</div>\n" }); return n }), define("widgets/modal", ["jquery", "lodash", "hbs!templates/modalDefault", "lib/pubSub", "jqueryui/widget", "lib/resize"], function (e, t, n, i) { "use strict"; function s() { u || (c = e(window), a = e(document.body), l = e("html")) } var r, o, a, l, c, u = 0, h = "modal-backdrop--show", d = "modal--show", p = "modal-open", f = "modal__content", m = 0; return o = ["<div class=modal>", "<div class=modal__outer>", "<div class=modal__inner>"].join(""), i("breakpoint").subscribe(function (e) { r = 768 > e }), e.widget("ted.modal", { options: { autoOpen: !0 }, _create: function () { var t = this; s(), this.options.title && this.element.prepend(n(this.options)), this.modal = this.element.addClass(f).css("display", "").wrap(o).closest("div.modal"), this.backdrop = e("<div class=modal-backdrop>"), this.wrapper = e("<div class=modal-wrapper>").append(this.backdrop).append(this.modal), this.wrapper.on("click", function (n) { return r ? !0 : e(n.target).closest("div.modal__content").length ? !0 : (n.preventDefault(), void t.close()) }), a.append(this.wrapper), this._on("a.modal__close", { click: function (e) { e.preventDefault(), t.close() } }), this.options.autoOpen && this.open() }, _destroy: function () { var e = this; t.defer(function () { e.wrapper.remove() }) }, open: function () { this.backdrop.addClass(h), this.openedAt = { y: c.scrollTop() }, m++ || l.addClass(p), r && window.scrollTo(0, 0), this.modal.addClass(d), this._trigger("open") }, close: function () { this.modal.removeClass(d), --m || l.removeClass(p), this.openedAt && window.scrollTo(0, this.openedAt.y), this.backdrop.removeClass(h), this._trigger("close") } }), function (t, n) { return e(t).modal(n) } }), define("views/AuthView", ["jquery", "lodash", "Backbone", "lib/currentUser", "hbs!templates/authRequest", "widgets/modal"], function (e, t, n, i, s) { "use strict"; function r() { o ? o.modal("open") : o = e(s()).modal() } var o, a = t.memoize(function () { return i.getDetails() }), l = n.View.extend({ demandAuthFor: function (e) { if (arguments.length > 1) return void this.demandAuthFor(t.toArray(arguments)); if (t.isArray(e)) return void t.each(e, function (e) { this.demandAuthFor(e) }, this); var n = this[e]; this[e] = function () { var e = arguments, t = this; a().then(function () { n.apply(t, e) }, function () { r() }) } } }); return l }), function (e) {
        function t(e, t) { return function (n) { return l(e.call(this, n), t) } } function n(e, t) { return function (n) { return this.lang().ordinal(e.call(this, n), t) } } function i() { } function s(e) { o(this, e) } function r(e) { var t = e.years || e.year || e.y || 0, n = e.months || e.month || e.M || 0, i = e.weeks || e.week || e.w || 0, s = e.days || e.day || e.d || 0, r = e.hours || e.hour || e.h || 0, o = e.minutes || e.minute || e.m || 0, a = e.seconds || e.second || e.s || 0, l = e.milliseconds || e.millisecond || e.ms || 0; this._input = e, this._milliseconds = l + 1e3 * a + 6e4 * o + 36e5 * r, this._days = s + 7 * i, this._months = n + 12 * t, this._data = {}, this._bubble() } function o(e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]); return e } function a(e) { return 0 > e ? Math.ceil(e) : Math.floor(e) } function l(e, t) { for (var n = e + ""; n.length < t;) n = "0" + n; return n } function c(e, t, n, i) { var s, r, o = t._milliseconds, a = t._days, l = t._months; o && e._d.setTime(+e._d + o * n), (a || l) && (s = e.minute(), r = e.hour()), a && e.date(e.date() + a * n), l && e.month(e.month() + l * n), o && !i && N.updateOffset(e), (a || l) && (e.minute(s), e.hour(r)) } function u(e) { return "[object Array]" === Object.prototype.toString.call(e) } function h(e, t) { var n, i = Math.min(e.length, t.length), s = Math.abs(e.length - t.length), r = 0; for (n = 0; i > n; n++) ~~e[n] !== ~~t[n] && r++; return r + s } function d(e) { return e ? st[e] || e.toLowerCase().replace(/(.)s$/, "$1") : e } function p(e, t) { return t.abbr = e, z[e] || (z[e] = new i), z[e].set(t), z[e] } function f(e) { if (!e) return N.fn._lang; if (!z[e] && F) try { require("./lang/" + e) } catch (t) { return N.fn._lang } return z[e] } function m(e) { return e.match(/\[.*\]/) ? e.replace(/^\[|\]$/g, "") : e.replace(/\\/g, "") } function g(e) { var t, n, i = e.match(q); for (t = 0, n = i.length; n > t; t++) i[t] = lt[i[t]] ? lt[i[t]] : m(i[t]); return function (s) { var r = ""; for (t = 0; n > t; t++) r += i[t] instanceof Function ? i[t].call(s, e) : i[t]; return r } } function v(e, t) { function n(t) { return e.lang().longDateFormat(t) || t } for (var i = 5; i-- && H.test(t) ;) t = t.replace(H, n); return rt[t] || (rt[t] = g(t)), rt[t](e) } function _(e, t) {
            switch (e) {
                case "DDDD": return V; case "YYYY": return B; case "YYYYY": return Y;
                case "S": case "SS": case "SSS": case "DDD": return W; case "MMM": case "MMMM": case "dd": case "ddd": case "dddd": return G; case "a": case "A": return f(t._l)._meridiemParse; case "X": return Z; case "Z": case "ZZ": return J; case "T": return Q; case "MM": case "DD": case "YY": case "HH": case "hh": case "mm": case "ss": case "M": case "D": case "d": case "H": case "h": case "m": case "s": return U; default: return new RegExp(e.replace("\\", ""))
            }
        } function y(e) { var t = (J.exec(e) || [])[0], n = (t + "").match(tt) || ["-", 0, 0], i = +(60 * n[1]) + ~~n[2]; return "+" === n[0] ? -i : i } function b(e, t, n) { var i, s = n._a; switch (e) { case "M": case "MM": s[1] = null == t ? 0 : ~~t - 1; break; case "MMM": case "MMMM": i = f(n._l).monthsParse(t), null != i ? s[1] = i : n._isValid = !1; break; case "D": case "DD": case "DDD": case "DDDD": null != t && (s[2] = ~~t); break; case "YY": s[0] = ~~t + (~~t > 68 ? 1900 : 2e3); break; case "YYYY": case "YYYYY": s[0] = ~~t; break; case "a": case "A": n._isPm = f(n._l).isPM(t); break; case "H": case "HH": case "h": case "hh": s[3] = ~~t; break; case "m": case "mm": s[4] = ~~t; break; case "s": case "ss": s[5] = ~~t; break; case "S": case "SS": case "SSS": s[6] = ~~(1e3 * ("0." + t)); break; case "X": n._d = new Date(1e3 * parseFloat(t)); break; case "Z": case "ZZ": n._useUTC = !0, n._tzm = y(t) } null == t && (n._isValid = !1) } function w(e) { var t, n, i = []; if (!e._d) { for (t = 0; 7 > t; t++) e._a[t] = i[t] = null == e._a[t] ? 2 === t ? 1 : 0 : e._a[t]; i[3] += ~~((e._tzm || 0) / 60), i[4] += ~~((e._tzm || 0) % 60), n = new Date(0), e._useUTC ? (n.setUTCFullYear(i[0], i[1], i[2]), n.setUTCHours(i[3], i[4], i[5], i[6])) : (n.setFullYear(i[0], i[1], i[2]), n.setHours(i[3], i[4], i[5], i[6])), e._d = n } } function k(e) { var t, n, i = e._f.match(q), s = e._i; for (e._a = [], t = 0; t < i.length; t++) n = (_(i[t], e).exec(s) || [])[0], n && (s = s.slice(s.indexOf(n) + n.length)), lt[i[t]] && b(i[t], n, e); s && (e._il = s), e._isPm && e._a[3] < 12 && (e._a[3] += 12), e._isPm === !1 && 12 === e._a[3] && (e._a[3] = 0), w(e) } function x(e) { var t, n, i, r, a, l = 99; for (r = 0; r < e._f.length; r++) t = o({}, e), t._f = e._f[r], k(t), n = new s(t), a = h(t._a, n.toArray()), n._il && (a += n._il.length), l > a && (l = a, i = n); o(e, i) } function S(e) { var t, n = e._i, i = X.exec(n); if (i) { for (e._f = "YYYY-MM-DD" + (i[2] || " "), t = 0; 4 > t; t++) if (et[t][1].exec(n)) { e._f += et[t][0]; break } J.exec(n) && (e._f += " Z"), k(e) } else e._d = new Date(n) } function C(t) { var n = t._i, i = $.exec(n); n === e ? t._d = new Date : i ? t._d = new Date(+i[1]) : "string" == typeof n ? S(t) : u(n) ? (t._a = n.slice(0), w(t)) : t._d = new Date(n instanceof Date ? +n : n) } function T(e, t, n, i, s) { return s.relativeTime(t || 1, !!n, e, i) } function E(e, t, n) { var i = L(Math.abs(e) / 1e3), s = L(i / 60), r = L(s / 60), o = L(r / 24), a = L(o / 365), l = 45 > i && ["s", i] || 1 === s && ["m"] || 45 > s && ["mm", s] || 1 === r && ["h"] || 22 > r && ["hh", r] || 1 === o && ["d"] || 25 >= o && ["dd", o] || 45 >= o && ["M"] || 345 > o && ["MM", L(o / 30)] || 1 === a && ["y"] || ["yy", a]; return l[2] = t, l[3] = e > 0, l[4] = n, T.apply({}, l) } function M(e, t, n) { var i, s = n - t, r = n - e.day(); return r > s && (r -= 7), s - 7 > r && (r += 7), i = N(e).add("d", r), { week: Math.ceil(i.dayOfYear() / 7), year: i.year() } } function D(e) { var t = e._i, n = e._f; return null === t || "" === t ? null : ("string" == typeof t && (e._i = t = f().preparse(t)), N.isMoment(t) ? (e = o({}, t), e._d = new Date(+t._d)) : n ? u(n) ? x(e) : k(e) : C(e), new s(e)) } function I(e, t) { N.fn[e] = N.fn[e + "s"] = function (e) { var n = this._isUTC ? "UTC" : ""; return null != e ? (this._d["set" + n + t](e), N.updateOffset(this), this) : this._d["get" + n + t]() } } function O(e) { N.duration.fn[e] = function () { return this._data[e] } } function P(e, t) { N.duration.fn["as" + e] = function () { return +this / t } } for (var N, A, j = "2.1.0", L = Math.round, z = {}, F = "undefined" != typeof module && module.exports, $ = /^\/?Date\((\-?\d+)/i, R = /(\-)?(\d*)?\.?(\d+)\:(\d+)\:(\d+)\.?(\d{3})?/, q = /(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|SS?S?|X|zz?|ZZ?|.)/g, H = /(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g, U = /\d\d?/, W = /\d{1,3}/, V = /\d{3}/, B = /\d{1,4}/, Y = /[+\-]?\d{1,6}/, G = /[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i, J = /Z|[\+\-]\d\d:?\d\d/i, Q = /T/i, Z = /[\+\-]?\d+(\.\d{1,3})?/, X = /^\s*\d{4}-\d\d-\d\d((T| )(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/, K = "YYYY-MM-DDTHH:mm:ssZ", et = [["HH:mm:ss.S", /(T| )\d\d:\d\d:\d\d\.\d{1,3}/], ["HH:mm:ss", /(T| )\d\d:\d\d:\d\d/], ["HH:mm", /(T| )\d\d:\d\d/], ["HH", /(T| )\d\d/]], tt = /([\+\-]|\d\d)/gi, nt = "Date|Hours|Minutes|Seconds|Milliseconds".split("|"), it = { Milliseconds: 1, Seconds: 1e3, Minutes: 6e4, Hours: 36e5, Days: 864e5, Months: 2592e6, Years: 31536e6 }, st = { ms: "millisecond", s: "second", m: "minute", h: "hour", d: "day", w: "week", M: "month", y: "year" }, rt = {}, ot = "DDD w W M D d".split(" "), at = "M D H h m s w W".split(" "), lt = { M: function () { return this.month() + 1 }, MMM: function (e) { return this.lang().monthsShort(this, e) }, MMMM: function (e) { return this.lang().months(this, e) }, D: function () { return this.date() }, DDD: function () { return this.dayOfYear() }, d: function () { return this.day() }, dd: function (e) { return this.lang().weekdaysMin(this, e) }, ddd: function (e) { return this.lang().weekdaysShort(this, e) }, dddd: function (e) { return this.lang().weekdays(this, e) }, w: function () { return this.week() }, W: function () { return this.isoWeek() }, YY: function () { return l(this.year() % 100, 2) }, YYYY: function () { return l(this.year(), 4) }, YYYYY: function () { return l(this.year(), 5) }, gg: function () { return l(this.weekYear() % 100, 2) }, gggg: function () { return this.weekYear() }, ggggg: function () { return l(this.weekYear(), 5) }, GG: function () { return l(this.isoWeekYear() % 100, 2) }, GGGG: function () { return this.isoWeekYear() }, GGGGG: function () { return l(this.isoWeekYear(), 5) }, e: function () { return this.weekday() }, E: function () { return this.isoWeekday() }, a: function () { return this.lang().meridiem(this.hours(), this.minutes(), !0) }, A: function () { return this.lang().meridiem(this.hours(), this.minutes(), !1) }, H: function () { return this.hours() }, h: function () { return this.hours() % 12 || 12 }, m: function () { return this.minutes() }, s: function () { return this.seconds() }, S: function () { return ~~(this.milliseconds() / 100) }, SS: function () { return l(~~(this.milliseconds() / 10), 2) }, SSS: function () { return l(this.milliseconds(), 3) }, Z: function () { var e = -this.zone(), t = "+"; return 0 > e && (e = -e, t = "-"), t + l(~~(e / 60), 2) + ":" + l(~~e % 60, 2) }, ZZ: function () { var e = -this.zone(), t = "+"; return 0 > e && (e = -e, t = "-"), t + l(~~(10 * e / 6), 4) }, z: function () { return this.zoneAbbr() }, zz: function () { return this.zoneName() }, X: function () { return this.unix() } }; ot.length;) A = ot.pop(), lt[A + "o"] = n(lt[A], A); for (; at.length;) A = at.pop(), lt[A + A] = t(lt[A], 2); for (lt.DDDD = t(lt.DDD, 3), i.prototype = { set: function (e) { var t, n; for (n in e) t = e[n], "function" == typeof t ? this[n] = t : this["_" + n] = t }, _months: "January_February_March_April_May_June_July_August_September_October_November_December".split("_"), months: function (e) { return this._months[e.month()] }, _monthsShort: "Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"), monthsShort: function (e) { return this._monthsShort[e.month()] }, monthsParse: function (e) { var t, n, i; for (this._monthsParse || (this._monthsParse = []), t = 0; 12 > t; t++) if (this._monthsParse[t] || (n = N([2e3, t]), i = "^" + this.months(n, "") + "|^" + this.monthsShort(n, ""), this._monthsParse[t] = new RegExp(i.replace(".", ""), "i")), this._monthsParse[t].test(e)) return t }, _weekdays: "Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"), weekdays: function (e) { return this._weekdays[e.day()] }, _weekdaysShort: "Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"), weekdaysShort: function (e) { return this._weekdaysShort[e.day()] }, _weekdaysMin: "Su_Mo_Tu_We_Th_Fr_Sa".split("_"), weekdaysMin: function (e) { return this._weekdaysMin[e.day()] }, weekdaysParse: function (e) { var t, n, i; for (this._weekdaysParse || (this._weekdaysParse = []), t = 0; 7 > t; t++) if (this._weekdaysParse[t] || (n = N([2e3, 1]).day(t), i = "^" + this.weekdays(n, "") + "|^" + this.weekdaysShort(n, "") + "|^" + this.weekdaysMin(n, ""), this._weekdaysParse[t] = new RegExp(i.replace(".", ""), "i")), this._weekdaysParse[t].test(e)) return t }, _longDateFormat: { LT: "h:mm A", L: "MM/DD/YYYY", LL: "MMMM D YYYY", LLL: "MMMM D YYYY LT", LLLL: "dddd, MMMM D YYYY LT" }, longDateFormat: function (e) { var t = this._longDateFormat[e]; return !t && this._longDateFormat[e.toUpperCase()] && (t = this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g, function (e) { return e.slice(1) }), this._longDateFormat[e] = t), t }, isPM: function (e) { return "p" === (e + "").toLowerCase()[0] }, _meridiemParse: /[ap]\.?m?\.?/i, meridiem: function (e, t, n) { return e > 11 ? n ? "pm" : "PM" : n ? "am" : "AM" }, _calendar: { sameDay: "[Today at] LT", nextDay: "[Tomorrow at] LT", nextWeek: "dddd [at] LT", lastDay: "[Yesterday at] LT", lastWeek: "[Last] dddd [at] LT", sameElse: "L" }, calendar: function (e, t) { var n = this._calendar[e]; return "function" == typeof n ? n.apply(t) : n }, _relativeTime: { future: "in %s", past: "%s ago", s: "a few seconds", m: "a minute", mm: "%d minutes", h: "an hour", hh: "%d hours", d: "a day", dd: "%d days", M: "a month", MM: "%d months", y: "a year", yy: "%d years" }, relativeTime: function (e, t, n, i) { var s = this._relativeTime[n]; return "function" == typeof s ? s(e, t, n, i) : s.replace(/%d/i, e) }, pastFuture: function (e, t) { var n = this._relativeTime[e > 0 ? "future" : "past"]; return "function" == typeof n ? n(t) : n.replace(/%s/i, t) }, ordinal: function (e) { return this._ordinal.replace("%d", e) }, _ordinal: "%d", preparse: function (e) { return e }, postformat: function (e) { return e }, week: function (e) { return M(e, this._week.dow, this._week.doy).week }, _week: { dow: 0, doy: 6 } }, N = function (e, t, n) { return D({ _i: e, _f: t, _l: n, _isUTC: !1 }) }, N.utc = function (e, t, n) { return D({ _useUTC: !0, _isUTC: !0, _l: n, _i: e, _f: t }) }, N.unix = function (e) { return N(1e3 * e) }, N.duration = function (e, t) { var n, i, s = N.isDuration(e), o = "number" == typeof e, a = s ? e._input : o ? {} : e, l = R.exec(e); return o ? t ? a[t] = e : a.milliseconds = e : l && (n = "-" === l[1] ? -1 : 1, a = { y: 0, d: ~~l[2] * n, h: ~~l[3] * n, m: ~~l[4] * n, s: ~~l[5] * n, ms: ~~l[6] * n }), i = new r(a), s && e.hasOwnProperty("_lang") && (i._lang = e._lang), i }, N.version = j, N.defaultFormat = K, N.updateOffset = function () { }, N.lang = function (e, t) { return e ? (t ? p(e, t) : z[e] || f(e), void (N.duration.fn._lang = N.fn._lang = f(e))) : N.fn._lang._abbr }, N.langData = function (e) { return e && e._lang && e._lang._abbr && (e = e._lang._abbr), f(e) }, N.isMoment = function (e) { return e instanceof s }, N.isDuration = function (e) { return e instanceof r }, N.fn = s.prototype = { clone: function () { return N(this) }, valueOf: function () { return +this._d + 6e4 * (this._offset || 0) }, unix: function () { return Math.floor(+this / 1e3) }, toString: function () { return this.format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ") }, toDate: function () { return this._offset ? new Date(+this) : this._d }, toISOString: function () { return v(N(this).utc(), "YYYY-MM-DD[T]HH:mm:ss.SSS[Z]") }, toArray: function () { var e = this; return [e.year(), e.month(), e.date(), e.hours(), e.minutes(), e.seconds(), e.milliseconds()] }, isValid: function () { return null == this._isValid && (this._isValid = this._a ? !h(this._a, (this._isUTC ? N.utc(this._a) : N(this._a)).toArray()) : !isNaN(this._d.getTime())), !!this._isValid }, utc: function () { return this.zone(0) }, local: function () { return this.zone(0), this._isUTC = !1, this }, format: function (e) { var t = v(this, e || N.defaultFormat); return this.lang().postformat(t) }, add: function (e, t) { var n; return n = "string" == typeof e ? N.duration(+t, e) : N.duration(e, t), c(this, n, 1), this }, subtract: function (e, t) { var n; return n = "string" == typeof e ? N.duration(+t, e) : N.duration(e, t), c(this, n, -1), this }, diff: function (e, t, n) { var i, s, r = this._isUTC ? N(e).zone(this._offset || 0) : N(e).local(), o = 6e4 * (this.zone() - r.zone()); return t = d(t), "year" === t || "month" === t ? (i = 432e5 * (this.daysInMonth() + r.daysInMonth()), s = 12 * (this.year() - r.year()) + (this.month() - r.month()), s += (this - N(this).startOf("month") - (r - N(r).startOf("month"))) / i, s -= 6e4 * (this.zone() - N(this).startOf("month").zone() - (r.zone() - N(r).startOf("month").zone())) / i, "year" === t && (s /= 12)) : (i = this - r, s = "second" === t ? i / 1e3 : "minute" === t ? i / 6e4 : "hour" === t ? i / 36e5 : "day" === t ? (i - o) / 864e5 : "week" === t ? (i - o) / 6048e5 : i), n ? s : a(s) }, from: function (e, t) { return N.duration(this.diff(e)).lang(this.lang()._abbr).humanize(!t) }, fromNow: function (e) { return this.from(N(), e) }, calendar: function () { var e = this.diff(N().startOf("day"), "days", !0), t = -6 > e ? "sameElse" : -1 > e ? "lastWeek" : 0 > e ? "lastDay" : 1 > e ? "sameDay" : 2 > e ? "nextDay" : 7 > e ? "nextWeek" : "sameElse"; return this.format(this.lang().calendar(t, this)) }, isLeapYear: function () { var e = this.year(); return e % 4 === 0 && e % 100 !== 0 || e % 400 === 0 }, isDST: function () { return this.zone() < this.clone().month(0).zone() || this.zone() < this.clone().month(5).zone() }, day: function (e) { var t = this._isUTC ? this._d.getUTCDay() : this._d.getDay(); return null != e ? "string" == typeof e && (e = this.lang().weekdaysParse(e), "number" != typeof e) ? this : this.add({ d: e - t }) : t }, month: function (e) { var t, n = this._isUTC ? "UTC" : ""; return null != e ? "string" == typeof e && (e = this.lang().monthsParse(e), "number" != typeof e) ? this : (t = this.date(), this.date(1), this._d["set" + n + "Month"](e), this.date(Math.min(t, this.daysInMonth())), N.updateOffset(this), this) : this._d["get" + n + "Month"]() }, startOf: function (e) { switch (e = d(e)) { case "year": this.month(0); case "month": this.date(1); case "week": case "day": this.hours(0); case "hour": this.minutes(0); case "minute": this.seconds(0); case "second": this.milliseconds(0) } return "week" === e && this.weekday(0), this }, endOf: function (e) { return this.startOf(e).add(e, 1).subtract("ms", 1) }, isAfter: function (e, t) { return t = "undefined" != typeof t ? t : "millisecond", +this.clone().startOf(t) > +N(e).startOf(t) }, isBefore: function (e, t) { return t = "undefined" != typeof t ? t : "millisecond", +this.clone().startOf(t) < +N(e).startOf(t) }, isSame: function (e, t) { return t = "undefined" != typeof t ? t : "millisecond", +this.clone().startOf(t) === +N(e).startOf(t) }, min: function (e) { return e = N.apply(null, arguments), this > e ? this : e }, max: function (e) { return e = N.apply(null, arguments), e > this ? this : e }, zone: function (e) { var t = this._offset || 0; return null == e ? this._isUTC ? t : this._d.getTimezoneOffset() : ("string" == typeof e && (e = y(e)), Math.abs(e) < 16 && (e = 60 * e), this._offset = e, this._isUTC = !0, t !== e && c(this, N.duration(t - e, "m"), 1, !0), this) }, zoneAbbr: function () { return this._isUTC ? "UTC" : "" }, zoneName: function () { return this._isUTC ? "Coordinated Universal Time" : "" }, daysInMonth: function () { return N.utc([this.year(), this.month() + 1, 0]).date() }, dayOfYear: function (e) { var t = L((N(this).startOf("day") - N(this).startOf("year")) / 864e5) + 1; return null == e ? t : this.add("d", e - t) }, weekYear: function (e) { var t = M(this, this.lang()._week.dow, this.lang()._week.doy).year; return null == e ? t : this.add("y", e - t) }, isoWeekYear: function (e) { var t = M(this, 1, 4).year; return null == e ? t : this.add("y", e - t) }, week: function (e) { var t = this.lang().week(this); return null == e ? t : this.add("d", 7 * (e - t)) }, isoWeek: function (e) { var t = M(this, 1, 4).week; return null == e ? t : this.add("d", 7 * (e - t)) }, weekday: function (e) { var t = (this._d.getDay() + 7 - this.lang()._week.dow) % 7; return null == e ? t : this.add("d", e - t) }, isoWeekday: function (e) { return null == e ? this.day() || 7 : this.day(this.day() % 7 ? e : e - 7) }, lang: function (t) { return t === e ? this._lang : (this._lang = f(t), this) } }, A = 0; A < nt.length; A++) I(nt[A].toLowerCase().replace(/s$/, ""), nt[A]); I("year", "FullYear"), N.fn.days = N.fn.day, N.fn.months = N.fn.month, N.fn.weeks = N.fn.week, N.fn.isoWeeks = N.fn.isoWeek, N.fn.toJSON = N.fn.toISOString, N.duration.fn = r.prototype = { _bubble: function () { var e, t, n, i, s = this._milliseconds, r = this._days, o = this._months, l = this._data; l.milliseconds = s % 1e3, e = a(s / 1e3), l.seconds = e % 60, t = a(e / 60), l.minutes = t % 60, n = a(t / 60), l.hours = n % 24, r += a(n / 24), l.days = r % 30, o += a(r / 30), l.months = o % 12, i = a(o / 12), l.years = i }, weeks: function () { return a(this.days() / 7) }, valueOf: function () { return this._milliseconds + 864e5 * this._days + this._months % 12 * 2592e6 + 31536e6 * ~~(this._months / 12) }, humanize: function (e) { var t = +this, n = E(t, !e, this.lang()); return e && (n = this.lang().pastFuture(t, n)), this.lang().postformat(n) }, add: function (e, t) { var n = N.duration(e, t); return this._milliseconds += n._milliseconds, this._days += n._days, this._months += n._months, this._bubble(), this }, subtract: function (e, t) { var n = N.duration(e, t); return this._milliseconds -= n._milliseconds, this._days -= n._days, this._months -= n._months, this._bubble(), this }, get: function (e) { return e = d(e), this[e.toLowerCase() + "s"]() }, as: function (e) { return e = d(e), this["as" + e.charAt(0).toUpperCase() + e.slice(1) + "s"]() }, lang: N.fn.lang }; for (A in it) it.hasOwnProperty(A) && (P(A, it[A]), O(A.toLowerCase())); P("Weeks", 6048e5), N.duration.fn.asMonths = function () { return (+this - 31536e6 * this.years()) / 2592e6 + 12 * this.years() }, N.lang("en", { ordinal: function (e) { var t = e % 10, n = 1 === ~~(e % 100 / 10) ? "th" : 1 === t ? "st" : 2 === t ? "nd" : 3 === t ? "rd" : "th"; return e + n } }), F && (module.exports = N), "undefined" == typeof ender && (this.moment = N), "function" == typeof define && define.amd && define("moment", [], function () { return N })
    }.call(this), define("templates/helpers/timeAgo", ["Handlebars", "moment"], function (e, t) { "use strict"; e.registerHelper("timeAgo", function (e) { return t(e).fromNow() }) }), define("templates/helpers/icon", ["Handlebars"], function (e) { "use strict"; function t(e, t, i) { return e = n(e), t = n(t), i = n(i), '<i class="icon icon_' + e + " " + (i || "") + '">' + (t ? "<span class=screen-reader-text>" + t + "</span>" : "") + "</i>" } var n = e.Utils.escapeExpression; return e.registerHelper("icon", function (n, i, s) { return new e.SafeString(t(n, i, s)) }), t }), define("hbs!templates/comment", ["hbs", "hbs/handlebars", "templates/helpers/t", "templates/helpers/timeAgo", "templates/helpers/icon"], function (e, t) { var n = t.template(function (e, t, n, i, s) { function r(e, t) { var i, s, r = ""; return r += '\n        <img src="', (s = n.thumb) ? i = s.call(e, { hash: {}, data: t }) : (s = e && e.thumb, i = typeof s === C ? s.call(e, { hash: {}, data: t }) : s), r += T(i) + '" class="comment__image__thumb">\n      ' } function o(e, t) { var i, s = ""; return s += "\n        ", i = n["if"].call(e, e && e.monogram, { hash: {}, inverse: E.program(6, l, t), fn: E.program(4, a, t), data: t }), (i || 0 === i) && (s += i), s += "\n      " } function a(e, t) { var i, s, r = ""; return r += '\n          <div class="comment__image__thumb comment__image__monogram" style="background:#', (s = n.color) ? i = s.call(e, { hash: {}, data: t }) : (s = e && e.color, i = typeof s === C ? s.call(e, { hash: {}, data: t }) : s), r += T(i) + '">', (s = n.monogram) ? i = s.call(e, { hash: {}, data: t }) : (s = e && e.monogram, i = typeof s === C ? s.call(e, { hash: {}, data: t }) : s), r += T(i) + "</div>\n        " } function l() { return '\n          <img src="/temp/noface.png" class="comment__image__thumb">\n        ' } function c(e, t) { var i, s, r, o = ""; return o += '\n  <div class="comment__parent">\n    ' + T((s = n.t || e && e.t, r = { hash: {}, data: t }, s ? s.call(e, "In reply to:", r) : M.call(e, "t", "In reply to:", r))) + '\n\n    <figure class="comment__quote">\n      <blockquote class="comment__quote__body">\n        ' + T((i = e && e.parent, i = null == i || i === !1 ? i : i.message, typeof i === C ? i.apply(e) : i)) + '\n      </blockquote>\n\n      <figcaption class="comment__quote__attribution">\n        ' + T((i = e && e.parent, i = null == i || i === !1 ? i : i.name, typeof i === C ? i.apply(e) : i)) + "\n      </figcaption>\n    </figure>\n  </div>\n" } function u(e, t) { var i, s = ""; return s += "\n    <p>\n      ", i = n.each.call(e, e, { hash: {}, inverse: E.noop, fn: E.program(11, h, t), data: t }), (i || 0 === i) && (s += i), s += "\n    </p>\n  " } function h(e, t) { var i, s = ""; return s += "\n        " + T(typeof e === C ? e.apply(e) : e) + "\n        ", i = n.unless.call(e, null == t || t === !1 ? t : t.last, { hash: {}, inverse: E.noop, fn: E.program(12, d, t), data: t }), (i || 0 === i) && (s += i), s += "\n      " } function d() { return "<br>" } function p(e, t) { var i, s, r, o = ""; return o += '\n    <a class="comment__link comment__upvote ', i = n["if"].call(e, e && e.upvoted, { hash: {}, inverse: E.noop, fn: E.program(15, f, t), data: t }), (i || 0 === i) && (o += i), o += '" href="#">\n      ' + T((s = n.icon || e && e.icon, r = { hash: {}, data: t }, s ? s.call(e, "upvote", r) : M.call(e, "icon", "upvote", r))) + "\n      " + T((s = n.t || e && e.t, r = { hash: {}, data: t }, s ? s.call(e, "Upvote", r) : M.call(e, "t", "Upvote", r))) + '\n\n      <span class="comment__upvote__count" ', i = n.unless.call(e, e && e.upvotes, { hash: {}, inverse: E.noop, fn: E.program(17, m, t), data: t }), (i || 0 === i) && (o += i), o += ">\n        (", (s = n.upvotes) ? i = s.call(e, { hash: {}, data: t }) : (s = e && e.upvotes, i = typeof s === C ? s.call(e, { hash: {}, data: t }) : s), o += T(i) + ")\n      </span>\n    </a>\n  " } function f() { return "comment__upvote--upvoted" } function m() { return 'style="display:none"' } function g(e, t) { var i, s, r = ""; return r += '\n    <a class="comment__link comment__edit" href="#">' + T((i = n.t || e && e.t, s = { hash: {}, data: t }, i ? i.call(e, "Edit", s) : M.call(e, "t", "Edit", s))) + '</a>\n    <a class="comment__link comment__delete" href="#">' + T((i = n.t || e && e.t, s = { hash: {}, data: t }, i ? i.call(e, "Delete", s) : M.call(e, "t", "Delete", s))) + "</a>\n  " } function v(e, t) { var i, s, r = ""; return r += '\n    <!-- <a class="comment__link comment__move" href="#">' + T((i = n.t || e && e.t, s = { hash: {}, data: t }, i ? i.call(e, "Move", s) : M.call(e, "t", "Move", s))) + "</a> -->\n  " } function _(e, t) { var i, s = ""; return s += "\n    ", i = n["if"].call(e, e && e.reported, { hash: {}, inverse: E.program(26, b, t), fn: E.program(24, y, t), data: t }), (i || 0 === i) && (s += i), s += "\n  " } function y(e, t) { var i, s, r = ""; return r += '\n      <span class="comment__report comment__report--reported">\n        ' + T((i = n.icon || e && e.icon, s = { hash: {}, data: t }, i ? i.call(e, "flag", s) : M.call(e, "icon", "flag", s))) + "\n        " + T((i = n.t || e && e.t, s = { hash: {}, data: t }, i ? i.call(e, "Reported. Thank you.", s) : M.call(e, "t", "Reported. Thank you.", s))) + "\n      </span>\n    " } function b(e, t) { var i, s, r = ""; return r += '\n      <a class="comment__link comment__report" href="#">\n        ' + T((i = n.icon || e && e.icon, s = { hash: {}, data: t }, i ? i.call(e, "flag", s) : M.call(e, "icon", "flag", s))) + "\n        " + T((i = n.t || e && e.t, s = { hash: {}, data: t }, i ? i.call(e, "Report", s) : M.call(e, "t", "Report", s))) + "\n      </a>\n    " } this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers), s = s || {}; var w, k, x, S = "", C = "function", T = this.escapeExpression, E = this, M = n.helperMissing; return S += '\n\n<header class="comment__header">\n  <div class="media">\n    <div class="comment__image media__image">\n      ', w = n["if"].call(t, t && t.thumb, { hash: {}, inverse: E.program(3, o, s), fn: E.program(1, r, s), data: s }), (w || 0 === w) && (S += w), S += '\n    </div>\n\n    <div class="media__message">\n      <a class="comment__name" href="/profiles/', (k = n.profileId) ? w = k.call(t, { hash: {}, data: s }) : (k = t && t.profileId, w = typeof k === C ? k.call(t, { hash: {}, data: s }) : k), S += T(w) + '" target="_blank">', (k = n.name) ? w = k.call(t, { hash: {}, data: s }) : (k = t && t.name, w = typeof k === C ? k.call(t, { hash: {}, data: s }) : k), S += T(w) + '</a>\n      <div class="comment__date">\n        <strong>' + T((k = n.t || t && t.t, x = { hash: {}, data: s }, k ? k.call(t, "Posted", x) : M.call(t, "t", "Posted", x))) + "</strong>\n        " + T((k = n.timeAgo || t && t.timeAgo, x = { hash: {}, data: s }, k ? k.call(t, t && t.date, x) : M.call(t, "timeAgo", t && t.date, x))) + "\n      </div>\n    </div>\n  </div>\n</header>\n\n", w = n["if"].call(t, t && t.parent, { hash: {}, inverse: E.noop, fn: E.program(8, c, s), data: s }), (w || 0 === w) && (S += w), S += '\n\n<div class="comment__body hyphens">\n  ', w = n.each.call(t, t && t.paragraphs, { hash: {}, inverse: E.noop, fn: E.program(10, u, s), data: s }), (w || 0 === w) && (S += w), S += '\n</div>\n\n\n<div class="comment__editor">\n  <textarea class="comment__editor__input"></textarea>\n\n  <div class="comment__editor__message"></div>\n\n  <div class="comment__editor__controls">\n    <span class="comment__editor__count">2000</span>\n    ' + T((k = n.t || t && t.t, x = { hash: {}, data: s }, k ? k.call(t, "characters left", x) : M.call(t, "t", "characters left", x))) + '\n\n    <button class="button comment__editor__button comment__editor__submit">' + T((k = n.t || t && t.t, x = { hash: {}, data: s }, k ? k.call(t, "Submit", x) : M.call(t, "t", "Submit", x))) + '</button>\n    <button class="button comment__editor__button comment__editor__cancel">' + T((k = n.t || t && t.t, x = { hash: {}, data: s }, k ? k.call(t, "Cancel", x) : M.call(t, "t", "Cancel", x))) + '</button>\n  </div>\n</div>\n\n\n<footer class="comment__footer">\n  <a class="comment__link comment__reply" href="#">\n    ' + T((k = n.icon || t && t.icon, x = { hash: {}, data: s }, k ? k.call(t, "reply", x) : M.call(t, "icon", "reply", x))) + "\n    " + T((k = n.t || t && t.t, x = { hash: {}, data: s }, k ? k.call(t, "Reply", x) : M.call(t, "t", "Reply", x))) + "\n  </a>\n\n  \n  ", w = n.unless.call(t, t && t.isOwn, { hash: {}, inverse: E.noop, fn: E.program(14, p, s), data: s }), (w || 0 === w) && (S += w), S += "\n\n  \n  ", w = n["if"].call(t, t && t.isEditable, { hash: {}, inverse: E.noop, fn: E.program(19, g, s), data: s }), (w || 0 === w) && (S += w), S += "\n\n  \n  ", w = n["if"].call(t, t && t.isModable, { hash: {}, inverse: E.noop, fn: E.program(21, v, s), data: s }), (w || 0 === w) && (S += w), S += "\n\n  \n  ", w = n.unless.call(t, t && t.isOwn, { hash: {}, inverse: E.noop, fn: E.program(23, _, s), data: s }), (w || 0 === w) && (S += w), S += '\n</footer>\n\n\n<div class="comment__replies"></div>\n\n\n<article class="comment__response">\n  ' + T((k = n.t || t && t.t, x = { hash: {}, data: s }, k ? k.call(t, "You are replying to:", x) : M.call(t, "t", "You are replying to:", x))) + '\n\n  <figure class="comment__quote">\n    <blockquote class="comment__quote__body">\n      ', (k = n.message) ? w = k.call(t, { hash: {}, data: s }) : (k = t && t.message, w = typeof k === C ? k.call(t, { hash: {}, data: s }) : k), S += T(w) + '\n    </blockquote>\n\n    <figcaption class="comment__quote__attribution">\n      ', (k = n.name) ? w = k.call(t, { hash: {}, data: s }) : (k = t && t.name, w = typeof k === C ? k.call(t, { hash: {}, data: s }) : k), S += T(w) + '\n    </figcaption>\n  </figure>\n\n  <textarea class="comment__response__input"></textarea>\n\n  <div class="comment__response__message"></div>\n\n  <div class="comment__response__buttons">\n    <span class="comment__response__limit">\n      <span class="comment__response__limit__remain">2000</span>\n      ' + T((k = n.t || t && t.t, x = { hash: {}, data: s }, k ? k.call(t, "characters left", x) : M.call(t, "t", "characters left", x))) + '\n    </span>\n\n    <button class="button comment__response__button comment__response__submit">' + T((k = n.t || t && t.t, x = { hash: {}, data: s }, k ? k.call(t, "Submit", x) : M.call(t, "t", "Submit", x))) + '</button>\n    <button class="button comment__response__button comment__response__cancel">' + T((k = n.t || t && t.t, x = { hash: {}, data: s }, k ? k.call(t, "Cancel", x) : M.call(t, "t", "Cancel", x))) + "</button>\n  </div>\n</article>\n" }); return n }), define("lib/thread", ["exports", "lodash", "jquery", "lib/currentUser"], function (e, t, n, i) { "use strict"; function s(e, t, n) { return { records: e, metadata: { page: t, pageCount: n } } } function r(e, n) { var i = new Date(1e3 * (0 + e.date)); if (!e.deleted) { var s = o(e.children, t.extend({ parentId: e.comment_id }, n)), r = +n.currentUserId === +e.user_id; return { id: e.comment_id, parentId: n.parentId, threadId: n.threadId, isOwn: r, isModable: n.isCommentModerator, isEditable: n.isCommentModerator || r, name: e.name, profileId: e.profile_id, thumb: e.profile_pic, date: i, message: e.comment, replies: s, upvoted: !!e.actor_score_id, scoreId: e.actor_score_id || null, reported: !!e.actor_flag_id, flagId: e.actor_flag_id || null, upvotes: e.score, removed: e.deleted } } } function o(e, n) { function i(e) { return r(e, n) } return t.isPlainObject(e) ? t.filter(t.map(t.values(e), i)) : [] } var a = { page: 1, perPage: 10, sort: "rated" }, l = {}; e.get = function (e, r) { var l = new n.Deferred; r = t.extend({}, a, r); var c = "/conversation_forums/" + e + ".json", u = { page: r.page, per_page: r.perPage, sort: r.sort }, h = new n.Deferred; return i.getDetails().then(function (e) { h.resolve({ currentUserId: e.id, isCommentModerator: e.isCommentModerator }) }, function () { h.resolve({ currentUserId: !1, isCommentModerator: !1 }) }), n.when(n.get(c, u), h).then(function (e, n) { var i, r = e[0], a = n; if (r.attributes && (r = r.attributes), !r || !r.discussion_thread) return void l.resolve(s([], 1, 1)); i = t.extend({ threadId: r.id }, a); var c = r.discussion_thread.thread[0], h = o(c, i); l.resolve(s(h, u.page, t.size(c) < u.per_page ? u.page : u.page + 1)) }, function () { l.reject() }), l.promise() }, e.saveComment = function (e, i) { var s = n.Deferred(), r = s.promise(); i = t.extend({}, l, i); var o = "/comments.json", a = { comment: e.message, timestamp: Math.floor(new Date / 1e3).toString() }, c = {}; if (e.id) o = "/comments/" + e.id + ".json", c._method = "PUT"; else if (e.parentId) a.commentable_type = "comment", a.commentable_id = e.parentId; else { if (!e.threadId) return s.reject(new Error("parentId or threadId required.")), r; a.commentable_type = "conversation_forum", a.commentable_id = e.threadId } return c.comment = a, n.post(o, c).then(function (e) { s.resolve(e ? { id: e.id } : null) }, function () { s.reject() }), r }, e.destroyComment = function (e, i) { var s = n.Deferred(), r = s.promise(), o = "/comments/" + e + ".json", a = { _method: "DELETE" }; return i && (i.send = i.send ? "1" : ""), t.extend(a, i || {}), n.post(o, a).then(function () { s.resolve() }, function () { s.reject() }), r }, e.saveFlag = function (e) { var t = n.Deferred(), i = t.promise(), s = "/comment_flags.json", r = { comment_flag: { comment_id: e.commentId } }; return e.id && (s = "/comment_flags/" + e.id + ".json", r._method = "PUT"), n.post(s, r).then(function (e) { t.resolve({ id: e.id }) }, function () { t.reject() }), i }, e.destroyFlag = function (e) { var t = n.Deferred(), i = t.promise(), s = "/comment_flags/" + e + ".json", r = { _method: "DELETE" }; return n.post(s, r).then(function () { t.resolve() }, function () { t.reject() }), i }, e.saveScore = function (e) { var t = n.Deferred(), i = t.promise(), s = "/comment_scores.json", r = { comment_score: { comment_id: e.commentId } }; return e.id && (s = "/comment_scores/" + e.id + ".json", r._method = "PUT"), n.post(s, r).then(function (e) { t.resolve({ id: e.id }) }, function () { t.reject() }), i }, e.destroyScore = function (e) { var t = n.Deferred(), i = t.promise(), s = "/comment_scores/" + e + ".json", r = { _method: "DELETE" }; return n.post(s, r).then(function () { t.resolve() }, function () { t.reject() }), i } }), define("utils/monogram", ["jquery"], function (e) { "use strict"; return function (t) { return t ? (t = t.split(",")[0], t = t.replace(/\s[a-z]\w+\s/g, " "), t = t.replace(/\s\w+\.$/, ""), t = t.replace(/\s[A-Z]+$/, ""), t = t.replace(/[^\s\w]+([\w])/g, "$1"), t = e.trim(t).toUpperCase().split(/\s+/), t[0][0] + (t.length > 1 ? t[t.length - 1][0] : "")) : "" } }), define("collections/Comments", ["Backbone", "models/Comment"], function (e, t) { "use strict"; var n = e.Collection.extend({ constructor: function () { this.model || (this.model = require("models/Comment")), e.Collection.apply(this, arguments) }, model: t, parent: null }); return n }), define("models/Comment", ["jquery", "lodash", "Backbone", "lib/pubSub", "lib/thread", "lib/currentUser", "utils/monogram", "collections/Comments"], function (e, t, n, i, s, r, o, a) { "use strict"; function l() { a || (a = require("collections/Comments")) } var c = n.Model.extend({ defaults: { isOwn: !0, isEditable: !0, upvotes: 0, upvoted: !1 }, maxMessageLength: 2e3, constructor: function () { l(), this.replies = new a, this.replies.parent = this, n.Model.apply(this, arguments) }, initialize: function (e) { this.replies.reset(e.replies) }, monogram: function () { return o(this.get("name")) }, parse: function (e) { return this.replies.reset(e.replies), t.omit(e, "replies") }, remove: function (e) { var t = this, n = s.destroyComment(t.get("id"), e); return t.trigger("request", t, n), n.done(function () { t.set("removed", !0) }), n }, report: function () { var e = this, t = s.saveFlag({ commentId: e.get("id") }); return t.done(function (t) { e.set({ reported: !0, flagId: t.id }), i("comment.report").publish(e.toJSON()) }), t }, unreport: function () { var e = this, t = s.destroyFlag(e.get("flagId")); return t.done(function () { e.set("reported", !1) }), t }, sync: function (t, n) { var o; return o = "delete" === t ? s.destroyComment(n.get("id")) : "create" === t ? e.when(s.saveComment(n.toJSON()).done(function (e) { n.set(e) }), r.getDetails().done(function (e) { n.set({ name: e.firstName + " " + e.lastName, thumb: e.avatarUrl }) })).done(function () { n.get("profileId") || n.set("profileId", "me"), i("comment.create").publish(n.toJSON()) }) : s.saveComment(n.toJSON()), n.trigger("request", n, o), o }, toggleUpvote: function () { var e, t = this, n = t.get("upvotes"), r = t.get("upvoted"); return r ? (n -= 1, e = s.destroyScore(t.get("scoreId"))) : (n += 1, e = s.saveScore({ commentId: t.get("id") })), e.done(function (e) { t.set({ upvoted: !r, upvotes: n, scoreId: e ? e.id || null : null }), i("comment.upvote").publish(t.toJSON()) }), e }, validate: function (e) { return e.message ? e.message.length > this.maxMessageLength ? "Comments must container fewer than " + this.maxMessageLength + " characters." : e.id || e.threadId || e.parentId ? void 0 : "Your comment is not associated with any thread." : "Please enter a comment." } }); return c }), define("hbs!templates/commentReportModal", ["hbs", "hbs/handlebars", "templates/helpers/t"], function (e, t) {
        var n = t.template(function (e, t, n) {
            this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var i, s, r = "", o = n.helperMissing, a = this.escapeExpression; return r += '\n\n<div>\n  \n  <div class="modal__head">\n    <a class="modal__close modal__head__close" href="#">\n      <i class="g-button-modal-close">' + a((i = n.t || t && t.t, s = { hash: {} }, i ? i.call(t, "Close", s) : o.call(t, "t", "Close", s))) + '</i>\n    </a>\n    <h3 class="modal__head__title">' + a((i = n.t || t && t.t, s = { hash: {} }, i ? i.call(t, "Report this comment?", s) : o.call(t, "t", "Report this comment?", s))) + "</h3>\n  </div>\n\n  <p>" + a((i = n.t || t && t.t, s = { hash: {} }, i ? i.call(t, "Reporting a comment or conversation sends a notification to our moderation team. They will review the message and take the appropriate action.", s) : o.call(t, "t", "Reporting a comment or conversation sends a notification to our moderation team. They will review the message and take the appropriate action.", s))) + "</p>\n  <p>" + a((i = n.t || t && t.t, s = { hash: {} }, i ? i.call(t, "This action cannot be undone.", s) : o.call(t, "t", "This action cannot be undone.", s))) + '</p>\n\n  <p>\n    <label>\n      <input class="comment-report__reason" type="radio" name="reason" data-reason="spam">\n      ' + a((i = n.t || t && t.t, s = { hash: {} }, i ? i.call(t, "Flag as spam", s) : o.call(t, "t", "Flag as spam", s))) + '\n    </label>\n  </p>\n\n  <p>\n    <label>\n      <input class="comment-report__reason" type="radio" name="reason" data-reason="abuse">\n      ' + a((i = n.t || t && t.t, s = { hash: {} }, i ? i.call(t, "Flag as inappropriate", s) : o.call(t, "t", "Flag as inappropriate", s))) + '\n    </label>\n  </p>\n\n  <p class="comment-report__message" style="display:none">\n    <strong>Please select a reason for reporting this comment.</strong>\n  </p>\n\n  <button class="comment-report__submit button">Flag</button>\n  <button class="comment-report__cancel button">Cancel</button>\n</div>\n'
        }); return n
    }), define("views/CommentReportView", ["lodash", "Backbone", "hbs!templates/commentReportModal", "widgets/modal"], function (e, t, n) { "use strict"; var i = t.View.extend({ tagName: "div", className: "comment-report", events: { "click .comment-report__submit": "submit", "click .comment-report__cancel": "cancel" }, render: function () { return this.$el.html(n()).modal({ close: e.bind(this.remove, this) }), this }, cancel: function () { this.$el.modal("close") }, submit: function () { var e = this.$el.find("input.comment-report__reason:checked").data("reason"); return e ? (this.disable(!0), this.model.report(e), void this.$el.modal("close")) : void this.$el.find("p.comment-report__message").slideDown("fast") }, disable: function (e) { this.$el[e ? "addClass" : "removeClass"]("comment-report--disabled"), this.$el.find("button, input, textarea").prop("disabled", e) } }); return i }), define("hbs!templates/commentRemoveOwnModal", ["hbs", "hbs/handlebars", "templates/helpers/t"], function (e, t) { var n = t.template(function (e, t, n) { this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var i, s, r = "", o = n.helperMissing, a = this.escapeExpression; return r += '\n\n<div>\n  \n  <div class="modal__head">\n    <a class="modal__close modal__head__close" href="#">\n      <i class="g-button-modal-close">' + a((i = n.t || t && t.t, s = { hash: {} }, i ? i.call(t, "Close", s) : o.call(t, "t", "Close", s))) + '</i>\n    </a>\n    <h3 class="modal__head__title">' + a((i = n.t || t && t.t, s = { hash: {} }, i ? i.call(t, "Remove your comment?", s) : o.call(t, "t", "Remove your comment?", s))) + "</h3>\n  </div>\n\n  <p>" + a((i = n.t || t && t.t, s = { hash: {} }, i ? i.call(t, "Are you sure you want to delete your comment?", s) : o.call(t, "t", "Are you sure you want to delete your comment?", s))) + "</p>\n  <p>" + a((i = n.t || t && t.t, s = { hash: {} }, i ? i.call(t, "This action cannot be undone.", s) : o.call(t, "t", "This action cannot be undone.", s))) + '</p>\n\n  <button class="comment-remove__submit button">Yes, delete it</button>\n  <button class="comment-remove__cancel button">Cancel</button>\n</div>\n' }); return n }), define("hbs!templates/commentRemoveModModal", ["hbs", "hbs/handlebars", "templates/helpers/t"], function (e, t) { var n = t.template(function (e, t, n, i, s) { function r(e) { var t, i, s = ""; return s += '\n        <option value="', (i = n.value) ? t = i.call(e, { hash: {} }) : (i = e && e.value, t = typeof i === u ? i.call(e, { hash: {} }) : i), s += h(t) + '">', (i = n.label) ? t = i.call(e, { hash: {} }) : (i = e && e.label, t = typeof i === u ? i.call(e, { hash: {} }) : i), s += h(t) + "</option>\n      " } this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var o, a, l, c = "", u = "function", h = this.escapeExpression, d = n.helperMissing, p = this; return c += '\n\n<div>\n  \n  <div class="modal__head">\n    <a class="modal__close modal__head__close" href="#">\n      <i class="g-button-modal-close">' + h((a = n.t || t && t.t, l = { hash: {} }, a ? a.call(t, "Close", l) : d.call(t, "t", "Close", l))) + '</i>\n    </a>\n    <h3 class="modal__head__title">' + h((a = n.t || t && t.t, l = { hash: {} }, a ? a.call(t, "Remove this comment?", l) : d.call(t, "t", "Remove this comment?", l))) + '</h3>\n  </div>\n\n  <div class="form-group">\n    <select class="form-control dropdown comment-remove__reason">\n      <option value="">Reason for deletion</option>\n      ', o = n.each.call(t, t && t.reasons, { hash: {}, inverse: p.noop, fn: p.program(1, r, s) }), (o || 0 === o) && (c += o), c += '\n    </select>\n  </div>\n\n  <div class="form-group">\n    <label class="checkbox">\n      <input class="checkbox__input comment-remove__send" type="checkbox">\n      <span class="form-label">' + h((a = n.t || t && t.t, l = { hash: {} }, a ? a.call(t, "Send an email notifying the commenter.", l) : d.call(t, "t", "Send an email notifying the commenter.", l))) + '</span>\n    </label>\n  </div>\n\n  <div class="form-group">\n    <input class="form-control comment-remove__subject" type="text" value="Your TED.com comment">\n  </div>\n\n  <div class="form-group">\n    <textarea class="form-control comment-remove__email" rows="5"></textarea>\n  </div>\n\n  <button class="comment-remove__submit button">Delete it</button>\n  <button class="comment-remove__cancel button">Cancel</button>\n</div>\n' }); return n }), define("hbs!templates/emails/commentRemoveNone", ["hbs", "hbs/handlebars"], function (e, t) { var n = t.template(function (e, t, n) { this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var i, s, r = "", o = "function", a = this.escapeExpression; return r += "Dear ", (s = n.name) ? i = s.call(t, { hash: {} }) : (s = t && t.name, i = typeof s === o ? s.call(t, { hash: {} }) : s), r += a(i) + ",\n\nThank you for your post, but I'm afraid the right folks won't see it in these comments. Would you mind sending this in via our contact form?\n\n/contact\n\nThank you!\n\nThe TED Conversations Team\n\nFull text of your comment:\n\n", (s = n.comment) ? i = s.call(t, { hash: {} }) : (s = t && t.comment, i = typeof s === o ? s.call(t, { hash: {} }) : s), r += a(i) + "\n" }); return n }), define("hbs!templates/emails/commentRemoveCollateral", ["hbs", "hbs/handlebars"], function (e, t) { var n = t.template(function (e, t, n) { this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var i, s, r = "", o = "function", a = this.escapeExpression; return r += "Dear ", (s = n.name) ? i = s.call(t, { hash: {} }) : (s = t && t.name, i = typeof s === o ? s.call(t, { hash: {} }) : s), r += a(i) + ",\n\nWe're sorry, but your comment (included below) has been removed, as a comment it was in response to was deleted. Please feel free to start a new discussion with your comment (included below).\n\n", (s = n.url) ? i = s.call(t, { hash: {} }) : (s = t && t.url, i = typeof s === o ? s.call(t, { hash: {} }) : s), r += a(i) + "\n\nSincerely,\nThe TED Conversations Team\n\nFull text of your comment:\n\n", (s = n.comment) ? i = s.call(t, { hash: {} }) : (s = t && t.comment, i = typeof s === o ? s.call(t, { hash: {} }) : s), r += a(i) + "\n" }); return n }), define("hbs!templates/emails/commentRemoveInappropriate", ["hbs", "hbs/handlebars"], function (e, t) { var n = t.template(function (e, t, n) { this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var i, s, r = "", o = "function", a = this.escapeExpression; return r += "Dear ", (s = n.name) ? i = s.call(t, { hash: {} }) : (s = t && t.name, i = typeof s === o ? s.call(t, { hash: {} }) : s), r += a(i) + ",\n\nWe're sorry. Your comment has been removed according to the TED.com Terms of Use:\n\n/termsofuse\n\nWant to rephrase your comment?\n\nRejoin the conversation:\n\n", (s = n.url) ? i = s.call(t, { hash: {} }) : (s = t && t.url, i = typeof s === o ? s.call(t, { hash: {} }) : s), r += a(i) + "\n\nSincerely,\nThe TED Conversations Team\n\nFull text of your comment:\n\n", (s = n.comment) ? i = s.call(t, { hash: {} }) : (s = t && t.comment, i = typeof s === o ? s.call(t, { hash: {} }) : s), r += a(i) + "\n" }); return n }), define("hbs!templates/emails/commentRemoveGeneral", ["hbs", "hbs/handlebars"], function (e, t) { var n = t.template(function (e, t, n) { this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var i, s, r = "", o = "function", a = this.escapeExpression; return r += "Dear ", (s = n.name) ? i = s.call(t, { hash: {} }) : (s = t && t.name, i = typeof s === o ? s.call(t, { hash: {} }) : s), r += a(i) + ",\n\nTED comment threads are a welcoming place for differing opinions, but we ask that you write all comments in a way that is thoughtful and constructive. The goal of our message boards is to host productive conversation and debate. Comments that are insulting or belittling do not make for constructive conversation -- they tend to stifle debate, not promote it.\n\nWith this in mind, we'd ask you to re-write your comment as though the other party were sitting across from you at a dinner table. How could you engage them in constructive and respectful debate?\n\nThe full text of the comment is below; please let us know if you have any questions. For more information on our approach to comments on TED.com, check out our community How-To Guide:\n\n/pages/conversations_howto\n\nThank you!\n\nThe TED Conversations Team\n\nFull text of your comment:\n\n", (s = n.comment) ? i = s.call(t, { hash: {} }) : (s = t && t.comment, i = typeof s === o ? s.call(t, { hash: {} }) : s), r += a(i) + "\n" }); return n }), define("hbs!templates/emails/commentRemoveOffTopic", ["hbs", "hbs/handlebars"], function (e, t) { var n = t.template(function (e, t, n) { this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var i, s, r = "", o = "function", a = this.escapeExpression; return r += "Dear ", (s = n.name) ? i = s.call(t, { hash: {} }) : (s = t && t.name, i = typeof s === o ? s.call(t, { hash: {} }) : s), r += a(i) + ",\n\nWe're sorry, but we need you to stay on topic as you chime in on conversations, or consider starting a new topic of your own. The full text of your comment is included below, please let us know if you have any questions.\n\nWant to rephrase your comment? Rejoin the conversation:\n\n", (s = n.url) ? i = s.call(t, { hash: {} }) : (s = t && t.url, i = typeof s === o ? s.call(t, { hash: {} }) : s), r += a(i) + "\n\nStart a new Conversation:\n\n/conversations\n\nSincerely,\nThe TED Conversations Team\n\nFull text of your comment:\n\n", (s = n.comment) ? i = s.call(t, { hash: {} }) : (s = t && t.comment, i = typeof s === o ? s.call(t, { hash: {} }) : s), r += a(i) + "\n" }); return n }), define("hbs!templates/emails/commentRemovePoorlyWritten", ["hbs", "hbs/handlebars"], function (e, t) { var n = t.template(function (e, t, n) { this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var i, s, r = "", o = "function", a = this.escapeExpression; return r += "Dear ", (s = n.name) ? i = s.call(t, { hash: {} }) : (s = t && t.name, i = typeof s === o ? s.call(t, { hash: {} }) : s), r += a(i) + ",\n\nWe're sorry. We have removed your comment (included below) from TED.com, because the writing was difficult to understand. Want to clarify and re-post your comment?\n\nRejoin the conversation:\n\n", (s = n.url) ? i = s.call(t, { hash: {} }) : (s = t && t.url, i = typeof s === o ? s.call(t, { hash: {} }) : s), r += a(i) + "\n\nSincerely,\nThe TED Conversations Team\n\nFull text of your comment:\n\n", (s = n.comment) ? i = s.call(t, { hash: {} }) : (s = t && t.comment, i = typeof s === o ? s.call(t, { hash: {} }) : s), r += a(i) + "\n" }); return n }), define("hbs!templates/emails/commentRemoveRude", ["hbs", "hbs/handlebars"], function (e, t) { var n = t.template(function (e, t, n) { this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var i, s, r = "", o = "function", a = this.escapeExpression; return r += "Dear ", (s = n.name) ? i = s.call(t, { hash: {} }) : (s = t && t.name, i = typeof s === o ? s.call(t, { hash: {} }) : s), r += a(i) + ",\n\nTED comment threads are a welcoming place for critical comment and debate, but we ask that you write all comments in a way that is thoughtful and constructive. The goal of our message boards is to host productive conversation and debate. Comments that are insulting or belittling, especially those that are aggressive towards a speaker personally, do not make for constructive conversation -- they tend to stifle debate, not promote it.\n\nWith this in mind, we'd ask you to re-write your comment as though the speaker were sitting across from you at a dinner table. Our speakers do read and respond to comments. How could you engage the speaker in constructive and respectful debate?\n\nThe full text of the comment is below; please let us know if you have any questions. For more information on our approach to comments on TED.com, check out our community How-To Guide:\n\n/pages/conversations_howto\n\nThank you!\n\nThe TED Conversations Team\n\nFull text of your comment:\n\n", (s = n.comment) ? i = s.call(t, { hash: {} }) : (s = t && t.comment, i = typeof s === o ? s.call(t, { hash: {} }) : s), r += a(i) + "\n" }); return n }), define("views/CommentRemoveView", ["lodash", "Backbone", "hbs!templates/commentRemoveOwnModal", "hbs!templates/commentRemoveModModal", "hbs!templates/emails/commentRemoveNone", "hbs!templates/emails/commentRemoveCollateral", "hbs!templates/emails/commentRemoveInappropriate", "hbs!templates/emails/commentRemoveGeneral", "hbs!templates/emails/commentRemoveOffTopic", "hbs!templates/emails/commentRemovePoorlyWritten", "hbs!templates/emails/commentRemoveRude", "widgets/modal"], function (e, t, n, i, s, r, o, a, l, c, u) { "use strict"; var h = t.View.extend({ tagName: "div", className: "comment-remove", events: { "change .comment-remove__reason": "reason", "click .comment-remove__submit": "submit", "click .comment-remove__cancel": "cancel" }, reasons: [{ value: "comment_none", label: "None", email: s }, { value: "comment_collateral", label: "Collateral damage", email: r }, { value: "comment_inappropriate", label: "Inappropriate", email: o }, { value: "comment_general", label: "General", email: a }, { value: "comment_off_topic", label: "Off-topic", email: l }, { value: "comment_poorly_written", label: "Poorly written", email: c }, { value: "comment_rude", label: "Rude critique", email: u }], reason: function () { var t = e.find(this.reasons, { value: this.$reason.val() }), n = { name: this.model.get("name"), comment: this.model.get("message"), url: window.location.href }; this.$email.val(t ? t.email(n) : "") }, render: function () { var t = this.model.get("isOwn"); return this.$el.html(t ? n() : i({ reasons: this.reasons })), this.$el.modal({ close: e.bind(this.remove, this) }), t || (this.$email = this.$el.find("textarea.comment-remove__email"), this.$reason = this.$el.find("select.comment-remove__reason"), this.$subject = this.$el.find("input.comment-remove__subject")), this }, cancel: function () { this.$el.modal("close") }, submit: function () { this.disable(!0), this.model.get("isOwn") ? this.model.remove() : this.model.remove({ reason: this.$reason.val(), email: this.$email.val(), subject: this.$subject.val(), send: this.$el.find("input.comment-remove__send:checked").length > 0 }), this.$el.modal("close") }, disable: function (e) { this.$el[e ? "addClass" : "removeClass"]("comment-remove--disabled"), this.$el.find("button, input, textarea").prop("disabled", e) } }); return h }), define("utils/paragraphs", [], function () { "use strict"; var e = "\n"; return function (t) { var n, i; if (!t) return [[]]; for (n = t.replace(/\r\n/g, e).replace(/\r/g, e).split(e + e), i = n.length; i--;) n[i] = n[i].split(e); return n } }), define("views/CommentView", ["jquery", "lodash", "views/AuthView", "views/CommentsView", "hbs!templates/comment", "models/Comment", "spinjs", "hbs!templates/commentApologyModal", "views/CommentReportView", "views/CommentRemoveView", "utils/paragraphs", "widgets/modal"], function (e, t, n, i, s, r, o, a, l, c, u) { "use strict"; function h() { i || (i = require("views/CommentsView")) } var d = ["ADD1D6", "B0C4CC", "778390", "4B6375"], p = {}, f = t.once(function () { p.$apology = null, p.$body = e("body, html"), p.reportView = null }), m = "comment__upvote--upvoted", g = n.extend({ tagName: "article", className: "comment", events: { "click a.comment__reply": "reply", "click a.comment__upvote": "upvote", "click a.comment__report": "report", "click a.comment__edit": "edit", "click a.comment__delete": "remove", "click a.comment__move": "move", "click button.comment__response__submit": "submit", "click button.comment__response__cancel": "cancel", "keyup textarea.comment__response__input": "recountResponse", "click button.comment__editor__submit": "submitEdit", "click button.comment__editor__cancel": "cancelEdit", "keyup textarea.comment__editor__input": "recountEdit" }, initialize: function () { this.listenTo(this.model, "change:upvotes", this.refreshUpvotes), this.listenTo(this.model, "change:reported", this.refreshReported), this.listenTo(this.model, "change:removed", this.refreshRemoved), this.listenTo(this.model, "change:message", this.refreshMessage), this.listenTo(this.model, "request", this._request), this.demandAuthFor("reply", "upvote", "report", "edit", "remove", "move"), this.$el.data("view", this) }, recountResponse: function (e) { this._checkEventRecipient("recountResponse", e) && this.$responseCount.text(this.model.maxMessageLength - this.$responseText.val().length) }, render: function () { f(); var e = this.model.collection.parent, n = this.model.toJSON(); return n.monogram = this.model.monogram(), n.color = t.shuffle(d)[0], n.paragraphs = u(n.message), this.$el.attr("id", "comment-" + n.id).html(s(t.extend({ parent: e ? e.toJSON() : !1 }, n))), this.$body = this.$el.find("div.comment__body"), this.$edit = this.$el.find("div.comment__editor"), this.$editText = this.$edit.find("textarea.comment__editor__input"), this.$editMessage = this.$edit.find("div.comment__editor__message"), this.$editCount = this.$edit.find("span.comment__editor__count"), this.$response = this.$el.find("article.comment__response"), this.$responseText = this.$response.find("textarea"), this.$responseMessage = this.$response.find("div.comment__response__message"), this.$responseCount = this.$response.find("span.comment__response__limit__remain"), this.$upvote = this.$el.find("a.comment__upvote"), this.$upvoteCount = this.$el.find("span.comment__upvote__count"), this._renderReplies(), this }, refreshMessage: function () { this.$body.text(this.model.get("message")) }, refreshRemoved: function () { this.$el.slideUp("fast") }, edit: function (e) { var n = this; n._checkEventRecipient("edit", e) && (e.preventDefault(), n.$editText.val(n.model.get("message")), n.recountEdit(e), n.$body.slideUp("fast"), n.$edit.slideDown("fast"), t.delay(function () { n.$editText.focus() }, 100)) }, remove: function (e) { this._checkEventRecipient("remove", e) && (e.preventDefault(), new c({ model: this.model }).render()) }, move: function (e) { this._checkEventRecipient("move", e) && e.preventDefault() }, submitEdit: function (e) { var t = this; if (t._checkEventRecipient("submitEdit", e)) { e.preventDefault(); var n = t.model.get("message"); t.model.set("message", t.$editText.val()); var i = t.model.save(); i ? (t.$editMessage.slideUp("fast"), this._getSpinner().spin(t.$edit.get(0)), this.disableEdit(!0), i.then(function () { t.$edit.slideUp("fast"), t.$body.slideDown("fast") }, function () { t.apologize(), t.model.set("message", n) }).always(function () { t._spinner.stop(), t.disableEdit(!1) })) : (t.model.set("message", n), t.$editMessage.text(t.model.validationError).slideDown("fast")) } }, cancelEdit: function (e) { this._checkEventRecipient("cancelEdit", e) && (e.preventDefault(), this.$edit.slideUp("fast"), this.$body.slideDown("fast")) }, disableEdit: function (e) { this.$edit.find("button, input, textarea").prop("disabled", e) }, recountEdit: function (e) { this._checkEventRecipient("recountEdit", e) && (e.preventDefault(), this.$editCount.text(this.model.maxMessageLength - this.$editText.val().length)) }, reply: function (e) { if (this._checkEventRecipient("reply", e)) { e.preventDefault(), this.$response.slideDown(); var t = this.$response.offset().top; p.$body.animate({ scrollTop: t - 60 }, Math.max(100 * (this.model.replies.length + 1), 500)), this.$responseText.focus() } }, cancel: function (e) { this._checkEventRecipient("cancel", e) && (e.preventDefault(), this.$response.slideUp("fast")) }, upvote: function (e) { this._checkEventRecipient("upvote", e) && (e.preventDefault(), this.model.toggleUpvote()) }, report: function (e) { this._checkEventRecipient("report", e) && (e.preventDefault(), this.model.get("reported") ? this.model.unreport() : new l({ model: this.model }).render()) }, submit: function (e) { var t = this; if (t._checkEventRecipient("submit", e)) { e.preventDefault(); var n = new r({ parentId: t.model.get("id"), message: t.$responseText.val() }), i = n.save(); i ? (t.$responseMessage.slideUp("fast"), this._getSpinner().spin(t.$response.get(0)), this.disableResponse(!0), i.then(function () { t.model.replies.add(n), t.$responseText.val(""), t.$response.slideUp("fast") }, function () { t.apologize(), n = null }).always(function () { t._spinner.stop(), t.disableResponse(!1) })) : (t.$responseMessage.text(n.validationError).slideDown("fast"), n = null) } }, disableResponse: function (e) { this.$response[e ? "addClass" : "removeClass"]("comment__response--disabled"), this.$response.find("button, input, textarea").prop("disabled", e) }, apologize: function () { p.$apology ? p.$apology.modal("open") : p.$apology = e(a()).modal() }, refreshUpvotes: function () { var e = this.model.get("upvotes"), t = e && e > 0; t && this.$upvoteCount.text("(" + e + ")"), this.$upvoteCount[t ? "fadeIn" : "fadeOut"]("fast"), this.$upvote[this.model.get("upvoted") ? "addClass" : "removeClass"](m) }, refreshReported: function () { var t = e(s(this.model.toJSON())).find(".comment__report"); this.$el.find(".comment__report").replaceWith(t) }, _checkEventRecipient: function (t, n) { var i = e(n.target).closest("article.comment"), s = i.data("view"), r = s === this; return r || s[t].call(s, n), r }, _getSpinner: function () { return this._spinner || (this._spinner = new o), this._spinner }, _renderReplies: function () { h(), this._repliesView = new i({ events: {}, collection: this.model.replies }), this._repliesView.render(), this._repliesView.$el.appendTo(this.$el.find("div.comment__replies")) }, _pendingRequests: 0, _request: function (e, t) { var n = this; n._requestSpinner || (n._requestSpinner = new o), n.$body.is(":visible") && n._requestSpinner.spin(n.$body.get(0)), n._pendingRequests++, t.always(function () { n._pendingRequests--, n._pendingRequests <= 0 && n._requestSpinner.stop() }) } }); return g }), define("views/CommentsView", ["jquery", "lodash", "Backbone", "views/CommentView"], function (e, t, n, i) { "use strict"; function s(t, n) { var i = e(n.target).closest("article.comment"), s = i.data("view"); s[t].call(s, n) } var r = n.View.extend({ tagName: "section", className: "comments", events: { "click a.comment__reply": "commentReply", "click a.comment__upvote": "commentUpvote", "click a.comment__report": "commentReport", "click a.comment__edit": "commentEdit", "click a.comment__delete": "commentRemove", "click a.comment__move": "commentMove", "click button.comment__response__submit": "commentSubmit", "click button.comment__response__cancel": "commentCancel", "keyup textarea.comment__response__input": "commentRecountResponse", "click button.comment__editor__submit": "commentSubmitEdit", "click button.comment__editor__cancel": "commentCancelEdit", "keyup textarea.comment__editor__input": "commentRecountEdit" }, initialize: function () { this.listenTo(this.collection, "add", this._addComment), this.listenTo(this.collection, "reset", this.render) }, render: function () { var e = this; return e.$el.empty(), e.collection.length ? e.collection.each(function (t) { e._addComment(t) }) : e.$el.hide(), e._rendered = !0, e }, commentReply: function (e) { s("reply", e) }, commentUpvote: function (e) { s("upvote", e) }, commentEdit: function (e) { s("edit", e) }, commentRemove: function (e) { s("remove", e) }, commentMove: function (e) { s("move", e) }, commentRecountResponse: function (e) { s("recountResponse", e) }, commentReport: function (e) { s("report", e) }, commentSubmit: function (e) { s("submit", e) }, commentCancel: function (e) { s("cancel", e) }, commentSubmitEdit: function (e) { s("submitEdit", e) }, commentCancelEdit: function (e) { s("cancelEdit", e) }, commentRecountEdit: function (e) { s("recountEdit", e) }, _addComment: function (e, t, n) { var s = new i({ events: {}, model: e }), r = s.render().$el; this._rendered && r.hide(), this.$el[n && 0 === n.at ? "prepend" : "append"](r), this._rendered && (this.$el.show(), r.slideDown("fast")) } }); return r }), define("views/ThreadView", ["jquery", "lodash", "Backbone", "spinjs", "hbs!templates/commentApologyModal", "views/CommentsView", "models/Comment", "widgets/modal"], function (e, t, n, i, s, r, o) { "use strict"; function a() { l ? l.modal("open") : l = e(s()).modal() } var l, c = n.View.extend({ events: { "click button.thread__new__button": "submitNew", "keyup textarea.thread__new__input": "recountNew", "click a.thread__more": "more", "click input.thread__sorts__option__input": "sort" }, $els: { newArea: "div.thread__new", newAlert: "div.thread__new__alert", newCount: "span.thread__new__count", newText: "textarea.thread__new__input", comments: "div.thread__comments", sorts: "input.thread__sorts__option__input", more: "a.thread__more", loading: null }, disableNew: function (e) { this.init$el("newArea") && this.$els.newArea.find("button, input, textarea").prop("disabled", e) }, getSort: function () { return this.init$el("sorts") ? this.$els.sorts.filter(":checked").val() : null }, initialize: function () { this.listenTo(this.model, "request", this._loadingMore), this.listenTo(this.model.comments, "add", this._recountComments), this.listenTo(this.model.comments, "remove", this._recountComments), this.listenTo(this.model.comments, "reset", this._recountComments) }, more: function (e) { e && e.preventDefault(), this.model.more() }, recountNew: function () { this.init$el("newCount") && this.init$el("newText") && this.$els.newCount.text(o.prototype.maxMessageLength - this.$els.newText.val().length) }, render: function () { this.commentsView || (this.commentsView = new r({ collection: this.model.comments })), this.init$el("comments") && (this.commentsView.render().$el.appendTo(this.$els.comments), this.$els.loading = e("<div></div>").addClass("thread__loading").hide().appendTo(this.$els.comments), this._recountComments()) }, sort: function () { this.model.sort(this.getSort()) }, submitNew: function (e) { var t = this; if (t.init$el("newAlert") && t.init$el("newArea") && t.init$el("newText")) { e && e.preventDefault(); var n = new o({ threadId: t.model.get("id"), message: t.$els.newText.val() }), i = n.save(); i ? (t.$els.newAlert.slideUp("fast"), this._getSpinner().spin(t.$els.newArea.get(0)), t.disableNew(!0), i.then(function () { t.model.comments.add(n, { at: 0 }), t.$els.newText.val("") }, function () { a(), n = null }).always(function () { t._spinner.stop(), t.disableNew(!1) })) : (t.$els.newAlert.text(n.validationError).slideDown("fast"), n = null) } }, init$el: function (e) { var n = this.$els[e]; return n && t.isString(n) ? (n = this.$el.find(n), n.length || (n = !1), this.$els[e] = n, n) : n }, _getSpinner: function () { return this._spinner || (this._spinner = new i), this._spinner }, _loadingMore: function (e, t) { var n = this; n.$els.loading && (n._getSpinner().spin(n.$els.loading.show().get(0)), n.$el.addClass("thread--loading"), t.always(function () { n._spinner.stop(), n.$els.loading.slideUp("fast"), n.$el.removeClass("thread--loading") }).done(function (e) { e && e.metadata.pageCount <= e.metadata.page ? n.init$el("more").fadeOut("fast") : n.init$el("more").show() })) }, _recountCommentsLast: null, _recountComments: function () { var e = this.model.comments.length > 0; e !== this._recountCommentsLast && (this.$el[e ? "removeClass" : "addClass"]("thread--no-comments")[e ? "addClass" : "removeClass"]("thread--with-comments"), this._recountCommentsLast = e) } }); return c }), define("models/Thread", ["Backbone", "collections/Comments", "lib/thread"], function (e, t, n) { "use strict"; var i = e.Model.extend({ defaults: { id: null, sort: "rated" }, _loadingMore: !1, nextPage: 1, constructor: function () { this.comments = new t, e.Model.apply(this, arguments) }, more: function () { var e = this; if (!e._loadingMore) { e._loadingMore = !0; var t = e.get("id"), i = { page: e.nextPage, sort: e.get("sort") }, s = n.get(t, i).then(function (t) { var n = t.records; return n && n.length && (e.comments[1 === e.nextPage ? "reset" : "add"](n), e.nextPage++), t }).always(function () { e._loadingMore = !1 }); e.trigger("request", e, s) } }, sort: function (e) { this.set("sort", e), this.nextPage = 1, this.more() } }); return i }), define("apps/your_impact/models/share_token", ["Backbone"], function (e) { "use strict"; return e.Model.extend({ talk: null, _activating: !1, urlRoot: "/share_tokens", initialize: function () { this.readyForSharing = !1, this.listenTo(this, "sync", this.setSharableUrl) }, activate: function () { var e = this; this.isNew() && !this._activating && (this._activating = !0, this.save({}, { error: function () { e.isError = !0, e.trigger("error") } })) }, setSharableUrl: function () { var e; e = this.get("short_url") ? this.get("short_url") : this.talk.canonical + "?share=" + this.get("token"), this.set("sharableUrl", e), this.readyForSharing = !0, this.trigger("readyForSharing") } }) }), define("apps/your_impact/models/share_stats", ["Backbone"], function (e) { "use strict"; return e.Model.extend({ talk: null, url: function () { return "/talks/" + this.talk.slug + "/share_stats" } }) }), define("utils/f", [], function () { "use strict"; var e = function (e, t) { var n = Array.prototype.slice.call(arguments, 2); return function () { return e[t].apply(e, n) } }; return e.create = function (e) { return function () { var t = arguments, n = function () { return e.apply(this, t) }; return n.prototype = e.prototype, new n } }, e.get = function (e) { return function (t) { return t.get && "function" == typeof t.get ? t.get(e) : t[e] && "function" == typeof t[e] ? t[e].call(t) : t[e] } }, e.splat = function () { var t = Array.prototype.slice.call(arguments); return function (n) { for (var i = [], s = 0; s < t.length; s++) i.push(e.get(t[s]).call(n)); return i } }, e.send = function (e) { var t = Array.prototype.slice.call(arguments, 1); return function (n) { return n[e].apply(n, t) } }, e.and = function () { var e = Array.prototype.slice.call(arguments); return function (t) { for (var n = !0, i = 0; i < e.length; i++) n = n && e[i].call(null, t); return n } }, e.not = function (e) { return function () { return !e.apply(null, arguments) } }, e.ascending = function (e, t) { return e - t }, e.descending = function (e, t) { return t - e }, e }), define("apps/your_impact/views/base", ["Backbone"], function (e) { "use strict"; return e.View.extend({ connectedView: null, outlet: function () { return this.$el.find(this.outletClass || "> .outlet") }, connectOutlet: function (e, t) { return this.disconnectOutlet(), this.connectedView = new e({ app: this.app, model: t }), this.outlet().append(this.connectedView.render().el), this.connectedView }, disconnectOutlet: function () { this.connectedView && (this.connectedView.remove(), this.outlet().empty(), this.connectedView = null) } }) }), function () {
        "use strict"; function e(e) { return e.replace(/,/g, ".").replace(/[^0-9\.]/g, "") } function t(t) { return parseFloat(e(t)) >= 10 } var n, i = { bridge: null, version: "0.0.0", disabled: null, outdated: null, ready: null }, s = {}, r = 0, o = {}, a = 0, l = {}, c = null, u = null, h = function () { var e, t, n, i, s = "ZeroClipboard.swf"; if (document.currentScript && (i = document.currentScript.src)); else { var r = document.getElementsByTagName("script"); if ("readyState" in r[0]) for (e = r.length; e-- && ("interactive" !== r[e].readyState || !(i = r[e].src)) ;); else if ("loading" === document.readyState) i = r[r.length - 1].src; else { for (e = r.length; e--;) { if (n = r[e].src, !n) { t = null; break } if (n = n.split("#")[0].split("?")[0], n = n.slice(0, n.lastIndexOf("/") + 1), null == t) t = n; else if (t !== n) { t = null; break } } null !== t && (i = t) } } return i && (i = i.split("#")[0].split("?")[0], s = i.slice(0, i.lastIndexOf("/") + 1) + s), s }(), d = function () { var e = /\-([a-z])/g, t = function (e, t) { return t.toUpperCase() }; return function (n) { return n.replace(e, t) } }(), p = function (e, t) { var n, i, s; return window.getComputedStyle ? n = window.getComputedStyle(e, null).getPropertyValue(t) : (i = d(t), n = e.currentStyle ? e.currentStyle[i] : e.style[i]), "cursor" !== t || n && "auto" !== n || (s = e.tagName.toLowerCase(), "a" !== s) ? n : "pointer" }, f = function (e) { e || (e = window.event); var t; this !== window ? t = this : e.target ? t = e.target : e.srcElement && (t = e.srcElement), A.activate(t) }, m = function (e, t, n) { e && 1 === e.nodeType && (e.addEventListener ? e.addEventListener(t, n, !1) : e.attachEvent && e.attachEvent("on" + t, n)) }, g = function (e, t, n) { e && 1 === e.nodeType && (e.removeEventListener ? e.removeEventListener(t, n, !1) : e.detachEvent && e.detachEvent("on" + t, n)) }, v = function (e, t) { if (!e || 1 !== e.nodeType) return e; if (e.classList) return e.classList.contains(t) || e.classList.add(t), e; if (t && "string" == typeof t) { var n = (t || "").split(/\s+/); if (1 === e.nodeType) if (e.className) { for (var i = " " + e.className + " ", s = e.className, r = 0, o = n.length; o > r; r++) i.indexOf(" " + n[r] + " ") < 0 && (s += " " + n[r]); e.className = s.replace(/^\s+|\s+$/g, "") } else e.className = t } return e }, _ = function (e, t) { if (!e || 1 !== e.nodeType) return e; if (e.classList) return e.classList.contains(t) && e.classList.remove(t), e; if (t && "string" == typeof t || void 0 === t) { var n = (t || "").split(/\s+/); if (1 === e.nodeType && e.className) if (t) { for (var i = (" " + e.className + " ").replace(/[\n\t]/g, " "), s = 0, r = n.length; r > s; s++) i = i.replace(" " + n[s] + " ", " "); e.className = i.replace(/^\s+|\s+$/g, "") } else e.className = "" } return e }, y = function () { var e, t, n, i = 1; return "function" == typeof document.body.getBoundingClientRect && (e = document.body.getBoundingClientRect(), t = e.right - e.left, n = document.body.offsetWidth, i = Math.round(t / n * 100) / 100), i }, b = function (e, t) { var n = { left: 0, top: 0, width: 0, height: 0, zIndex: T(t) - 1 }; if (e.getBoundingClientRect) { var i, s, r, o = e.getBoundingClientRect(); "pageXOffset" in window && "pageYOffset" in window ? (i = window.pageXOffset, s = window.pageYOffset) : (r = y(), i = Math.round(document.documentElement.scrollLeft / r), s = Math.round(document.documentElement.scrollTop / r)); var a = document.documentElement.clientLeft || 0, l = document.documentElement.clientTop || 0; n.left = o.left + i - a, n.top = o.top + s - l, n.width = "width" in o ? o.width : o.right - o.left, n.height = "height" in o ? o.height : o.bottom - o.top } return n }, w = function (e, t) { var n = null == t || t && t.cacheBust === !0 && t.useNoCache === !0; return n ? (-1 === e.indexOf("?") ? "?" : "&") + "noCache=" + (new Date).getTime() : "" }, k = function (e) { var t, n, i, s = [], r = [], o = []; if (e.trustedOrigins && ("string" == typeof e.trustedOrigins ? r.push(e.trustedOrigins) : "object" == typeof e.trustedOrigins && "length" in e.trustedOrigins && (r = r.concat(e.trustedOrigins))), e.trustedDomains && ("string" == typeof e.trustedDomains ? r.push(e.trustedDomains) : "object" == typeof e.trustedDomains && "length" in e.trustedDomains && (r = r.concat(e.trustedDomains))), r.length) for (t = 0, n = r.length; n > t; t++) if (r.hasOwnProperty(t) && r[t] && "string" == typeof r[t]) { if (i = D(r[t]), !i) continue; if ("*" === i) { o = [i]; break } o.push.apply(o, [i, "//" + i, window.location.protocol + "//" + i]) } return o.length && s.push("trustedOrigins=" + encodeURIComponent(o.join(","))), "string" == typeof e.jsModuleId && e.jsModuleId && s.push("jsModuleId=" + encodeURIComponent(e.jsModuleId)), s.join("&") }, x = function (e, t, n) {
            if ("function" == typeof t.indexOf) return t.indexOf(e, n); var i, s = t.length; for ("undefined" == typeof n ? n = 0 : 0 > n && (n = s + n), i = n; s > i; i++) if (t.hasOwnProperty(i) && t[i] === e) return i;
            return -1
        }, S = function (e) { if ("string" == typeof e) throw new TypeError("ZeroClipboard doesn't accept query strings."); return e.length ? e : [e] }, C = function (e, t, n, i) { i ? window.setTimeout(function () { e.apply(t, n) }, 0) : e.apply(t, n) }, T = function (e) { var t, n; return e && ("number" == typeof e && e > 0 ? t = e : "string" == typeof e && (n = parseInt(e, 10)) && !isNaN(n) && n > 0 && (t = n)), t || ("number" == typeof z.zIndex && z.zIndex > 0 ? t = z.zIndex : "string" == typeof z.zIndex && (n = parseInt(z.zIndex, 10)) && !isNaN(n) && n > 0 && (t = n)), t || 0 }, E = function (e, t) { if (e && t !== !1 && "undefined" != typeof console && console && (console.warn || console.log)) { var n = "`" + e + "` is deprecated. See docs for more info:\n    https://github.com/zeroclipboard/zeroclipboard/blob/master/docs/instructions.md#deprecations"; console.warn ? console.warn(n) : console.log(n) } }, M = function () { var e, t, n, i, s, r, o = arguments[0] || {}; for (e = 1, t = arguments.length; t > e; e++) if (null != (n = arguments[e])) for (i in n) if (n.hasOwnProperty(i)) { if (s = o[i], r = n[i], o === r) continue; void 0 !== r && (o[i] = r) } return o }, D = function (e) { if (null == e || "" === e) return null; if (e = e.replace(/^\s+|\s+$/g, ""), "" === e) return null; var t = e.indexOf("//"); e = -1 === t ? e : e.slice(t + 2); var n = e.indexOf("/"); return e = -1 === n ? e : -1 === t || 0 === n ? null : e.slice(0, n), e && ".swf" === e.slice(-4).toLowerCase() ? null : e || null }, I = function () { var e = function (e, t) { var n, i, s; if (null != e && "*" !== t[0] && ("string" == typeof e && (e = [e]), "object" == typeof e && "length" in e)) for (n = 0, i = e.length; i > n; n++) if (e.hasOwnProperty(n) && (s = D(e[n]))) { if ("*" === s) { t.length = 0, t.push("*"); break } -1 === x(s, t) && t.push(s) } }, t = { always: "always", samedomain: "sameDomain", never: "never" }; return function (n, i) { var s, r = i.allowScriptAccess; if ("string" == typeof r && (s = r.toLowerCase()) && /^always|samedomain|never$/.test(s)) return t[s]; var o = D(i.moviePath); null === o && (o = n); var a = []; e(i.trustedOrigins, a), e(i.trustedDomains, a); var l = a.length; if (l > 0) { if (1 === l && "*" === a[0]) return "always"; if (-1 !== x(n, a)) return 1 === l && n === o ? "sameDomain" : "always" } return "never" } }(), O = function (e) { if (null == e) return []; if (Object.keys) return Object.keys(e); var t = []; for (var n in e) e.hasOwnProperty(n) && t.push(n); return t }, P = function (e) { if (e) for (var t in e) e.hasOwnProperty(t) && delete e[t]; return e }, N = function () { var e = !1; if ("boolean" == typeof i.disabled) e = i.disabled === !1; else { if ("function" == typeof ActiveXObject) try { new ActiveXObject("ShockwaveFlash.ShockwaveFlash") && (e = !0) } catch (t) { } !e && navigator.mimeTypes["application/x-shockwave-flash"] && (e = !0) } return e }, A = function (e, t) { return this instanceof A ? (this.id = "" + r++, o[this.id] = { instance: this, elements: [], handlers: {} }, e && this.clip(e), "undefined" != typeof t && (E("new ZeroClipboard(elements, options)", z.debug), A.config(t)), this.options = A.config(), "boolean" != typeof i.disabled && (i.disabled = !N()), void (i.disabled === !1 && i.outdated !== !0 && null === i.bridge && (i.outdated = !1, i.ready = !1, F()))) : new A(e, t) }; A.prototype.setText = function (e) { return e && "" !== e && (s["text/plain"] = e, i.ready === !0 && i.bridge && i.bridge.setText(e)), this }, A.prototype.setSize = function (e, t) { return i.ready === !0 && i.bridge && i.bridge.setSize(e, t), this }; var j = function (e) { i.ready === !0 && i.bridge && i.bridge.setHandCursor(e) }; A.prototype.destroy = function () { this.unclip(), this.off(), delete o[this.id] }; var L = function () { var e, t, n, i = [], s = O(o); for (e = 0, t = s.length; t > e; e++) n = o[s[e]].instance, n && n instanceof A && i.push(n); return i }; A.version = "1.3.2"; var z = { swfPath: h, trustedDomains: window.location.host ? [window.location.host] : [], cacheBust: !0, forceHandCursor: !1, zIndex: 999999999, debug: !0, title: null, autoActivate: !0 }; A.config = function (e) { "object" == typeof e && null !== e && M(z, e); { if ("string" != typeof e || !e) { var t = {}; for (var n in z) z.hasOwnProperty(n) && (t[n] = "object" == typeof z[n] && null !== z[n] ? "length" in z[n] ? z[n].slice(0) : M({}, z[n]) : z[n]); return t } if (z.hasOwnProperty(e)) return z[e] } }, A.destroy = function () { A.deactivate(); for (var e in o) if (o.hasOwnProperty(e) && o[e]) { var t = o[e].instance; t && "function" == typeof t.destroy && t.destroy() } var n = $(i.bridge); n && n.parentNode && (n.parentNode.removeChild(n), i.ready = null, i.bridge = null) }, A.activate = function (e) { n && (_(n, z.hoverClass), _(n, z.activeClass)), n = e, v(e, z.hoverClass), R(); var t = z.title || e.getAttribute("title"); if (t) { var s = $(i.bridge); s && s.setAttribute("title", t) } var r = z.forceHandCursor === !0 || "pointer" === p(e, "cursor"); j(r) }, A.deactivate = function () { var e = $(i.bridge); e && (e.style.left = "0px", e.style.top = "-9999px", e.removeAttribute("title")), n && (_(n, z.hoverClass), _(n, z.activeClass), n = null) }; var F = function () { var e, t, n = document.getElementById("global-zeroclipboard-html-bridge"); if (!n) { var s = A.config(); s.jsModuleId = "string" == typeof c && c || "string" == typeof u && u || null; var r = I(window.location.host, z), o = k(s), a = z.moviePath + w(z.moviePath, z), l = '      <object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" id="global-zeroclipboard-flash-bridge" width="100%" height="100%">         <param name="movie" value="' + a + '"/>         <param name="allowScriptAccess" value="' + r + '"/>         <param name="scale" value="exactfit"/>         <param name="loop" value="false"/>         <param name="menu" value="false"/>         <param name="quality" value="best" />         <param name="bgcolor" value="#ffffff"/>         <param name="wmode" value="transparent"/>         <param name="flashvars" value="' + o + '"/>         <embed src="' + a + '"           loop="false" menu="false"           quality="best" bgcolor="#ffffff"           width="100%" height="100%"           name="global-zeroclipboard-flash-bridge"           allowScriptAccess="' + r + '"           allowFullScreen="false"           type="application/x-shockwave-flash"           wmode="transparent"           pluginspage="http://www.macromedia.com/go/getflashplayer"           flashvars="' + o + '"           scale="exactfit">         </embed>       </object>'; n = document.createElement("div"), n.id = "global-zeroclipboard-html-bridge", n.setAttribute("class", "global-zeroclipboard-container"), n.style.position = "absolute", n.style.left = "0px", n.style.top = "-9999px", n.style.width = "15px", n.style.height = "15px", n.style.zIndex = "" + T(z.zIndex), document.body.appendChild(n), n.innerHTML = l } e = document["global-zeroclipboard-flash-bridge"], e && (t = e.length) && (e = e[t - 1]), i.bridge = e || n.children[0].lastElementChild }, $ = function (e) { for (var t = /^OBJECT|EMBED$/, n = e && e.parentNode; n && t.test(n.nodeName) && n.parentNode;) n = n.parentNode; return n || null }, R = function () { if (n) { var e = b(n, z.zIndex), t = $(i.bridge); t && (t.style.top = e.top + "px", t.style.left = e.left + "px", t.style.width = e.width + "px", t.style.height = e.height + "px", t.style.zIndex = e.zIndex + 1), i.ready === !0 && i.bridge && i.bridge.setSize(e.width, e.height) } return this }; A.prototype.on = function (e, t) { var n, s, r, a = {}, l = o[this.id] && o[this.id].handlers; if ("string" == typeof e && e) r = e.toLowerCase().split(/\s+/); else if ("object" == typeof e && e && "undefined" == typeof t) for (n in e) e.hasOwnProperty(n) && "string" == typeof n && n && "function" == typeof e[n] && this.on(n, e[n]); if (r && r.length) { for (n = 0, s = r.length; s > n; n++) e = r[n].replace(/^on/, ""), a[e] = !0, l[e] || (l[e] = []), l[e].push(t); a.noflash && i.disabled && U.call(this, "noflash", {}), a.wrongflash && i.outdated && U.call(this, "wrongflash", { flashVersion: i.version }), a.load && i.ready && U.call(this, "load", { flashVersion: i.version }) } return this }, A.prototype.off = function (e, t) { var n, i, s, r, a, l = o[this.id] && o[this.id].handlers; if (0 === arguments.length) r = O(l); else if ("string" == typeof e && e) r = e.split(/\s+/); else if ("object" == typeof e && e && "undefined" == typeof t) for (n in e) e.hasOwnProperty(n) && "string" == typeof n && n && "function" == typeof e[n] && this.off(n, e[n]); if (r && r.length) for (n = 0, i = r.length; i > n; n++) if (e = r[n].toLowerCase().replace(/^on/, ""), a = l[e], a && a.length) if (t) for (s = x(t, a) ; -1 !== s;) a.splice(s, 1), s = x(t, a, s); else l[e].length = 0; return this }, A.prototype.handlers = function (e) { var t, n = null, i = o[this.id] && o[this.id].handlers; if (i) { if ("string" == typeof e && e) return i[e] ? i[e].slice(0) : null; n = {}; for (t in i) i.hasOwnProperty(t) && i[t] && (n[t] = i[t].slice(0)) } return n }; var q = function (e, t, n, i) { var s = o[this.id] && o[this.id].handlers[e]; if (s && s.length) { var r, a, l, c = t || this; for (r = 0, a = s.length; a > r; r++) l = s[r], t = c, "string" == typeof l && "function" == typeof window[l] && (l = window[l]), "object" == typeof l && l && "function" == typeof l.handleEvent && (t = l, l = l.handleEvent), "function" == typeof l && C(l, t, n, i) } return this }; A.prototype.clip = function (e) { e = S(e); for (var t = 0; t < e.length; t++) if (e.hasOwnProperty(t) && e[t] && 1 === e[t].nodeType) { e[t].zcClippingId ? -1 === x(this.id, l[e[t].zcClippingId]) && l[e[t].zcClippingId].push(this.id) : (e[t].zcClippingId = "zcClippingId_" + a++, l[e[t].zcClippingId] = [this.id], z.autoActivate === !0 && m(e[t], "mouseover", f)); var n = o[this.id].elements; -1 === x(e[t], n) && n.push(e[t]) } return this }, A.prototype.unclip = function (e) { var t = o[this.id]; if (t) { var n, i = t.elements; e = "undefined" == typeof e ? i.slice(0) : S(e); for (var s = e.length; s--;) if (e.hasOwnProperty(s) && e[s] && 1 === e[s].nodeType) { for (n = 0; -1 !== (n = x(e[s], i, n)) ;) i.splice(n, 1); var r = l[e[s].zcClippingId]; if (r) { for (n = 0; -1 !== (n = x(this.id, r, n)) ;) r.splice(n, 1); 0 === r.length && (z.autoActivate === !0 && g(e[s], "mouseover", f), delete e[s].zcClippingId) } } } return this }, A.prototype.elements = function () { var e = o[this.id]; return e && e.elements ? e.elements.slice(0) : [] }; var H = function (e) { var t, n, i, s, r, a = []; if (e && 1 === e.nodeType && (t = e.zcClippingId) && l.hasOwnProperty(t) && (n = l[t], n && n.length)) for (i = 0, s = n.length; s > i; i++) r = o[n[i]].instance, r && r instanceof A && a.push(r); return a }; z.hoverClass = "zeroclipboard-is-hover", z.activeClass = "zeroclipboard-is-active", z.trustedOrigins = null, z.allowScriptAccess = null, z.useNoCache = !0, z.moviePath = "ZeroClipboard.swf", A.detectFlashSupport = function () { return E("ZeroClipboard.detectFlashSupport", z.debug), N() }, A.dispatch = function (e, t) { if ("string" == typeof e && e) { var i = e.toLowerCase().replace(/^on/, ""); if (i) for (var s = n ? H(n) : L(), r = 0, o = s.length; o > r; r++) U.call(s[r], i, t) } }, A.prototype.setHandCursor = function (e) { return E("ZeroClipboard.prototype.setHandCursor", z.debug), e = "boolean" == typeof e ? e : !!e, j(e), z.forceHandCursor = e, this }, A.prototype.reposition = function () { return E("ZeroClipboard.prototype.reposition", z.debug), R() }, A.prototype.receiveEvent = function (e, t) { if (E("ZeroClipboard.prototype.receiveEvent", z.debug), "string" == typeof e && e) { var n = e.toLowerCase().replace(/^on/, ""); n && U.call(this, n, t) } }, A.prototype.setCurrent = function (e) { return E("ZeroClipboard.prototype.setCurrent", z.debug), A.activate(e), this }, A.prototype.resetBridge = function () { return E("ZeroClipboard.prototype.resetBridge", z.debug), A.deactivate(), this }, A.prototype.setTitle = function (e) { if (E("ZeroClipboard.prototype.setTitle", z.debug), e = e || z.title || n && n.getAttribute("title")) { var t = $(i.bridge); t && t.setAttribute("title", e) } return this }, A.setDefaults = function (e) { E("ZeroClipboard.setDefaults", z.debug), A.config(e) }, A.prototype.addEventListener = function (e, t) { return E("ZeroClipboard.prototype.addEventListener", z.debug), this.on(e, t) }, A.prototype.removeEventListener = function (e, t) { return E("ZeroClipboard.prototype.removeEventListener", z.debug), this.off(e, t) }, A.prototype.ready = function () { return E("ZeroClipboard.prototype.ready", z.debug), i.ready === !0 }; var U = function (r, o) { r = r.toLowerCase().replace(/^on/, ""); var a = o && o.flashVersion && e(o.flashVersion) || null, l = n, c = !0; switch (r) { case "load": if (a) { if (!t(a)) return void U.call(this, "onWrongFlash", { flashVersion: a }); i.outdated = !1, i.ready = !0, i.version = a } break; case "wrongflash": a && !t(a) && (i.outdated = !0, i.ready = !1, i.version = a); break; case "mouseover": v(l, z.hoverClass); break; case "mouseout": z.autoActivate === !0 && A.deactivate(); break; case "mousedown": v(l, z.activeClass); break; case "mouseup": _(l, z.activeClass); break; case "datarequested": var u = l.getAttribute("data-clipboard-target"), h = u ? document.getElementById(u) : null; if (h) { var d = h.value || h.textContent || h.innerText; d && this.setText(d) } else { var p = l.getAttribute("data-clipboard-text"); p && this.setText(p) } c = !1; break; case "complete": P(s) } var f = l, m = [this, o]; return q.call(this, r, f, m, c) }; "function" == typeof define && define.amd ? define("ZeroClipboard", ["require", "exports", "module"], function (e, t, n) { return c = n && n.id || null, A }) : "object" == typeof module && module && "object" == typeof module.exports && module.exports ? (u = module.id || null, module.exports = A) : window.ZeroClipboard = A
    }(), define("hbs!apps/your_impact/templates/share_information", ["hbs", "hbs/handlebars"], function (e, t) { var n = t.template(function (e, t, n, i, s) { function r() { return "\n    Share this talk again with your personal URL:\n  " } function o() { return "\n    Here's your personal URL for sharing this talk:\n  " } function a() { return "\n          your-impact__share-information__url--small\n        " } function l() { return '\n      <a href="#"\n        class="button your-impact__share-information__copy" >Copy URL</a>\n    ' } this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var c, u, h = "", d = this, p = "function", f = this.escapeExpression; return h += '<h6 class="your-impact__share-information__title">\n  ', c = n["if"].call(t, t && t.shareViewCount, { hash: {}, inverse: d.program(3, o, s), fn: d.program(1, r, s) }), (c || 0 === c) && (h += c), h += '\n</h6>\n\n<div>\n  <form class="form">\n    <input type="text"\n      value="', (u = n.sharableUrl) ? c = u.call(t, { hash: {} }) : (u = t && t.sharableUrl, c = typeof u === p ? u.call(t, { hash: {} }) : u), h += f(c) + '"\n      class="form-control\n        ', c = n["if"].call(t, t && t.showCopyButton, { hash: {}, inverse: d.noop, fn: d.program(5, a, s) }), (c || 0 === c) && (h += c), h += '\n        your-impact__share-information__url" />\n\n    ', c = n["if"].call(t, t && t.showCopyButton, { hash: {}, inverse: d.noop, fn: d.program(7, l, s) }), (c || 0 === c) && (h += c), h += "\n  </form>\n</div>\n\n\n" }); return n }), define("apps/your_impact/views/share_information", ["Backbone", "underscore", "ZeroClipboard", "utils/is_mobile", "hbs!apps/your_impact/templates/share_information"], function (e, t, n, i, s) { "use strict"; return e.View.extend({ model: null, template: s, initialize: function (e) { this.app = e.app }, events: { "click .your-impact__share-information__url": "focusUrl" }, className: "your-impact__share-information", render: function () { var e = t.merge({}, this.model.toJSON(), { shareViewCount: this.app.shareViewCount, hasSharedTalk: this.app.hasSharedTalk, showCopyButton: !i() }); return this.$el.html(this.template(e)), i() || this.attachClipboard(), this }, attachClipboard: function () { n.config({ swfPath: "/assets/zeroclipboard.swf", moviePath: "/assets/zeroclipboard.swf" }); var e = this.$el.find(".your-impact__share-information__copy"), t = new n(e), i = this.app, s = this.model; return t.on("load", function () { t.on("mouseover", function () { i._canClose = !1 }), t.on("mouseout", function () { i._canClose = !0 }), t.on("datarequested", function (t) { t.setText(s.get("sharableUrl")), e.text("Copied!") }) }), this }, focusUrl: function () { this.$el.find(".your-impact__share-information__url").focus().select() } }) }), define("hbs!apps/your_impact/templates/error", ["hbs", "hbs/handlebars"], function (e, t) { var n = t.template(function (e, t, n) { return this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers), "<h6>Something went wrong</h6>\n\nWe're sorry, but there was an error\nwith the request.\n" }); return n }), define("apps/your_impact/views/error", ["Backbone", "hbs!apps/your_impact/templates/error"], function (e, t) { "use strict"; return e.View.extend({ model: null, template: t, className: "your-impact__error", render: function () { return this.$el.html(this.template()), this } }) }), define("apps/your_impact/views/loading", ["Backbone", "spinjs"], function (e, t) { "use strict"; return e.View.extend({ className: "your-impact__loading", opts: { lines: 13, length: 10, width: 5, radius: 15, corners: 1, rotate: 0, direction: 1, color: "#000", speed: 1, trail: 60, shadow: !1, hwaccel: !1, className: "spinner", zIndex: 2e9, top: 0, left: 120 }, render: function () { return this.spinner = new t(this.opts).spin(this.el), this } }) }), define("templates/helpers/plural", ["Handlebars"], function (e) { "use strict"; e.registerHelper("plural", function (e, t, n) { return 1 === e ? t : n }) }), define("hbs!apps/your_impact/templates/share", ["hbs", "hbs/handlebars", "templates/helpers/plural"], function (e, t) { var n = t.template(function (e, t, n, i, s) { function r(e) { var t, i, s, r = ""; return r += "\n    This talk has been viewed at least\n    ", (i = n.shareViewCount) ? t = i.call(e, { hash: {} }) : (i = e && e.shareViewCount, t = typeof i === c ? i.call(e, { hash: {} }) : i), r += u(t) + " " + u((i = n.plural || e && e.plural, s = { hash: {} }, i ? i.call(e, e && e.shareViewCount, "time", "times", s) : h.call(e, "plural", e && e.shareViewCount, "time", "times", s))) + "\n    thanks to you. Thank you for helping us spread ideas!\n  " } function o() { return "\n    Thank you for helping us spread ideas! Just share this talk with your friends, using the buttons or your personal URL below. Every time you come back, we'll show you how many views you sent our way.\n  " } this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var a, l = "", c = "function", u = this.escapeExpression, h = n.helperMissing, d = this; return l += '<p class="your-impact__popup__intro-text p3">\n  ', a = n["if"].call(t, t && t.shareViewCount, { hash: {}, inverse: d.program(3, o, s), fn: d.program(1, r, s) }), (a || 0 === a) && (l += a), l += '\n</p>\n\n<div class="outlet">\n</div>\n\n' }); return n }), define("lib/templates/helpers/plural", ["Handlebars"], function (e) { "use strict"; e.registerHelper("plural", function (e, t, n) { return 1 === e ? t : n }) }), define("apps/your_impact/views/share", ["apps/your_impact/views/base", "apps/your_impact/views/share_information", "apps/your_impact/views/error", "apps/your_impact/views/loading", "hbs!apps/your_impact/templates/share", "lib/templates/helpers/plural"], function (e, t, n, i, s) { "use strict"; return e.extend({ model: null, className: "your-impact__share", template: s, initialize: function (e) { this.app = e.app, this.listenTo(this.model, "readyForSharing", this.render), this.listenTo(this.model, "error", this.render) }, render: function () { return this.$el.html(s({ shareViewCount: this.app.shareViewCount, hasSharedTalk: this.app.hasSharedTalk })), this.model.readyForSharing ? this.connectOutlet(t, this.model) : this.connectOutlet(this.model.isError ? n : i), this } }) }), define("hbs!apps/your_impact/templates/not_logged_in", ["hbs", "hbs/handlebars"], function (e, t) { var n = t.template(function (e, t, n) { return this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers), '<p class="your-impact__popup__intro-text p3">\n  We\'ll tell you how many views you sent our way.\n  Just log in and share the talk. We\'ll do the rest.\n</p>\n\n<div>\n  <a href="/session/new"\n    class="your-impact__not-logged-in__button button button--wide">Log in</a>\n\n  <div class="p4">\n    No account?<br />\n    <a href="https://auth.ted.com/users/new"\n      class="your-impact__sign-up">Sign up now</a>\n      - It\'s fast and free\n  </div>\n</div>\n' }); return n }), define("apps/your_impact/views/not_logged_in", ["apps/your_impact/views/base", "hbs!apps/your_impact/templates/not_logged_in"], function (e, t) { "use strict"; return e.extend({ className: "your-impact__not-logged-in", template: t, render: function () { return this.$el.html(this.template()), this } }) }), define("hbs!apps/your_impact/templates/popup", ["hbs", "hbs/handlebars"], function (e, t) { var n = t.template(function (e, t, n, i, s) { function r() { return "\n    You can see your influence!\n  " } function o() { return "\n    Share this talk and track your influence!\n  " } this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var a, l = "", c = this; return l += '<div class="your-impact__popup__title h8">\n  ', a = n["if"].call(t, t && t.shareViewCount, { hash: {}, inverse: c.program(3, o, s), fn: c.program(1, r, s) }), (a || 0 === a) && (l += a), l += '\n</div>\n\n<div class="your-impact__popup__main-outlet outlet"></div>\n\n<div class="p4">\n  <a href="/pages/share-a-ted-talk-track-your-influence">Learn more</a>\n  about how we calculate this\n</div>\n' }); return n }), define("apps/your_impact/views/popup", ["apps/your_impact/views/base", "apps/your_impact/views/share", "apps/your_impact/views/not_logged_in", "hbs!apps/your_impact/templates/popup"], function (e, t, n, i) { "use strict"; return e.extend({ className: "your-impact__popup", template: i, _loggedIn: !1, _opened: !1, initialize: function (e) { this.app = e.app }, opened: function () { this._opened || (this._opened = !0, this.render()) }, render: function () { return this.$el.html(i({ shareViewCount: this.app.shareViewCount, hasSharedTalk: this.app.hasSharedTalk })), this._loggedIn ? (this._opened && this.app.shareToken.activate(), this.connectOutlet(t, this.app.shareToken)) : this.connectOutlet(n), this } }) }), function () { function e(e) { this._value = e } function t(e, t, n, i) { var s, r, o = Math.pow(10, t); return r = (n(e * o) / o).toFixed(t), i && (s = new RegExp("0{1," + i + "}$"), r = r.replace(s, "")), r } function n(e, t, n) { var i; return i = t.indexOf("$") > -1 ? s(e, t, n) : t.indexOf("%") > -1 ? r(e, t, n) : t.indexOf(":") > -1 ? o(e, t) : l(e._value, t, n) } function i(e, t) { var n, i, s, r, o, l = t, c = ["KB", "MB", "GB", "TB", "PB", "EB", "ZB", "YB"], u = !1; if (t.indexOf(":") > -1) e._value = a(t); else if (t === f) e._value = 0; else { for ("." !== d[p].delimiters.decimal && (t = t.replace(/\./g, "").replace(d[p].delimiters.decimal, ".")), n = new RegExp("[^a-zA-Z]" + d[p].abbreviations.thousand + "(?:\\)|(\\" + d[p].currency.symbol + ")?(?:\\))?)?$"), i = new RegExp("[^a-zA-Z]" + d[p].abbreviations.million + "(?:\\)|(\\" + d[p].currency.symbol + ")?(?:\\))?)?$"), s = new RegExp("[^a-zA-Z]" + d[p].abbreviations.billion + "(?:\\)|(\\" + d[p].currency.symbol + ")?(?:\\))?)?$"), r = new RegExp("[^a-zA-Z]" + d[p].abbreviations.trillion + "(?:\\)|(\\" + d[p].currency.symbol + ")?(?:\\))?)?$"), o = 0; o <= c.length && !(u = t.indexOf(c[o]) > -1 ? Math.pow(1024, o + 1) : !1) ; o++); e._value = (u ? u : 1) * (l.match(n) ? Math.pow(10, 3) : 1) * (l.match(i) ? Math.pow(10, 6) : 1) * (l.match(s) ? Math.pow(10, 9) : 1) * (l.match(r) ? Math.pow(10, 12) : 1) * (t.indexOf("%") > -1 ? .01 : 1) * ((t.split("-").length + Math.min(t.split("(").length - 1, t.split(")").length - 1)) % 2 ? 1 : -1) * Number(t.replace(/[^0-9\.]+/g, "")), e._value = u ? Math.ceil(e._value) : e._value } return e._value } function s(e, t, n) { var i, s = t.indexOf("$") <= 1 ? !0 : !1, r = ""; return t.indexOf(" $") > -1 ? (r = " ", t = t.replace(" $", "")) : t.indexOf("$ ") > -1 ? (r = " ", t = t.replace("$ ", "")) : t = t.replace("$", ""), i = l(e._value, t, n), s ? i.indexOf("(") > -1 || i.indexOf("-") > -1 ? (i = i.split(""), i.splice(1, 0, d[p].currency.symbol + r), i = i.join("")) : i = d[p].currency.symbol + r + i : i.indexOf(")") > -1 ? (i = i.split(""), i.splice(-1, 0, r + d[p].currency.symbol), i = i.join("")) : i = i + r + d[p].currency.symbol, i } function r(e, t, n) { var i, s = "", r = 100 * e._value; return t.indexOf(" %") > -1 ? (s = " ", t = t.replace(" %", "")) : t = t.replace("%", ""), i = l(r, t, n), i.indexOf(")") > -1 ? (i = i.split(""), i.splice(-1, 0, s + "%"), i = i.join("")) : i = i + s + "%", i } function o(e) { var t = Math.floor(e._value / 60 / 60), n = Math.floor((e._value - 60 * t * 60) / 60), i = Math.round(e._value - 60 * t * 60 - 60 * n); return t + ":" + (10 > n ? "0" + n : n) + ":" + (10 > i ? "0" + i : i) } function a(e) { var t = e.split(":"), n = 0; return 3 === t.length ? (n += 60 * Number(t[0]) * 60, n += 60 * Number(t[1]), n += Number(t[2])) : 2 === t.length && (n += 60 * Number(t[0]), n += Number(t[1])), Number(n) } function l(e, n, i) { var s, r, o, a, l, c, u = !1, h = !1, m = !1, g = "", v = "", _ = "", y = Math.abs(e), b = ["B", "KB", "MB", "GB", "TB", "PB", "EB", "ZB", "YB"], w = "", k = !1; if (0 === e && null !== f) return f; if (n.indexOf("(") > -1 ? (u = !0, n = n.slice(1, -1)) : n.indexOf("+") > -1 && (h = !0, n = n.replace(/\+/g, "")), n.indexOf("a") > -1 && (n.indexOf(" a") > -1 ? (g = " ", n = n.replace(" a", "")) : n = n.replace("a", ""), y >= Math.pow(10, 12) ? (g += d[p].abbreviations.trillion, e /= Math.pow(10, 12)) : y < Math.pow(10, 12) && y >= Math.pow(10, 9) ? (g += d[p].abbreviations.billion, e /= Math.pow(10, 9)) : y < Math.pow(10, 9) && y >= Math.pow(10, 6) ? (g += d[p].abbreviations.million, e /= Math.pow(10, 6)) : y < Math.pow(10, 6) && y >= Math.pow(10, 3) && (g += d[p].abbreviations.thousand, e /= Math.pow(10, 3))), n.indexOf("b") > -1) for (n.indexOf(" b") > -1 ? (v = " ", n = n.replace(" b", "")) : n = n.replace("b", ""), o = 0; o <= b.length; o++) if (s = Math.pow(1024, o), r = Math.pow(1024, o + 1), e >= s && r > e) { v += b[o], s > 0 && (e /= s); break } return n.indexOf("o") > -1 && (n.indexOf(" o") > -1 ? (_ = " ", n = n.replace(" o", "")) : n = n.replace("o", ""), _ += d[p].ordinal(e)), n.indexOf("[.]") > -1 && (m = !0, n = n.replace("[.]", ".")), a = e.toString().split(".")[0], l = n.split(".")[1], c = n.indexOf(","), l ? (l.indexOf("[") > -1 ? (l = l.replace("]", ""), l = l.split("["), w = t(e, l[0].length + l[1].length, i, l[1].length)) : w = t(e, l.length, i), a = w.split(".")[0], w = w.split(".")[1].length ? d[p].delimiters.decimal + w.split(".")[1] : "", m && 0 === Number(w.slice(1)) && (w = "")) : a = t(e, null, i), a.indexOf("-") > -1 && (a = a.slice(1), k = !0), c > -1 && (a = a.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1" + d[p].delimiters.thousands)), 0 === n.indexOf(".") && (a = ""), (u && k ? "(" : "") + (!u && k ? "-" : "") + (!k && h ? "+" : "") + a + w + (_ ? _ : "") + (g ? g : "") + (v ? v : "") + (u && k ? ")" : "") } function c(e, t) { d[e] = t } var u, h = "1.5.2", d = {}, p = "en", f = null, m = "0,0", g = "undefined" != typeof module && module.exports; u = function (t) { return u.isNumeral(t) ? t = t.value() : 0 === t || "undefined" == typeof t ? t = 0 : Number(t) || (t = u.fn.unformat(t)), new e(Number(t)) }, u.version = h, u.isNumeral = function (t) { return t instanceof e }, u.language = function (e, t) { if (!e) return p; if (e && !t) { if (!d[e]) throw new Error("Unknown language : " + e); p = e } return (t || !d[e]) && c(e, t), u }, u.languageData = function (e) { if (!e) return d[p]; if (!d[e]) throw new Error("Unknown language : " + e); return d[e] }, u.language("en", { delimiters: { thousands: ",", decimal: "." }, abbreviations: { thousand: "k", million: "m", billion: "b", trillion: "t" }, ordinal: function (e) { var t = e % 10; return 1 === ~~(e % 100 / 10) ? "th" : 1 === t ? "st" : 2 === t ? "nd" : 3 === t ? "rd" : "th" }, currency: { symbol: "$" } }), u.zeroFormat = function (e) { f = "string" == typeof e ? e : null }, u.defaultFormat = function (e) { m = "string" == typeof e ? e : "0.0" }, u.fn = e.prototype = { clone: function () { return u(this) }, format: function (e, t) { return n(this, e ? e : m, void 0 !== t ? t : Math.round) }, unformat: function (e) { return "[object Number]" === Object.prototype.toString.call(e) ? e : i(this, e ? e : m) }, value: function () { return this._value }, valueOf: function () { return this._value }, set: function (e) { return this._value = Number(e), this }, add: function (e) { return this._value = this._value + Number(e), this }, subtract: function (e) { return this._value = this._value - Number(e), this }, multiply: function (e) { return this._value = this._value * Number(e), this }, divide: function (e) { return this._value = this._value / Number(e), this }, difference: function (e) { var t = this._value - Number(e); return 0 > t && (t = -t), t } }, g && (module.exports = u), "undefined" == typeof ender && (this.numeral = u), "function" == typeof define && define.amd && define("numeral", [], function () { return u }) }.call(this), define("templates/helpers/formatNumber", ["Handlebars", "numeral"], function (e, t) { "use strict"; function n(e, n) { return t(e).format(n) } return e.registerHelper("formatNumber", n), n }), define("hbs!apps/your_impact/templates/your_impact", ["hbs", "hbs/handlebars", "templates/helpers/formatNumber", "templates/helpers/plural"], function (e, t) { var n = t.template(function (e, t, n, i, s) { function r(e) { var t, i, s = ""; return s += '\n\n  \n  <div class="talk-sharing__value">\n    ' + u((t = n.formatNumber || e && e.formatNumber, i = { hash: {} }, t ? t.call(e, e && e.shareViewCount, "0,0", i) : c.call(e, "formatNumber", e && e.shareViewCount, "0,0", i))) + '\n  </div>\n\n  <div class="talk-sharing__label">\n    <div class="talk-sharing__label__block">\n      ' + u((t = n.plural || e && e.plural, i = { hash: {} }, t ? t.call(e, e && e.shareViewCount, "View", "Views", i) : c.call(e, "plural", e && e.shareViewCount, "View", "Views", i))) + '\n      that\n    </div>\n    <div class="talk-sharing__label__black">came from you</div>\n  </div>\n\n' } function o() { var e = ""; return e += '\n\n  \n  <div class="talk-sharing__your-impact__barchart">\n    <i class="icon icon_barchart"></i>\n  </div>\n  <div class="talk-sharing__label">\n    <div class="talk-sharing__label__block">Share this talk and</div>\n    <div class="talk-sharing__label__block">track your influence!</div>\n  </div>\n\n' } this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var a, l = "", c = n.helperMissing, u = this.escapeExpression, h = this; return a = n["if"].call(t, t && t.shareViewCount, { hash: {}, inverse: h.program(3, o, s), fn: h.program(1, r, s) }), (a || 0 === a) && (l += a), l += "\n" }); return n }), define("lib/templates/helpers/formatNumber", ["Handlebars", "numeral"], function (e, t) { "use strict"; function n(e, n) { return t(e).format(n) } return e.registerHelper("formatNumber", n), n }), define("jqueryui/position", ["jquery"], function () {
        return function (e, t) {
            function n(e, t, n) { return [parseFloat(e[0]) * (p.test(e[0]) ? t / 100 : 1), parseFloat(e[1]) * (p.test(e[1]) ? n / 100 : 1)] } function i(t, n) { return parseInt(e.css(t, n), 10) || 0 } function s(t) { var n = t[0]; return 9 === n.nodeType ? { width: t.width(), height: t.height(), offset: { top: 0, left: 0 } } : e.isWindow(n) ? { width: t.width(), height: t.height(), offset: { top: t.scrollTop(), left: t.scrollLeft() } } : n.preventDefault ? { width: 0, height: 0, offset: { top: n.pageY, left: n.pageX } } : { width: t.outerWidth(), height: t.outerHeight(), offset: t.offset() } } e.ui = e.ui || {}; var r, o = Math.max, a = Math.abs, l = Math.round, c = /left|center|right/, u = /top|center|bottom/, h = /[\+\-]\d+(\.[\d]+)?%?/, d = /^\w+/, p = /%$/, f = e.fn.position; e.position = { scrollbarWidth: function () { if (r !== t) return r; var n, i, s = e("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"), o = s.children()[0]; return e("body").append(s), n = o.offsetWidth, s.css("overflow", "scroll"), i = o.offsetWidth, n === i && (i = s[0].clientWidth), s.remove(), r = n - i }, getScrollInfo: function (t) { var n = t.isWindow || t.isDocument ? "" : t.element.css("overflow-x"), i = t.isWindow || t.isDocument ? "" : t.element.css("overflow-y"), s = "scroll" === n || "auto" === n && t.width < t.element[0].scrollWidth, r = "scroll" === i || "auto" === i && t.height < t.element[0].scrollHeight; return { width: r ? e.position.scrollbarWidth() : 0, height: s ? e.position.scrollbarWidth() : 0 } }, getWithinInfo: function (t) { var n = e(t || window), i = e.isWindow(n[0]), s = !!n[0] && 9 === n[0].nodeType; return { element: n, isWindow: i, isDocument: s, offset: n.offset() || { left: 0, top: 0 }, scrollLeft: n.scrollLeft(), scrollTop: n.scrollTop(), width: i ? n.width() : n.outerWidth(), height: i ? n.height() : n.outerHeight() } } }, e.fn.position = function (t) { if (!t || !t.of) return f.apply(this, arguments); t = e.extend({}, t); var r, p, m, g, v, _, y = e(t.of), b = e.position.getWithinInfo(t.within), w = e.position.getScrollInfo(b), k = (t.collision || "flip").split(" "), x = {}; return _ = s(y), y[0].preventDefault && (t.at = "left top"), p = _.width, m = _.height, g = _.offset, v = e.extend({}, g), e.each(["my", "at"], function () { var e, n, i = (t[this] || "").split(" "); 1 === i.length && (i = c.test(i[0]) ? i.concat(["center"]) : u.test(i[0]) ? ["center"].concat(i) : ["center", "center"]), i[0] = c.test(i[0]) ? i[0] : "center", i[1] = u.test(i[1]) ? i[1] : "center", e = h.exec(i[0]), n = h.exec(i[1]), x[this] = [e ? e[0] : 0, n ? n[0] : 0], t[this] = [d.exec(i[0])[0], d.exec(i[1])[0]] }), 1 === k.length && (k[1] = k[0]), "right" === t.at[0] ? v.left += p : "center" === t.at[0] && (v.left += p / 2), "bottom" === t.at[1] ? v.top += m : "center" === t.at[1] && (v.top += m / 2), r = n(x.at, p, m), v.left += r[0], v.top += r[1], this.each(function () { var s, c, u = e(this), h = u.outerWidth(), d = u.outerHeight(), f = i(this, "marginLeft"), _ = i(this, "marginTop"), S = h + f + i(this, "marginRight") + w.width, C = d + _ + i(this, "marginBottom") + w.height, T = e.extend({}, v), E = n(x.my, u.outerWidth(), u.outerHeight()); "right" === t.my[0] ? T.left -= h : "center" === t.my[0] && (T.left -= h / 2), "bottom" === t.my[1] ? T.top -= d : "center" === t.my[1] && (T.top -= d / 2), T.left += E[0], T.top += E[1], e.support.offsetFractions || (T.left = l(T.left), T.top = l(T.top)), s = { marginLeft: f, marginTop: _ }, e.each(["left", "top"], function (n, i) { e.ui.position[k[n]] && e.ui.position[k[n]][i](T, { targetWidth: p, targetHeight: m, elemWidth: h, elemHeight: d, collisionPosition: s, collisionWidth: S, collisionHeight: C, offset: [r[0] + E[0], r[1] + E[1]], my: t.my, at: t.at, within: b, elem: u }) }), t.using && (c = function (e) { var n = g.left - T.left, i = n + p - h, s = g.top - T.top, r = s + m - d, l = { target: { element: y, left: g.left, top: g.top, width: p, height: m }, element: { element: u, left: T.left, top: T.top, width: h, height: d }, horizontal: 0 > i ? "left" : n > 0 ? "right" : "center", vertical: 0 > r ? "top" : s > 0 ? "bottom" : "middle" }; h > p && a(n + i) < p && (l.horizontal = "center"), d > m && a(s + r) < m && (l.vertical = "middle"), l.important = o(a(n), a(i)) > o(a(s), a(r)) ? "horizontal" : "vertical", t.using.call(this, e, l) }), u.offset(e.extend(T, { using: c })) }) }, e.ui.position = {
                fit: { left: function (e, t) { var n, i = t.within, s = i.isWindow ? i.scrollLeft : i.offset.left, r = i.width, a = e.left - t.collisionPosition.marginLeft, l = s - a, c = a + t.collisionWidth - r - s; t.collisionWidth > r ? l > 0 && 0 >= c ? (n = e.left + l + t.collisionWidth - r - s, e.left += l - n) : e.left = c > 0 && 0 >= l ? s : l > c ? s + r - t.collisionWidth : s : l > 0 ? e.left += l : c > 0 ? e.left -= c : e.left = o(e.left - a, e.left) }, top: function (e, t) { var n, i = t.within, s = i.isWindow ? i.scrollTop : i.offset.top, r = t.within.height, a = e.top - t.collisionPosition.marginTop, l = s - a, c = a + t.collisionHeight - r - s; t.collisionHeight > r ? l > 0 && 0 >= c ? (n = e.top + l + t.collisionHeight - r - s, e.top += l - n) : e.top = c > 0 && 0 >= l ? s : l > c ? s + r - t.collisionHeight : s : l > 0 ? e.top += l : c > 0 ? e.top -= c : e.top = o(e.top - a, e.top) } }, flip: {
                    left: function (e, t) {
                        var n, i, s = t.within, r = s.offset.left + s.scrollLeft, o = s.width, l = s.isWindow ? s.scrollLeft : s.offset.left, c = e.left - t.collisionPosition.marginLeft, u = c - l, h = c + t.collisionWidth - o - l, d = "left" === t.my[0] ? -t.elemWidth : "right" === t.my[0] ? t.elemWidth : 0, p = "left" === t.at[0] ? t.targetWidth : "right" === t.at[0] ? -t.targetWidth : 0, f = -2 * t.offset[0];
                        0 > u ? (n = e.left + d + p + f + t.collisionWidth - o - r, (0 > n || n < a(u)) && (e.left += d + p + f)) : h > 0 && (i = e.left - t.collisionPosition.marginLeft + d + p + f - l, (i > 0 || a(i) < h) && (e.left += d + p + f))
                    }, top: function (e, t) { var n, i, s = t.within, r = s.offset.top + s.scrollTop, o = s.height, l = s.isWindow ? s.scrollTop : s.offset.top, c = e.top - t.collisionPosition.marginTop, u = c - l, h = c + t.collisionHeight - o - l, d = "top" === t.my[1], p = d ? -t.elemHeight : "bottom" === t.my[1] ? t.elemHeight : 0, f = "top" === t.at[1] ? t.targetHeight : "bottom" === t.at[1] ? -t.targetHeight : 0, m = -2 * t.offset[1]; 0 > u ? (i = e.top + p + f + m + t.collisionHeight - o - r, e.top + p + f + m > u && (0 > i || i < a(u)) && (e.top += p + f + m)) : h > 0 && (n = e.top - t.collisionPosition.marginTop + p + f + m - l, e.top + p + f + m > h && (n > 0 || a(n) < h) && (e.top += p + f + m)) }
                }, flipfit: { left: function () { e.ui.position.flip.left.apply(this, arguments), e.ui.position.fit.left.apply(this, arguments) }, top: function () { e.ui.position.flip.top.apply(this, arguments), e.ui.position.fit.top.apply(this, arguments) } }
            }, function () { var t, n, i, s, r, o = document.getElementsByTagName("body")[0], a = document.createElement("div"); t = document.createElement(o ? "div" : "body"), i = { visibility: "hidden", width: 0, height: 0, border: 0, margin: 0, background: "none" }, o && e.extend(i, { position: "absolute", left: "-1000px", top: "-1000px" }); for (r in i) t.style[r] = i[r]; t.appendChild(a), n = o || document.documentElement, n.insertBefore(t, n.firstChild), a.style.cssText = "position: absolute; left: 10.7432222px;", s = e(a).offset().left, e.support.offsetFractions = s > 10 && 11 > s, t.innerHTML = "", n.removeChild(t) }()
        }(jQuery), jQuery
    }), define("widgets/popup", ["jquery", "lodash", "jqueryui/widget", "jqueryui/position"], function (e, t) { "use strict"; function n(e, t) { this.element.removeClass(o).css(e).addClass(s + t.horizontal + " " + s + ("center" === t.vertical ? "middle" : t.vertical)) } for (var i = 300, s = "popup--tailed--", r = ["center", "left", "middle", "right", "bottom", "top"], o = "", a = r.length; a--;) o += s + r[a] + " "; return e.widget("ted.popup", { options: { position: { my: "center bottom-20", at: "center top", of: window, collision: "fit flip" }, inverse: !1, tail: !0 }, _create: function () { this.options.position.using || (this.options.position.using = t.bind(n, this)), this.element.addClass("popup" + (this.options.tail ? " popup--tailed" : "") + (this.options.inverse ? " popup--inverse" : " inverse")) }, _isOpen: !1, open: function (e) { var t = this; t._trigger("beforeOpen", e) !== !1 && (t.position(), t._isOpen = !0, t.element.removeClass("popup--hide").addClass("popup--show"), t._trigger("open")) }, close: function (e) { var t = this, n = t.element; t._trigger("beforeClose", e) !== !1 && (t._isOpen = !1, n.addClass("popup--hide"), setTimeout(function () { t._isOpen || n.removeClass("popup--show") }, i), t._trigger("close")) }, position: function () { this.element.addClass("popup--positioning").position(this.options.position).removeClass("popup--positioning") } }), function (t, n) { return e(t).popup(n) } }), define("widgets/tooltip", ["jquery", "lodash", "jqueryui/widget", "widgets/popup"], function (e) { "use strict"; var t; return e.widget("ted.tooltip", { options: { content: "", interactive: !1, interactiveTolerance: 350, position: {}, openDelay: 0, supportTouch: !0, allowClick: !1 }, _create: function () { var n; t || (t = e(document.body)), this.element.addClass("tooltip"), this.options.position.of = this.element, this.popupObject = e("<div class=tooltip__popup>").append(this.options.content).popup(this.options).insertAfter(this.element), n = this.element, this.options.interactive && (n = n.add(this.popupObject)), this._on(n, this._handleEvents), this._on(e("#shoji"), { click: function (t) { !this._isOpened || this.options.interactive && e(t.target).closest(this.popupObject).length || (this._isOpened = !1, this.popupObject.popup("close")) } }) }, _isHoverClickEnabled: !1, _isFirstTouch: !1, _isTouched: !1, _isMousedOver: !1, _handleEvents: { touchstart: function () { this._isTouched = !0, this._isHoverClickEnabled || (this._isFirstTouch = !0) }, mouseover: function (e) { var t = this, n = t.options.openDelay || 0; (this.options.supportTouch || !this._isTouched) && (this._isMousedOver = !0, this._isOpened && (n = 0), clearTimeout(this.timeout), this.timeout = setTimeout(function () { t._isMousedOver && t.openPopup(e) }, n)) }, mouseout: function (e) { var t = this, n = this.options.interactiveTolerance || 0; this._isMousedOver = !1, this._isOpened || (n = 0), clearTimeout(this.timeout), this.timeout = setTimeout(function () { t._isMousedOver || t.closePopup(e) }, n) }, click: function (t) { e(t.target).closest(this.element).length && ((this.options.supportTouch || !this._isTouched) && (this.openPopup(t), !this._isFirstTouch && this._isHoverClickEnabled && this._trigger("hoverclick", t), this._isFirstTouch = !1), this.options.allowClick || (t.preventDefault(), t.stopPropagation())) }, popupopen: function () { this._isHoverClickEnabled = !0 }, popupclose: function () { this._isHoverClickEnabled = !1 } }, _setOption: function (e, t) { "content" === e && this.popupObject.html(t) }, openPopup: function (e) { this._isOpened = !0, this.popupObject.popup("open", e) }, closePopup: function (e) { this.popupObject.popup("close", e), this._off(t, "click"), this._isOpened = !1 }, popup: function () { return this.popupObject } }), function (t, n) { return e(t).tooltip(n) } }), define("apps/your_impact/views/your_impact", ["utils/f", "jquery", "apps/your_impact/views/base", "apps/your_impact/views/popup", "hbs!apps/your_impact/templates/your_impact", "lib/templates/helpers/formatNumber", "widgets/tooltip", "lib/templates/helpers/plural"], function (e, t, n, i, s) { "use strict"; return n.extend({ className: "your-impact", template: s, initialize: function (e) { this.app = e.app }, attachPopup: function () { var e = this.app, n = new i({ app: this.app }); return t(e.rootElement).tooltip({ content: function () { return n._loggedIn = e._loggedIn, n.render().el }, position: { my: "center top+10", at: "center bottom", of: window, collision: "fit flip" }, beforeOpen: function () { n.opened(), e._canClose = !0 }, beforeClose: function () { return e._canClose }, inverse: !0, openDelay: 300, interactive: !0, interactiveTolerance: 200 }), this }, render: function () { return this.$el.html(this.template({ hasSharedTalk: this.app.hasSharedTalk, shareViewCount: this.app.shareViewCount })), this } }) }), define("apps/your_impact/app", ["jquery", "utils/query_param", "lib/currentUser", "apps/your_impact/models/share_token", "apps/your_impact/models/share_stats", "apps/your_impact/views/your_impact"], function (e, t, n, i, s, r) { "use strict"; var o = function (i) { e(document).ajaxSend(function (t, n, i) { function s(e) { var t = document.location.host, n = document.location.protocol, i = "//" + t, s = n + i; return e === s || e.slice(0, s.length + 1) === s + "/" || e === i || e.slice(0, i.length + 1) === i + "/" || !/^(\/\/|http:|https:).*/.test(e) } function r(e) { return /^(GET|HEAD|OPTIONS|TRACE)$/.test(e) } if (!r(i.type) && s(i.url)) { var o = e('meta[name="csrf-token"]').attr("content"); n.setRequestHeader("X-CSRF-Token", o) } }); var r = this; r.talk = i.talk, r.rootElement = i.rootElement, r.shareParent = t("share"), r.shareToken = this.createNewShareToken(); var o = function () { var e = new s; e.talk = r.talk, r._loggedIn = !0, e.fetch(), e.on("sync", function () { r.hasSharedTalk = e.get("has_shared_talk"), r.shareViewCount = e.get("share_view_count"), r.renderImpact() }) }, a = function () { r._loggedIn = !1, r.renderImpact() }; n.getDetails().then(o, a) }; return o.prototype = { getShareToken: function () { return this._loggedIn ? (this.shareToken.activate(), this.shareToken) : !this._loggedIn && this.shareParent ? this.getParentToken() : void 0 }, getParentToken: function () { var e = new i({ id: this.shareParent, token: this.shareParent }); return e.talk = this.talk, e.setSharableUrl(), e }, createNewShareToken: function () { var e = new i({ shared_item_id: this.talk.id, shared_item_type: "Talk", parent_token: this.shareParent, uri: document.URL, scope: "roadrunner" }); return e.talk = this.talk, e }, renderImpact: function () { var t = new r({ app: this }); e(this.rootElement).html(t.render().el), t.attachPopup() } }, o }), define("hbs!templates/talkHeroHiccup", ["hbs", "hbs/handlebars"], function (e, t) { var n = t.template(function (e, t, n) { this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var i = ""; return i += '\n\n<div class="talk-hero__hiccup">\n  <div class="talk-hero__inner">\n    <div class="container">\n      We are experiencing a small hiccup.\n      Video playback may be slow or choppy.\n      Please be patient.\n      We\'re working on it!\n      You can always\n      download this talk\n      or save it to watch later.\n    </div>\n  </div>\n</div>\n' }); return n }), define("hbs!templates/controlsMaxi", ["hbs", "hbs/handlebars", "templates/helpers/icon", "templates/helpers/t"], function (e, t) { var n = t.template(function (e, t, n, i, s) { function r(e) { var t, i, s = ""; return s += '\n        <a class="controls__button controls__skip" href="#">\n          ' + d((t = n.icon || e && e.icon, i = { hash: {} }, t ? t.call(e, "control-skip", "", "controls__icon", i) : h.call(e, "icon", "control-skip", "", "controls__icon", i))) + "\n          " + d((t = n.t || e && e.t, i = { hash: {} }, t ? t.call(e, "Skip", i) : h.call(e, "t", "Skip", i))) + "\n        </a>\n      " } function o(e) { var t, i, s = ""; return s += '\n        <a class="controls__button controls__button--right controls__transcript" href="#">\n          ' + d((t = n.icon || e && e.icon, i = { hash: {} }, t ? t.call(e, "control-transcript", "", "controls__icon", i) : h.call(e, "icon", "control-transcript", "", "controls__icon", i))) + "\n          " + d((t = n.t || e && e.t, i = { hash: {} }, t ? t.call(e, "Transcript", i) : h.call(e, "t", "Transcript", i))) + "\n        </a>\n      " } this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var a, l, c, u = "", h = n.helperMissing, d = this.escapeExpression, p = this; return u += '\n\n<div class="controls controls--maxi controls--active">\n  <div class="controls__scrubber scrubber">\n    <span class="controls__time controls__time--elapsed">0:00</span>\n    <span class="controls__time controls__time--duration">0:00</span>\n  </div>\n\n  <div class="controls__toolbar">\n    <div class="controls__toolbar__container">\n      <a class="controls__button controls__play" href="#">\n        ' + d((l = n.icon || t && t.icon, c = { hash: {} }, l ? l.call(t, "control-play", "", "controls__icon", c) : h.call(t, "icon", "control-play", "", "controls__icon", c))) + "\n        " + d((l = n.t || t && t.t, c = { hash: {} }, l ? l.call(t, "Play", c) : h.call(t, "t", "Play", c))) + '\n      </a>\n\n      <a class="controls__button controls__pause" href="#">\n        ' + d((l = n.icon || t && t.icon, c = { hash: {} }, l ? l.call(t, "control-pause", "", "controls__icon", c) : h.call(t, "icon", "control-pause", "", "controls__icon", c))) + "\n        " + d((l = n.t || t && t.t, c = { hash: {} }, l ? l.call(t, "Pause", c) : h.call(t, "t", "Pause", c))) + "\n      </a>\n\n      ", a = n["if"].call(t, (a = t && t.options, null == a || a === !1 ? a : a.isSkip), { hash: {}, inverse: p.noop, fn: p.program(1, r, s) }), (a || 0 === a) && (u += a), u += '\n\n      <a class="controls__button controls__volume" href="#">\n        ' + d((l = n.icon || t && t.icon, c = { hash: {} }, l ? l.call(t, "control-volume", "", "controls__icon", c) : h.call(t, "icon", "control-volume", "", "controls__icon", c))) + "\n        " + d((l = n.t || t && t.t, c = { hash: {} }, l ? l.call(t, "Volume", c) : h.call(t, "t", "Volume", c))) + '\n      </a>\n\n      <a class="controls__button controls__button--right controls__fullscreen" href="#">\n        ' + d((l = n.icon || t && t.icon, c = { hash: {} }, l ? l.call(t, "control-fullscreen", "", "controls__icon", c) : h.call(t, "icon", "control-fullscreen", "", "controls__icon", c))) + "\n        " + d((l = n.t || t && t.t, c = { hash: {} }, l ? l.call(t, "FullScreen", c) : h.call(t, "t", "FullScreen", c))) + "\n      </a>\n\n      ", a = n["if"].call(t, (a = t && t.options, null == a || a === !1 ? a : a.isTranscript), { hash: {}, inverse: p.noop, fn: p.program(3, o, s) }), (a || 0 === a) && (u += a), u += '\n\n      <a class="controls__button controls__button--right controls__subtitles" href="#">\n        ' + d((l = n.icon || t && t.icon, c = { hash: {} }, l ? l.call(t, "control-subtitles", "", "controls__icon", c) : h.call(t, "icon", "control-subtitles", "", "controls__icon", c))) + "\n        " + d((l = n.t || t && t.t, c = { hash: {} }, l ? l.call(t, "Subtitles", c) : h.call(t, "t", "Subtitles", c))) + '\n      </a>\n\n      <div class="controls__meta">\n        <div class="controls__detail"></div>\n\n        <div class="controls__meta__credits"></div>\n      </div>\n    </div>\n  </div>\n</div>\n' }); return n }), define("hbs!templates/controlsMini", ["hbs", "hbs/handlebars", "templates/helpers/icon"], function (e, t) { var n = t.template(function (e, t, n) { this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var i, s, r = "", o = n.helperMissing, a = this.escapeExpression; return r += '\n\n<div class="controls controls--mini">\n  <div class="controls__toolbar">\n    <a class="controls__button controls__play" href="#">\n      ' + a((i = n.icon || t && t.icon, s = { hash: {} }, i ? i.call(t, "control-play", "Play", "controls__icon", s) : o.call(t, "icon", "control-play", "Play", "controls__icon", s))) + '\n    </a>\n\n    <a class="controls__button controls__pause" href="#">\n      ' + a((i = n.icon || t && t.icon, s = { hash: {} }, i ? i.call(t, "control-pause", "Pause", "controls__icon", s) : o.call(t, "icon", "control-pause", "Pause", "controls__icon", s))) + '\n    </a>\n\n    <a class="controls__button controls__volume" href="#">\n      ' + a((i = n.icon || t && t.icon, s = { hash: {} }, i ? i.call(t, "control-volume", "Volume", "controls__icon", s) : o.call(t, "icon", "control-volume", "Volume", "controls__icon", s))) + '\n    </a>\n\n    <a class="controls__button controls__button--right controls__fullscreen" href="#">\n      ' + a((i = n.icon || t && t.icon, s = { hash: {} }, i ? i.call(t, "control-fullscreen", "Full screen", "controls__icon", s) : o.call(t, "icon", "control-fullscreen", "Full screen", "controls__icon", s))) + '\n    </a>\n\n    <span class="controls__time controls__time--elapsed">0:00</span>\n    <span class="controls__time controls__time--duration">0:00</span>\n\n    <div class="controls__scrub-wrapper">\n      <div class="controls__scrubber scrubber"></div>\n    </div>\n  </div>\n</div>\n' }); return n }), define("templates/helpers/formatDate", ["Handlebars", "moment"], function (e, t) { "use strict"; e.registerHelper("formatDate", function (e, n) { return t(n || void 0).format(e) }) }), define("hbs!templates/controlsMaxiDetail", ["hbs", "hbs/handlebars", "templates/helpers/t", "templates/helpers/formatDate"], function (e, t) { var n = t.template(function (e, t, n, i, s) { function r(e) { var t, i, s, r = ""; return r += "\n    " + h((i = n.t || e && e.t, s = { hash: {} }, i ? i.call(e, "Playlist:", s) : u.call(e, "t", "Playlist:", s))) + "\n    " + h((i = n.t || e && e.t, s = { hash: {} }, i ? i.call(e, "playing", s) : u.call(e, "t", "playing", s))) + "\n    ", (i = n.index) ? t = i.call(e, { hash: {} }) : (i = e && e.index, t = typeof i === d ? i.call(e, { hash: {} }) : i), r += h(t) + "\n    " + h((i = n.t || e && e.t, s = { hash: {} }, i ? i.call(e, "of", s) : u.call(e, "t", "of", s))) + "\n    ", (i = n.talksCount) ? t = i.call(e, { hash: {} }) : (i = e && e.talksCount, t = typeof i === d ? i.call(e, { hash: {} }) : i), r += h(t) + "\n  " } function o(e) { var t, i, s, r = ""; return r += "\n    " + h((i = n.t || e && e.t, s = { hash: {} }, i ? i.call(e, "Filmed", s) : u.call(e, "t", "Filmed", s))) + "\n    " + h((i = n.formatDate || e && e.formatDate, s = { hash: {} }, i ? i.call(e, "MMMM YYYY", e && e.filmed, s) : u.call(e, "formatDate", "MMMM YYYY", e && e.filmed, s))) + "\n    " + h((i = n.t || e && e.t, s = { hash: {} }, i ? i.call(e, "at", s) : u.call(e, "t", "at", s))) + "\n    ", (i = n.event) ? t = i.call(e, { hash: {} }) : (i = e && e.event, t = typeof i === d ? i.call(e, { hash: {} }) : i), r += h(t) + "\n  " } this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var a, l, c = "", u = n.helperMissing, h = this.escapeExpression, d = "function", p = this; return c += '<div class="controls__meta__details">\n  ', a = n["if"].call(t, t && t.isPlaylist, { hash: {}, inverse: p.program(3, o, s), fn: p.program(1, r, s) }), (a || 0 === a) && (c += a), c += '\n</div>\n<h3 class="controls__meta__title">', (l = n.name) ? a = l.call(t, { hash: {} }) : (l = t && t.name, a = typeof l === d ? l.call(t, { hash: {} }) : l), c += h(a) + "</h3>\n" }); return n }), define("jqueryui/mouse", ["jquery"], function () { return function (e) { var t = !1; e(document).mouseup(function () { t = !1 }), e.widget("ui.mouse", { version: "@VERSION", options: { cancel: "input,textarea,button,select,option", distance: 1, delay: 0 }, _mouseInit: function () { var t = this; this.element.bind("mousedown." + this.widgetName, function (e) { return t._mouseDown(e) }).bind("click." + this.widgetName, function (n) { return !0 === e.data(n.target, t.widgetName + ".preventClickEvent") ? (e.removeData(n.target, t.widgetName + ".preventClickEvent"), n.stopImmediatePropagation(), !1) : void 0 }), this.started = !1 }, _mouseDestroy: function () { this.element.unbind("." + this.widgetName), this._mouseMoveDelegate && e(document).unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate) }, _mouseDown: function (n) { if (!t) { this._mouseStarted && this._mouseUp(n), this._mouseDownEvent = n; var i = this, s = 1 === n.which, r = "string" == typeof this.options.cancel && n.target.nodeName ? e(n.target).closest(this.options.cancel).length : !1; return s && !r && this._mouseCapture(n) ? (this.mouseDelayMet = !this.options.delay, this.mouseDelayMet || (this._mouseDelayTimer = setTimeout(function () { i.mouseDelayMet = !0 }, this.options.delay)), this._mouseDistanceMet(n) && this._mouseDelayMet(n) && (this._mouseStarted = this._mouseStart(n) !== !1, !this._mouseStarted) ? (n.preventDefault(), !0) : (!0 === e.data(n.target, this.widgetName + ".preventClickEvent") && e.removeData(n.target, this.widgetName + ".preventClickEvent"), this._mouseMoveDelegate = function (e) { return i._mouseMove(e) }, this._mouseUpDelegate = function (e) { return i._mouseUp(e) }, e(document).bind("mousemove." + this.widgetName, this._mouseMoveDelegate).bind("mouseup." + this.widgetName, this._mouseUpDelegate), n.preventDefault(), t = !0, !0)) : !0 } }, _mouseMove: function (t) { return e.ui.ie && (!document.documentMode || document.documentMode < 9) && !t.button ? this._mouseUp(t) : this._mouseStarted ? (this._mouseDrag(t), t.preventDefault()) : (this._mouseDistanceMet(t) && this._mouseDelayMet(t) && (this._mouseStarted = this._mouseStart(this._mouseDownEvent, t) !== !1, this._mouseStarted ? this._mouseDrag(t) : this._mouseUp(t)), !this._mouseStarted) }, _mouseUp: function (t) { return e(document).unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate), this._mouseStarted && (this._mouseStarted = !1, t.target === this._mouseDownEvent.target && e.data(t.target, this.widgetName + ".preventClickEvent", !0), this._mouseStop(t)), !1 }, _mouseDistanceMet: function (e) { return Math.max(Math.abs(this._mouseDownEvent.pageX - e.pageX), Math.abs(this._mouseDownEvent.pageY - e.pageY)) >= this.options.distance }, _mouseDelayMet: function () { return this.mouseDelayMet }, _mouseStart: function () { }, _mouseDrag: function () { }, _mouseStop: function () { }, _mouseCapture: function () { return !0 } }) }(jQuery), jQuery }), define("touchPunch", ["jquery"], function () { return function (e) { function t(e, t) { if (!(e.originalEvent.touches.length > 1)) { e.preventDefault(); var n = e.originalEvent.changedTouches[0], i = document.createEvent("MouseEvents"); i.initMouseEvent(t, !0, !0, window, 1, n.screenX, n.screenY, n.clientX, n.clientY, !1, !1, !1, !1, 0, null), e.target.dispatchEvent(i) } } if (e.support.touch = "ontouchend" in document, e.support.touch) { var n, i = e.ui.mouse.prototype, s = i._mouseInit; i._touchStart = function (e) { var i = this; !n && i._mouseCapture(e.originalEvent.changedTouches[0]) && (n = !0, i._touchMoved = !1, t(e, "mouseover"), t(e, "mousemove"), t(e, "mousedown")) }, i._touchMove = function (e) { n && (this._touchMoved = !0, t(e, "mousemove")) }, i._touchEnd = function (e) { n && (t(e, "mouseup"), t(e, "mouseout"), this._touchMoved || t(e, "click"), n = !1) }, i._mouseInit = function () { var t = this; t.element.bind("touchstart", e.proxy(t, "_touchStart")).bind("touchmove", e.proxy(t, "_touchMove")).bind("touchend", e.proxy(t, "_touchEnd")), s.call(t) } } }(jQuery), jQuery }), define("widgets/slider", ["jquery", "jqueryui/widget", "jqueryui/mouse", "touchPunch"], function (e) { "use strict"; return e.widget("ted.slider", e.ui.mouse, { options: { distance: 0, orientation: "horizontal", value: 0, change: null, slide: null, start: null, stop: null }, value: function (e) { return arguments.length && (this.options.value = e, this._refreshValue()), this.options.value }, _change: function (e) { this._trigger("change", e, this._getData({ value: this.value() })) }, _create: function () { this._detectOrientation(), this._mouseInit(), this.progressElement = e("<div class=slider__progress></div>"), this.cursorElement = e("<div class=slider__cursor></div>").appendTo(this.progressElement), this.element.addClass("slider slider--" + this.orientation).append(this.progressElement) }, _detectOrientation: function () { this.orientation = "vertical" === this.options.orientation ? "vertical" : "horizontal" }, _getData: function (e) { return e }, _mouseCapture: function (e) { var t, n; return this.elementSize = { width: this.element.outerWidth(), height: this.element.outerHeight() }, this.elementOffset = this.element.offset(), t = { x: e.pageX, y: e.pageY }, n = this._valueFromPosition(t), this._start(e), this._slide(e, n), !0 }, _mouseDrag: function (e) { var t = { x: e.pageX, y: e.pageY }, n = this._valueFromPosition(t); return this._slide(e, n), !1 }, _mouseStart: function () { return !0 }, _mouseStop: function (e) { return this._mouseDrag(e), this._stop(e), this._change(e), !1 }, _refreshValue: function () { var e = this.value(); this.progressElement.css("vertical" === this.orientation ? "height" : "width", 100 * e + "%") }, _slide: function (e, t) { this._trigger("slide", e, this._getData({ value: t })), this.value(t) }, _start: function (e) { this.element.addClass("slider--active"), this._trigger("start", e) }, _stop: function (e) { this.element.removeClass("slider--active"), this._trigger("stop", e) }, _valueFromPosition: function (e) { var t, n, i; return "vertical" === this.orientation ? (i = this.elementSize.height, n = e.y - this.elementOffset.top) : (i = this.elementSize.width, n = e.x - this.elementOffset.left), t = n / i, t > 1 && (t = 1), 0 > t && (t = 0), "vertical" === this.orientation && (t = 1 - t), t } }), function (t, n) { return e(t).slider(n) } }), define("widgets/scrubber", ["jquery", "lib/ga", "widgets/slider"], function (e, t) { "use strict"; var n = "scrubber", i = n + "--active", s = n + "--hover", r = n + "__cursor", o = n + "__playhead", a = n + "__progress"; return e.widget("ted.scrubber", e.ted.slider, { options: { duration: null, player: null }, _isScrubbing: !1, _isSeeking: !1, _progress: 0, _create: function () { this.options.player && this._setPlayer(), this.playheadElement = e("<div class=" + o + "></div>").prependTo(this.element), this._super(), this.element.addClass(n), this.cursorElement.addClass(r), this.progressElement.addClass(a), this._on(this._handleEvents) }, _getData: function (t) { return e.extend({ cursor: t.value * this.options.duration, playhead: this._progress * this.options.duration, progress: this._progress, duration: this.options.duration }, t) }, _handleEvents: { mouseover: function () { this.element.addClass(s) }, mouseout: function () { this.element.removeClass(s) }, scrubberstart: function () { this.element.addClass(i), this._isScrubbing = !0 }, scrubberstop: function () { this.element.removeClass(i), this._isScrubbing = !1 } }, _setOption: function (e, t) { this._super(e, t), "duration" === e && this.progress(this._getData({ value: this._progress }).playhead / t) }, _setPlayer: function () { var n = this, i = e(this.options.player), s = i.player("talk"); this.option("duration", s.duration), this._on({ scrubberchange: function (e, n) { i.player("seek", n.cursor), t.sendEvent("player", "seek", "scrubber", Math.round(n.cursor)) } }), i.on("playertalk", function (e, t) { n.options.duration = t.duration, n.progress(0) }).on("playerduration", function (e, t) { n.options.duration = t.duration }).on("playerseeking", function () { n._isSeeking = !0 }).on("playerseeked", function () { n._isSeeking = !1 }).on("playerprogress", function (e, t) { n.progress(t.progress) }) }, isSeeking: function (e) { return arguments.length && (this._isSeeking = !!e), this._isScrubbing || this._isSeeking }, progress: function (e) { if (arguments.length) { var t = 100 * e + "%"; this.progressElement && !this.isSeeking() && this.progressElement.width(t), this.playheadElement && this.playheadElement.width(t), this._progress = e, this._trigger("progress", null, this._getData({ value: e })) } return this._progress } }), function (t, n) { return e(t).scrubber(n) } }), define("widgets/volume", ["jquery", "widgets/slider", "widgets/tooltip"], function (e) { "use strict"; var t = "volume", n = t + "--muted", i = t + "-slider", s = i + "--muted", r = i + "__progress"; return e.widget("ted.volume", e.ted.tooltip, { options: { content: "<div class=" + i + ">", interactive: !0, inverse: !0, interactiveTolerance: 1e3, player: null, value: 0 }, sliderElement: null, _create: function () { this._super(), this.element.addClass(t), this.sliderElement = this.popupObject.find("div." + i), this.sliderElement.slider({ orientation: "vertical" }), this.options.player && this._setPlayer(), this._on(this.sliderElement, this._handleSliderEvents), this.sliderElement.find("div.slider__progress").addClass(r) }, _handleEvents: { volumehoverclick: function () { this.mute(!this.mute()) } }, _handleSliderEvents: { sliderchange: function (e, t) { this.closePopup(e), this._trigger("change", e, t) }, sliderslide: function (e, t) { this.openPopup(e), this._trigger("slide", e, t) } }, _setPlayer: function () { var t = this, n = e(this.options.player); this._on({ volumemute: function (e, t) { n.player("mute", t.mute) }, volumechange: function (e, t) { n.player("volume", t.value) }, volumeslide: function (e, t) { n.player("volume", t.value) } }), n.on("playermuted", function (e, n) { t.mute(n.muted) }).on("playervolume", function (e, n) { t.value(n.volume) }), t.mute(n.player("mute")), t.value(n.player("volume")) }, _isMuted: !1, mute: function (e) { if (arguments.length) { if (e = !!e, e === this._isMuted) return; this._isMuted = e; var t = e ? "addClass" : "removeClass"; this.element[t](n), this.sliderElement[t](s), this._trigger("mute", null, { mute: e }) } return this._isMuted }, value: function (e) { return arguments.length && this.sliderElement.slider("value", e), this.sliderElement.slider("value") } }), function (t, n) { return e(t).volume(n) } }), define("hbs!templates/subtitleButton", ["hbs", "hbs/handlebars", "templates/helpers/t"], function (e, t) { var n = t.template(function (e, t, n, i, s) { function r(e) { var t, i, s = ""; return s += '\n      <li class="l3 subtitle-button-menu__item" data-language="', (i = n.languageCode) ? t = i.call(e, { hash: {} }) : (i = e && e.languageCode, t = typeof i === u ? i.call(e, { hash: {} }) : i), s += h(t) + '">\n        <a href="#" class="subtitle-button-menu__link">', (i = n.languageName) ? t = i.call(e, { hash: {} }) : (i = e && e.languageName, t = typeof i === u ? i.call(e, { hash: {} }) : i), s += h(t) + "</a>\n      </li>\n    " } this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var o, a, l, c = "", u = "function", h = this.escapeExpression, d = n.helperMissing, p = this; return c += '\n\n<div class="subtitle-button-menu">\n  <ul class="subtitle-button-menu__list">\n    <li class="subtitle-button-menu__item">\n      <a href="#" class="l3 subtitle-button-menu__link">\n        ' + h((a = n.t || t && t.t, l = { hash: {} }, a ? a.call(t, "Turn off subtitles", l) : d.call(t, "t", "Turn off subtitles", l))) + "\n      </a>\n    </li>\n\n    ", o = n.each.call(t, t && t.languages, { hash: {}, inverse: p.noop, fn: p.program(1, r, s) }), (o || 0 === o) && (c += o), c += "\n  </ul>\n</div>\n" }); return n }), define("widgets/subtitleButton", ["jquery", "hbs!templates/subtitleButton", "widgets/tooltip"], function (e, t) { "use strict"; var n = "subtitle-button", i = n + "-menu", s = i + "__link", r = i + "__item--active"; return e.widget("ted.subtitleButton", e.ted.tooltip, { options: { activeLanguage: !1, languages: [], interactive: !0, inverse: !0, player: null }, _create: function () { var t = this; t._super(), t.element.addClass(n), this.options.player && this._setPlayer(), t.popupObject.on("click", "a." + s, function (n) { n.preventDefault(), t.activateLanguage(e(n.target).closest("li").data("language")) }) }, _setOption: function (e, t) { switch (e) { case "activeLanguage": this.activateLanguage(t); break; case "languages": this.languages(t) } this._super(e, t) }, _setPlayer: function () { var t = this, n = e(this.options.player); this._on({ subtitlebuttonactivatelanguage: function (e, t) { n.player("subtitle", t.languageCode) } }), n.on("playertalk", function (e, n) { t.languages(n.languages) }), t.languages(n.player("talk").languages) }, activateLanguage: function (e) { var t = this.popupObject.find("li[data-language=" + e + "]"); t.siblings().removeClass(r), t.addClass(r), this._trigger("activateLanguage", null, { languageCode: e }) }, languages: function (e) { return e && this.option("content", t({ languages: e })), this.option("languages") } }), function (t, n) { return e(t).subtitleButton(n) } }), define("hbs!templates/subtitleCredits", ["hbs", "hbs/handlebars", "templates/helpers/t"], function (e, t) { var n = t.template(function (e, t, n, i, s) { function r(e) { var t, i, s = ""; return s += "\n    " + m((t = n.t || e && e.t, i = { hash: {} }, t ? t.call(e, "transcript", i) : f.call(e, "t", "transcript", i))) + "\n  " } function o(e) { var t, i, s = ""; return s += "\n    " + m((t = n.t || e && e.t, i = { hash: {} }, t ? t.call(e, "translation", i) : f.call(e, "t", "translation", i))) + "\n  " } function a(e, t) { var i, s, r, o = ""; return o += "\n    " + m((s = n.t || e && e.t, r = { hash: {} }, s ? s.call(e, "by", r) : f.call(e, "t", "by", r))) + '\n    <a href="', (s = n.translatorUri) ? i = s.call(e, { hash: {} }) : (s = e && e.translatorUri, i = typeof s === g ? s.call(e, { hash: {} }) : s), o += m(i) + '" target="_blank">', (s = n.translatorName) ? i = s.call(e, { hash: {} }) : (s = e && e.translatorName, i = typeof s === g ? s.call(e, { hash: {} }) : s), o += m(i) + "</a>", i = n["if"].call(e, e && e.translatorName, { hash: {}, inverse: v.noop, fn: v.program(6, l, t) }), (i || 0 === i) && (o += i), o += "\n  " } function l() { return "," } function c(e) { var t, i, s, r = ""; return r += "\n    " + m((i = n.t || e && e.t, s = { hash: {} }, i ? i.call(e, "reviewed by", s) : f.call(e, "t", "reviewed by", s))) + '\n    <a href="', (i = n.reviewerUri) ? t = i.call(e, { hash: {} }) : (i = e && e.reviewerUri, t = typeof i === g ? i.call(e, { hash: {} }) : i), r += m(t) + '" target="_blank">', (i = n.reviewerName) ? t = i.call(e, { hash: {} }) : (i = e && e.reviewerName, t = typeof i === g ? i.call(e, { hash: {} }) : i), r += m(t) + "</a>.\n  " } this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var u, h, d, p = "", f = n.helperMissing, m = this.escapeExpression, g = "function", v = this; return p += "\n\n<div>\n  ", (h = n.languageName) ? u = h.call(t, { hash: {} }) : (h = t && t.languageName, u = typeof h === g ? h.call(t, { hash: {} }) : h), p += m(u) + "\n\n  ", u = n["if"].call(t, t && t.isTranscript, { hash: {}, inverse: v.program(3, o, s), fn: v.program(1, r, s) }), (u || 0 === u) && (p += u), p += "\n\n  ", u = n["if"].call(t, t && t.translatorName, { hash: {}, inverse: v.noop, fn: v.program(5, a, s) }), (u || 0 === u) && (p += u), p += "\n\n  ", u = n["if"].call(t, t && t.reviewerName, { hash: {}, inverse: v.noop, fn: v.program(8, c, s) }), (u || 0 === u) && (p += u), p += '\n\n  <a class="l3" href="/talks/browse?language=', (h = n.languageCode) ? u = h.call(t, { hash: {} }) : (h = t && t.languageCode, u = typeof h === g ? h.call(t, { hash: {} }) : h), p += m(u) + '" target="_blank">' + m((h = n.t || t && t.t, d = { hash: {} }, h ? h.call(t, "More talks in", d) : f.call(t, "t", "More talks in", d))) + " ", (h = n.languageName) ? u = h.call(t, { hash: {} }) : (h = t && t.languageName, u = typeof h === g ? h.call(t, { hash: {} }) : h), p += m(u) + "</a>\n</div>\n" }); return n }), define("widgets/subtitleCredits", ["jquery", "lodash", "hbs!templates/subtitleCredits"], function (e, t, n) { "use strict"; var i = "subtitle-credits", s = i + "--visible"; return e.widget("ted.subtitleCredits", { options: { activeLanguage: !1, player: null, talkSlug: null }, _create: function () { this.element.addClass(i), this.options.player && this._setPlayer() }, _setPlayer: function () { var e = this, t = e.options.player; this._on(e.options.player, { playersubtitle: function (t, n) { e.activateLanguage(n.subtitle ? n.subtitle.languageCode : !1) }, playertalk: function (t, n) { e.option("talkSlug", n.slug) } }), e._setOption("talkSlug", t.player("talk").slug); var n = t.player("subtitle"); e.activateLanguage(n ? n.languageCode : !1) }, _setOption: function (e, t) { this._super(e, t), ("talkSlug" === e || "activeLanguage" === e) && this.activateLanguage(this.options.activeLanguage) }, activateLanguage: function (n) { n && this.options.talkSlug ? (this.options.activeLanguage = n, e.get("/talks/" + this.options.talkSlug + "/caption_credits", { lang: n }).then(t.bind(this.setSubtitleData, this), t.bind(this.hide, this))) : this.hide(), this._trigger("activateLanguage", null, { languageCode: n }) }, setSubtitleData: function (e) { return e.translatorName || e.reviewerName ? (e.isTranscript = e.languageCode === this.options.player.player("talk").nativeLanguage, this.element.html(n(e)), void this.show()) : this.hide() }, hide: function () { this._trigger("hide"), this.element.removeClass(s) }, show: function () { this._trigger("show"), this.element.addClass(s) } }), function (t, n) { return e(t).subtitleCredits(n) } }), define("widgets/hover", ["jquery", "lodash", "jqueryui/widget"], function (e, t) {
        "use strict"; function n(e, t, n) { return Math.abs(e[0] - t[0]) > n || Math.abs(e[1] - t[1]) > n } function i(e) { e._hoverIsTouchTriggered = !1 } var s = e(document); e.widget("ted.hover", {
            options: { hoverIdleDelay: 4e3, hoverStartDelay: 200, hoverStopDelay: 400, hoverSwipeTolerance: 5 }, hoverState: function (e) { return t.isUndefined(e) || this._hoverChangeState(null, !!e), this._hoverIsOn }, _hoverIsClicking: !1, _hoverIsOn: !1, _hoverIsTouchTriggered: !1, _hoverLastCoords: null, _hoverStartTimeout: null, _hoverIdleTimeout: null, _hoverStopTimeout: null, _hoverChangeStateBound: null, _hoverMoveChangeBound: null, _hoverMouseMoveThrottled: null, _hoverTouchOutBound: null, _create: function () { this._hoverInit() }, _hoverEvents: function () { return { mouseenter: this._hoverMouseMoveThrottled, mousemove: this._hoverMouseMoveThrottled, mouseleave: this._hoverOut, touchstart: this._hoverTouchStart, touchend: this._hoverTouchEnd, touchmove: this._hoverTouchMove, touchcancel: this._hoverTouchCancel, mousedown: this._hoverMouseDown, mouseup: this._hoverMouseUp, click: this._hoverMouseClick } }, _hoverMove: function (e) {
                this._hoverIsOn ? this._hoverMoveChange(e) : this._hoverStartSetTimeout(e)
            }, _hoverMoveChange: function (e) { var t = { x: e.pageX || null, y: e.pageY || null }; "mousedown" !== e.type && "touchstart" !== e.type && this._hoverLastCoords && t.x && t.x === this._hoverLastCoords.x && t.y === this._hoverLastCoords.y || (this._hoverLastCoords = t, this._hoverChangeState(e, !0), this._hoverIdleSetTimeout(e)) }, _hoverOut: function (e) { this._hoverStartClearTimeout(), this._hoverStopSetTimeout(e) }, _hoverMouseClick: function (e) { this._hoverIsTouchTriggered || this._hoverIsOn && this._trigger("tap", e) }, _hoverMouseDown: function () { this._hoverIsTouchTriggered || (this._hoverIsClicking = !0, this._hoverIdleClearTimeout()) }, _hoverMouseMove: function (e) { this._hoverIsTouchTriggered || this._hoverMove(e) }, _hoverMouseUp: function (e) { this._hoverIsTouchTriggered || (this._hoverIsClicking = !1, this._hoverIdleSetTimeout(e)) }, _hoverTouchStart: function () { this._hoverIsTouchTriggered = !0, this._hoverTouchStartCoords = null, this._hoverTouchEndCoords = null }, _hoverTouchEnd: function (e) { this._hoverTouchSafetyTimeout && window.clearTimeout(this._hoverTouchSafetyTimeout), this._hoverTouchSafetyTimeout = t.delay(i, 600, this), this._hoverTouchEndCoords && n(this._hoverTouchStartCoords, this._hoverTouchEndCoords, this.options.hoverSwipeTolerance) || (this._hoverIsOn && this._trigger("tap", e), this._hoverMoveChange(e)) }, _hoverTouchCancel: function (e) { e.preventDefault() }, _hoverTouchMove: function (e) { var t = e.originalEvent.touches[0], n = [t.pageX, t.pageY]; null === this._hoverTouchStartCoords ? this._hoverTouchStartCoords = n : this._hoverTouchEndCoords = n, this._hoverIsOn && this._hoverMove(e) }, _hoverTouchOut: function (t) { e(t.target).closest(this.element).length || this._hoverChangeState(t, !1) }, _hoverChangeState: function (e, t) { t = !!t, this._hoverIdleClearTimeout(), this._hoverStartClearTimeout(), this._hoverStopClearTimeout(), (t || !this._hoverIsClicking) && t !== this._hoverIsOn && (this._hoverIsOn = t, this[t ? "_hoverStart" : "_hoverStop"](e), t ? this._on(s, { touchstart: this._hoverTouchOutBound }) : this._off(s, "touchstart")) }, _hoverStartSetTimeout: function (e) { this._hoverStartTimeout || (this._hoverStartTimeout = t.delay(this._hoverMoveChangeBound, this.options.hoverStartDelay, e)) }, _hoverStartClearTimeout: function () { this._hoverStartTimeout && (window.clearTimeout(this._hoverStartTimeout), this._hoverStartTimeout = null) }, _hoverStopSetTimeout: function (e) { this._hoverStopClearTimeout(), this._hoverStopTimeout = t.delay(this._hoverChangeStateBound, this.options.hoverStopDelay, e, !1) }, _hoverStopClearTimeout: function () { this._hoverStopTimeout && (window.clearTimeout(this._hoverStopTimeout), this._hoverStopTimeout = null) }, _hoverIdleSetTimeout: function (e) { this._hoverIdleClearTimeout(), !this._hoverIsClicking && this.options.hoverIdleDelay && (this._hoverIdleTimeout = t.delay(this._hoverChangeStateBound, this.options.hoverIdleDelay, e, !1)) }, _hoverIdleClearTimeout: function () { this._hoverIdleTimeout && (window.clearTimeout(this._hoverIdleTimeout), this._hoverIdleTimeout = null) }, _hoverInit: function () { this._hoverChangeStateBound = t.bind(this._hoverChangeState, this), this._hoverMoveChangeBound = t.bind(this._hoverMoveChange, this), this._hoverTouchOutBound = t.bind(this._hoverTouchOut, this), this._hoverMouseMoveThrottled = t.throttle(t.bind(this._hoverMouseMove, this), 100, { leading: !0, trailing: !1 }), this._on(this._hoverEvents()) }, _hoverDestroy: function () { this._off(this._hoverEvents()) }, _hoverStart: function (e) { this._trigger("start", e) }, _hoverStop: function (e) { this._trigger("stop", e) }
        })
    }), define("widgets/controls", ["jquery", "lodash", "utils/formatDuration", "hbs!templates/controlsMaxi", "hbs!templates/controlsMini", "hbs!templates/controlsMaxiDetail", "widgets/scrubber", "widgets/volume", "widgets/subtitleButton", "widgets/subtitleCredits", "widgets/hover"], function (e, t, n, i, s, r) { "use strict"; function o(e, t) { return function (n) { e.call(t, n) !== !1 && n.preventDefault() } } function a(e) { return e = t.clone(e), e.filmed && (e.filmed *= 1e3), (e.index || 0 === e.index) && (e.index += 1), e } var l = "controls", c = l + "--fullscreen", u = l + "--with-credits", h = l + "--no-languages", d = l + "--hover", p = l + "--playing", f = l + "--paused", m = l + "--unskipable", g = l + "__detail", v = { maxi: i, mini: s }; return e.widget("ted.controls", e.ted.hover, { options: { hover: !0, hoverStopDelay: 3e3, player: null, template: "maxi" }, _create: function () { var i = this, s = this.options.template; s = this.options.template = v[s] || s; var r = e(s({ options: this.options })).filter("div." + l); this.element.addClass(r.attr("class")).html(r.html()); var a = {}; t.forOwn(this._buttonHandlers, function (e, t) { a["click a." + l + "__" + t] = o(e, i) }), this._on(a); var c = this.element.find("span.controls__time--elapsed"), h = this.element.find("span.controls__time--duration"); i.scrubber = this.element.find("div.controls__scrubber").scrubber({ player: this.options.player, progress: function (e, t) { i.scrubber && !i.scrubber.scrubber("isSeeking") && c.text(n(t.playhead)), h.text(n(t.duration)) }, slide: function (e, t) { i.scrubber && i.scrubber.scrubber("isSeeking") && c.text(n(t.cursor)) } }), this.volume = this.element.find("a.controls__volume").volume({ player: this.options.player }), this.subtitles = this.element.find("a.controls__subtitles").subtitleButton({ player: this.options.player }), this.credits = this.element.find("div.controls__meta__credits"), this.credits.length && this.credits.subtitleCredits({ player: this.options.player }), this.details = this.element.find("div." + g), this._on(this.credits, { subtitlecreditsshow: function () { i.element.addClass(u) }, subtitlecreditshide: function () { i.element.removeClass(u) } }), this.options.player.on("playerplay", t.bind(this._onPlay, this)), this.options.player.on("playerpause", t.bind(this._onPause, this)), this.options.player.on("playercomplete", t.bind(this._onPause, this)), this.options.player.on("playertalk", t.bind(this._onTalk, this)), this.options.player.on("playerenterfullscreen", t.bind(this._onEnterFullScreen, this)), this.options.player.on("playerexitfullscreen", t.bind(this._onExitFullScreen, this)), this._onTalk(), this.options.player.player("canFullScreen") && this.element.addClass(l + "--can-fullscreen"), "flash" === this.options.player.player("mode") && this.element.addClass(l + "--can-subtitle " + l + "--can-volume"), this.options.player.on("touchstart", function (e) { i._hoverMove(e) }), this.options.hover && this._hoverInit() }, _buttonHandlers: { play: function () { this.options.player.player("play") }, pause: function () { this.options.player.player("pause") }, fullscreen: function () { this.options.player.player("toggleFullScreen") }, skip: function () { this.options.player.player("playNext") } }, _hoverStart: function () { this.element.addClass(d) }, _hoverStop: function () { this.element.removeClass(d) }, _onEnterFullScreen: function () { this.element.addClass(c) }, _onExitFullScreen: function () { this.element.removeClass(c) }, _onPlay: function () { this.element.addClass(p).removeClass(f) }, _onPause: function () { this.element.addClass(f).removeClass(p) }, _onTalk: function () { var e = this.options.player.player("talk"), n = this.options.player.player("talks").length, i = e.index >= n - 1; this.element[e.languages.length ? "removeClass" : "addClass"](h), this.details.length && this.details.html(r(t.extend(a(e), { isPlaylist: n > 1, talksCount: n }))), this.element[i ? "addClass" : "removeClass"](m) } }), function (t, n) { return e(t).controls(n) } }), define("player/throwError", [], function () { "use strict"; return function (e) { throw new Error("Error in TED Player Wrapper: " + e) } }), define("player/topicFactory", ["jquery", "./throwError"], function (e, t) { "use strict"; function n(t, i, s) { var r, o; for (r = 0, o = i.length; o > r; r++) e.isArray(i[r]) ? n(t, i[r], s) : i[r].apply(t, s) } return function (i) { var s = {}; return function (r) { var o, a = r && s[r]; return a || (o = e.Callbacks(i && i.hasOwnProperty(r) ? i[r] : "memory"), a = { publish: o.fire, subscribe: o.add, unsubscribe: o.remove, once: function () { function e() { n(o, t, arguments), o.remove(e) } var t = arguments; return o.add(e) }, publishUnique: function () { var e; return window.JSON ? function () { var t = Array.prototype.slice.call(arguments, 0), n = JSON.stringify(t); n !== e && (o.fire.apply(o, t), e = n) } : (t("JSON object not available. You may need to shim it on this client."), !1) }() }, r && (s[r] = a)), a } } }), define("player/getFlashVars", ["jquery", "./throwError"], function (e, t) { "use strict"; function n() { var e = { LanguageCode: "en", OldLanguageCode: "eng", Name: "English", Description: null, CommunityUrl: null, TranslationCount: 1291, DotsubOnly: !1, CreatedAt: "2009-05-12 22:17:26", UpdatedAt: "2012-12-12 06:07:02", IsRtl: !1, Iso6391: "en", Iso6393: "eng", HostnamePrefix: null }; return e } function i(e) { var t = { ignoreCompanionAd: !1, openLinksInNewWindow: !1, metricsServiceName: "ted_player", metricsApiKey: e.talks.length > 1 ? "playlist_page_2" : "talk_page_2" }; return t } function s(t) { for (var n, i, s = [], r = -1, o = t.talks.length; ++r < o;) n = t.talks[r], s.push({ talkId: n.id, duration: n.duration, nativeLanguage: n.nativeLanguage, adUrl: n.adUrl, introDuration: n.introDuration, adDuration: n.adDuration, isSubtitleRequired: n.isSubtitleRequired, streamer: n.streamer, resource: n.resources.rtmp }); return i = { id: 0, talks: s }, e.extend(i, t.flashVars), i } function r(e) { var t = []; for (var n in e) e.hasOwnProperty(n) && t.push(n + "=" + encodeURIComponent(e[n])); return t.join("&") } function o(e) { return window.JSON || t("JSON object not available. You may need to shim it on this client."), e = JSON.stringify(e) } return function (e) { var t = e.options; return r({ serviceHost: "", playerZone: o(i(t)), initialPlaylistIndex: 0, shareToken: t.shareToken || "", language: o(n(t)), playlist: o(s(t)), fullscreenEnabled: e.canFullScreen ? 0 : 1 }) } }), define("player/handleError", ["jquery"], function (e) { "use strict"; return function (t) { e.post("/error_collector.php", { message: t }) } }), define("player/hlsVastParser", ["jquery", "./topicFactory", "./handleError"], function (e, t, n) { "use strict"; function i(e) { this.vast = e, this.topic = t({ companion: void 0 }), this.loadCompanions() } function s(e) { this.vastData = e, this.url = this.vastData.find("IFrameResource").text() } e.extend(i.prototype, { loadCompanions: function () { var e = this; this.preroll = new s(this.vast.find("Companion[width=6][height=7]")), this.companion = new s(this.vast.find("Companion[width=6][height=8]")), this.companion.load(function (t) { t && e.topic("companion").publish(t) }) }, sponsor: function () { var e = {}, t = this.vast.find("AdParameters").text().split("="); return e[t[0]] = t[1], e }, prerollUrl: function () { return [this.preroll.url] }, impressionUrl: function () { return [this.vast.find("Impression").text()] }, clickUrl: function () { return this.vast.find("ClickThrough").text() } }); var r = ["start", "firstQuartile", "midpoint", "thirdQuartile", "complete", "mute", "unmute", "rewind", "pause", "resume", "fullscreen", "creativeView"]; return r.forEach && r.forEach(function (t) { i.prototype[t + "Url"] = function () { return e.makeArray(this.vast.find("Linear Tracking[event=" + t + "]").map(function (t, n) { return e(n).text() })) } }), e.extend(s.prototype, { load: function (t) { var i = this; return "" == this.url ? t() : void e.getJSON(this.url).done(function (e) { i.ad = { type: "companion-mobile", dimensions: { width: 320, height: 50 }, hasDisplay: !0, houseAd: !1, creative: [{ density: 1, url: e.companion.creative.standard }, { density: 2, url: e.companion.creative.standard_2x }], impression: null, thirdPartyImpressions: e.companion.impression, click: e.companion.click, lineItemId: null, creativeId: null }, t(i.ad) }).fail(function (e, t) { n({ context: "hls", error: "Error retrieving companion ad", status: t, url: i.url }) }) } }), i }), define("player/hlsInitTalk", ["jquery", "./hlsVastParser", "./handleError"], function (e, t, n) { "use strict"; function i(n) { var i = new e.Deferred, s = i.promise(); return e.get(n).then(function (n) { i.resolve(new t(e(n))) }, function (e, t, n) { i.reject(t, n) }), s } return function (t, s) { var r = new e.Deferred, o = r.promise(), a = t.currentTalk.resources.hls.stream, l = {}; return i(t.currentTalk.resources.hls.adUrl).done(function (n) { t.vastAd = n, e.extend(l, n.sponsor()) }).fail(function (e) { n({ context: "hls", error: "Error retrieving VAST ad", status: e, url: t.currentTalk.resources.hls.adUrl }) }).always(function () { s.attr("src", a + "?" + e.param(l)), r.resolve() }), o } }), define("player/replaceElement", ["jquery", "./getFlashVars", "./throwError", "./hlsVastParser", "./hlsInitTalk", "swfobject"], function (e, t, n, i, s) { "use strict"; function r(e) { return e.id || (e.id = "ted-player-" + c++), e.id } function o(e) { var n = { bgcolor: "#000000", quality: "high", wmode: "opaque", allowscriptaccess: "always", allowfullscreen: "true" }, i = e.options, s = r(i.el); if ("OBJECT" !== i.el.nodeName) { var o = t(e), a = i.attrs; n.flashvars = o, a.data = i.swf, swfobject.createSWF(a, n, s) } e.el = document.getElementById(s), e.topic("ready.dom").publish() } function a(t) { var n, i = t.options, s = e("<video>"); t.currentTalk = i.talks[0], n = t.currentTalk.resources.h264[0].file + "&service=ted_player_html5", s.attr(i.attrs), t.options.shareToken && (n = n + "&share_token=" + t.options.shareToken), s.attr("preload", "none"), s.attr("src", n), e(i.el).replaceWith(s), t.el = s[0], t.topic("ready.dom").publish() } function l(t) { var n = t.options, i = e("<video>"); t.currentTalk = n.talks[0], i.attr(n.attrs), s(t, i).always(function () { e(n.el).replaceWith(i), t.el = i[0], t.topic("ready.dom").publish() }) } var c = Math.floor(9999 * Math.random()), u = { flash: o, h264: a, hls: l }; return function (e) { return u[e.mode] || n("unknown mode: " + e.mode), u[e.mode](e) } }), define("player/getSupportedMode", ["jquery", "swfobject"], function (e) { "use strict"; function t(e) { return n.canPlayType(e).replace(/^no$/, "") } var n = document.createElement("video"), i = ["flash", "h264", "hls"]; return function (s) { var r = navigator.userAgent.toLowerCase(), o = r.indexOf("windows nt") > -1 && r.indexOf("; arm;") > -1; if (s.mode && -1 !== e.inArray(s.mode, i)) return s.mode; if (!o && -1 === r.indexOf("android") && swfobject.hasFlashPlayerVersion(s.flashVersion)) return "flash"; try { if (!n.canPlayType) return !1; if (-1 === navigator.userAgent.toLowerCase().indexOf("android") && (t("application/vnd.apple.mpegURL") || t("application/x-mpegURL"))) return "hls"; if (t('video/mp4; codecs="avc1.42E01E"')) return "h264" } catch (a) { } return !1 } }), define("player/checkRequiredParams", ["./throwError"], function (e) { "use strict"; var t = ["el", "talks"]; return function (n) { for (var i = !0, s = t.length; s--;) n[t[s]] || (e("required param missing: " + t[s]), i = !1); return i } }), define("player/throttle", ["jquery"], function (e) { "use strict"; return function (t, n, i, s) { var r, o = 0; "boolean" != typeof n && (s = i, i = n, n = void 0); var a = function () { function e() { o = +new Date, i.apply(l, u) } function a() { r = void 0 } var l = this, c = +new Date - o, u = arguments; s && !r && e(), r && clearTimeout(r), void 0 === s && c > t ? e() : n !== !0 && (r = setTimeout(s ? a : e, void 0 === s ? t - c : t)) }; return e.guid && (a.guid = i.guid = i.guid || e.guid++), a } }), define("player/log", [], function () { "use strict"; var e = function () { e.enabled && window.console && console.log(Array.prototype.slice.call(arguments)) }; return e.enabled = !1, e }), define("player/getTalk", [], function () { "use strict"; return function (e, t, n) { var i, s = e.options.talks, r = s.length; for (n || (n = 0), t = +t; r--;) if (i = s[r], i.id === t) return s[r + n] } }), define("player/getLanguage", [], function () { "use strict"; return function (e, t) { if (!e.languages || !t) return !1; for (var n = e.languages.length; n--;) if (e.languages[n].languageCode === t) return e.languages[n]; return !1 } }), define("player/isLastTalk", [], function () { "use strict"; return function (e) { return e.currentTalk.id === e.options.talks[e.options.talks.length - 1].id } }), define("player/addHandlersFlash", ["./throttle", "./log", "./getTalk", "./getLanguage", "./isLastTalk"], function (e, t, n, i) { "use strict"; var s = e(100, function (e, t) { e("currentTime").publishUnique(t) }); return function (e) { function r(r, u) { switch (r = r.replace(/^player\./, "")) { case "idle": case "pause": case "seeked": case "seeking": a(r).publish(); break; case "play": a("ready.seekable").publish(), a("play").publish(); break; case "complete": a("complete").publish(e.currentTalk); break; case "playlist.complete": o = !0, a("ended").publish(e.currentTalk); break; case "ready": a("ready.handlers").publish(); break; case "talk": var h = n(e, u.talkId), d = e.config.get("languageCode"), p = i(h, d); e.currentTalk = h, a("talk").publishUnique(h), p || h.nativeLanguage === e.options.nativeLanguage || (p = i(h, e.options.nativeLanguage)), p ? (e.el.setLanguage(p.languageCode, p.isRtl), a("subtitle").publishUnique(p)) : e.el.setLanguage(null, null); break; case "timeupdate": s(a, u.time); break; case "metadata": a("duration").publishUnique(u.duration); break; case "volumechange": var f = Math.round(1e3 * +u.volume) / 1e3; (f > 0 || !l) && a("volume").publishUnique(f); break; case "ad": a("ad").publish(u.ad); break; case "ad.preroll.start": a("prerollStart").publish(); break; case "ad.preroll.block": a("prerollBlock").publish(); break; case "ad.postroll.start": a("postrollStart").publish(); break; case "ad.postroll.end": a("postrollComplete").publish(); break; case "ad.block": a("adBlock").publish(); break; case "buffer.empty": o || a("bufferUnplayable").publish(); break; case "buffer.full": a("bufferPlayable").publish(); break; case "mouse.down": e.postrolling ? a("postrollClick").publish() : e.toggle(); break; case "metrics": u.bitrate = c, a("metricsData").publish(u); break; case "metrics.toggle": a("metricsToggle").publish(); break; case "stream.switched": c = parseInt(u.resource.bitrate); break; case "outro": a("outro").publish(u); break; default: t("Unhandled event: " + r) } } var o, a = e.topic, l = e.config.get("muted"), c = 0; a("muted").subscribe(function (e) { l = e }), window.onPlayerEvent = function (e, t) { try { r(e, t) } catch (n) { if (!n) return; window.Airbrake && window.Airbrake.push({ error: n }), console && console.error && console.error(n.message, n.stack) } }; var u = e.options.history, h = []; if (u && u.length) for (var d = -1, p = u.length; ++d < p;) window.onPlayerEvent.apply(h.slice.apply(u[d])) } }), define("player/addHandlersH264", ["jquery", "./throttle", "./isLastTalk"], function (e, t, n) { "use strict"; return function (i) { var s = i.topic, r = i.el, o = e(r); e.each(["play", "pause", "seeked", "seeking"], function (e, t) { o.on(t, function () { s(t).publish() }) }), o.on("canplay", function () { var e; return function () { e && r.play(), e = !0 } }()), o.on("timeupdate", t(100, function () { s("currentTime").publishUnique(r.currentTime) })), o.on("durationchange", function () { s("duration").publishUnique(r.duration) }), o.on("ended", function () { s("complete").publishUnique(i.currentTalk), n(i) ? s("ended").publish(i.currentTalk) : i.playNext() }), o.on("volumechange", function () { s("volume").publishUnique(Math.round(1e3 * +r.volume) / 1e3), s("muted").publishUnique(r.muted) }), o.on("loadedmetadata", function () { s("ready.seekable").publish() }) } }), define("player/addHandlersHls", ["jquery", "./handleError"], function (e, t) { "use strict"; var n = function (e) { var t = new Image; t.src = e }, i = function (e) { var t = e.topic, n = e.currentTalk.id, i = s(e); t("talk").subscribe(function (t) { n != t.id && (i && i(), i = s(e)) }) }, s = function (i) { function s(t) { function i(e) { var e = Math.floor(e), t = Object.keys(a).filter(function (t) { return a[t].time == e }); t.forEach(s) } function s(e) { switch (e = a[e], e.fired !== !0 && (e.url.forEach(n), e.fired = !0, "string" == typeof e.topic && r(e.topic).publish()), e.type) { case "start": s(a.main.type); break; case "firstQuartile": s(a.creativeView.type), s(a.start.type); break; case "midpoint": s(a.firstQuartile.type); break; case "thirdQuartile": s(a.midpoint.type); break; case "complete": s(a.thirdQuartile.type) } } var a = { main: { type: "main", time: Math.floor(t.outro.end) - 1, url: o.impressionUrl() }, preroll: { type: "preroll", time: 8, url: o.prerollUrl(), topic: "prerollStart" } }; return t.ad && e.extend(a, { start: { type: "start", time: Math.floor(t.ad.start), url: o.startUrl(), topic: "postrollStart" }, creativeView: { type: "creativeView", time: Math.floor(t.ad.start), url: o.creativeViewUrl() }, firstQuartile: { type: "firstQuartile", time: Math.floor(t.ad.start + (t.ad.end - t.ad.start) / 4), url: o.firstQuartileUrl() }, midpoint: { type: "midpoint", time: Math.floor(t.ad.start + (t.ad.end - t.ad.start) / 2), url: o.midpointUrl() }, thirdQuartile: { type: "thirdQuartile", time: Math.floor(t.ad.start + 3 * (t.ad.end - t.ad.start) / 4), url: o.thirdQuartileUrl() }, complete: { type: "complete", time: Math.floor(t.ad.end) - 1, url: o.completeUrl(), topic: "postrollComplete" } }), r("currentTime").subscribe(i), function () { r("currentTime").unsubscribe(i) } } var r = i.topic, o = i.vastAd, a = i.currentTalk.resources.hls.metadata; o.topic("companion").subscribe(function (e) { r("ad").publish(e) }), e.getJSON(a, o.sponsor()).then(function (e) { s(e.timing) }).fail(function (e, n) { t({ context: "hls", error: "Error retrieving HLS metadata", status: n, uri: a, query: o.sponsor() }) }) }; return function (n) { var s = n.el; e(s).on("error", function () { t({ context: "hls", error: "Error playing video", currentTime: s.currentTime, src: s.src, code: s.error ? s.error.code : void 0 }) }), i(n) } }), define("player/addHandlers", ["./throwError", "./throttle", "./addHandlersFlash", "./addHandlersH264", "./addHandlersHls"], function (e, t, n, i, s) { "use strict"; function r(e) { var n, i, s = t(100, function () { n && i && e("progress").publishUnique(n / i) }); e("currentTime").subscribe(function (e) { n = e, s() }), e("duration").subscribe(function (e) { i = e, s() }), e("progress").publish(0) } return function (t) { var o = t.mode, a = t.topic; switch (o) { case "flash": n(t); break; case "h264": i(t); break; case "hls": i(t), s(t); break; default: e("unkown mode for handlers: " + o) } "flash" !== o && a("ready.handlers").publish(), a("duration").publish(t.options.talks[0].duration), r(a), a("postrollStart").subscribe(function () { t.postrolling = !0 }), a("postrollComplete").subscribe(function () { t.postrolling = !1 }), a("talk").subscribe(function () { t.postrolling = !1 }) } }), define("player/actionsFlash", ["jquery", "./getLanguage", "./throwError"], function (e, t, n) { "use strict"; var i = {}; return e.each({ play: "playVideo", playNext: "playNext", playPrev: "playPrev", playTalk: "playTalk", pause: "pauseVideo", seek: "seek", ignoreContainerSize: "ignoreContainerSize" }, function (e, t) { i[e] = function () { var e = this.el[t]; e ? e.apply(this.el, [].slice.call(arguments)) : n("Flash method not found: " + t) } }), i.mute = function (e) { e = !!e, this.el.volume(e ? 0 : this.config.get("volume")), this.topic("muted").publishUnique(e) }, i.subtitle = function (e) { var n = t(this.currentTalk, e); n ? this.el.setLanguage(n.languageCode, n.isRtl) : this.el.setLanguage(null, null), this.config.set("languageCode", n ? n.languageCode : !1), this.topic("subtitle").publishUnique(n) }, i.volume = function (e) { this.el.volume(e), this.topic("volume").publishUnique(e) }, e.each(["play", "playNext", "playPrev", "playTalk", "seek"], function (e, t) { var n = i[t]; i[t] = function () { this.topic("bufferUnplayable").publish(), n.apply(this, arguments) } }), i }), define("player/actionsH264", ["jquery", "./getTalk"], function (e, t) { "use strict"; var n = {}; return n.play = function () { this.topic("talk").publishUnique(this.currentTalk), this.el.play() }, n.pause = function () { this.el.pause() }, n.playTalk = function (e) { var n = t(this, e); n && (this.currentTalk = n, this.topic("talk").publishUnique(n), this.el.src = n.resources.h264[0].file) }, n.playNext = function () { var e = t(this, this.currentTalk.id, 1); e && this.playTalk(e.id) }, n.playPrev = function () { var e = t(this, this.currentTalk.id, -1); e && this.playTalk(e.id) }, n.mute = function (e) { this.el.muted = !!e }, n.seek = function (e) { this.el.currentTime = e }, n.volume = function (e) { this.el.volume = e }, n }), define("player/actionsHls", ["jquery", "./getTalk", "./hlsInitTalk"], function (e, t, n) { "use strict"; var i = {}; return i.play = function () { this.topic("talk").publishUnique(this.currentTalk), this.el.play() }, i.pause = function () { this.el.pause() }, i.playTalk = function (i) { var s = t(this, i), r = this.topic; s && this.currentTalk != s ? (this.currentTalk = s, n(this, e(this.el)).always(function () { r("talk").publishUnique(s) })) : this.play() }, i.playNext = function () { var e = t(this, this.currentTalk.id, 1); e && this.playTalk(e.id) }, i.playPrev = function () { var e = t(this, this.currentTalk.id, -1); e && this.playTalk(e.id) }, i.mute = function (e) { this.el.muted = !!e }, i.seek = function (e) { this.el.currentTime = e }, i.volume = function (e) { this.el.volume = e }, i }), define("player/getFullScreenActions", ["jquery", "./throwError"], function (e, t) { "use strict"; function n(t) { function n() { t.topic("enterFullScreen").publish(), t.isFullScreen = !0 } function i() { t.topic("exitFullScreen").publish(), t.isFullScreen = !1 } var s = document, r = t.fullScreenMode, a = o[r]; "webkitVideo" === r ? (e(t.el).on("webkitbeginfullscreen", n), e(t.el).on("webkitendfullscreen", i)) : a && e(s).on(a.change, function () { s[a.element] === t.fullScreenElement ? n() : !s[a.element] && t.isFullScreen && i() }) } function i(e) { function t() { n.webkitEnterFullscreen() } var n = e.el; n.readyState >= 1 ? t(e) : (n.addEventListener("loadedmetadata", t, !1), e.play()) } function s(e) { var t = e.fullScreenMode, n = window.document; "webkitVideo" === t ? e.el.webkitExitFullscreen() : o[t] && n[o[t].cancel]() } function r(e, n) { var s = e.fullScreenMode; "webkitVideo" === s ? i(e) : o[s] ? (e.fullScreenElement = n, n[o[s].request]()) : t("Attempted to use full screen on unsupported client - please check canFullScreen") } var o = { standard: { cancel: "cancelFullScreen", change: "fullscreenchange", enabled: "fullscreenEnabled", error: "fullscreenerror", element: "fullscreenElement", request: "requestFullScreen" }, moz: { cancel: "mozCancelFullScreen", change: "mozfullscreenchange", enabled: "mozFullScreenEnabled", error: "mozfullscreenerror", element: "mozFullScreenElement", request: "mozRequestFullScreen" }, ms: { cancel: "msExitFullscreen", change: "MSFullscreenChange", enabled: "msFullscreenEnabled", error: "MSFullscreenError", element: "msFullscreenElement", request: "msRequestFullscreen" }, webkit: { cancel: "webkitCancelFullScreen", change: "webkitfullscreenchange", enabled: "webkitFullscreenEnabled", error: "webkitfullscreenerror", element: "webkitCurrentFullScreenElement", request: "webkitRequestFullScreen" } }; return function (e) { return n(e), { requestFullScreen: function (t) { r(e, t || e.el) }, cancelFullScreen: function () { s(e) } } } }), define("player/addActions", ["jquery", "./throwError", "./actionsFlash", "./actionsH264", "./actionsHls", "./getFullScreenActions"], function (e, t, n, i, s, r) { "use strict"; var o = { flash: n, h264: i, hls: s }; return function (e) { function n(t) { for (var n = -1, i = t.length; ++n < i;) t[n].callback.apply(e, t[n].args) } function i(t) { return function () { var n = [].slice.call(arguments); return c ? t.apply(e, n) : l.push({ callback: t, args: n }), e } } var s = e.mode, a = o[s], l = [], c = !1; if (!a) return t("unkown mode for actions: " + s); e.topic("ready").once(function () { c = !0, n(l) }), a.play = function () { var t = a.play, n = !1; return e.topic("ended").subscribe(function () { n = !0 }), e.topic("play").subscribe(function () { n = !1 }), function () { n && a.seek(0), t.call(e) } }(), a.volume = function () { var t = a.volume; return function (n) { n = Math.round(1e3 * +n) / 1e3, 0 > n && (n = 0), n > 1 && (n = 1), t.call(e, n) } }(), a.seek = function () { var t = a.seek, n = 0; return e.topic("duration").subscribe(function (e) { n = e }), function (i) { i = +i, 0 > i && (i = 0), i > n && (i = n), t.call(e, i) } }(), a.seek = function () { var t = a.seek, n = !1, i = !1; return e.topic("ready.seekable").once(function () { n !== !1 && t.call(e, n), i = !0 }), function (s) { i ? t.call(e, s) : n = s } }(), a.toggle = function () { e.paused ? e.play() : e.pause() }; var u = r(e); a.requestFullScreen = u.requestFullScreen, a.cancelFullScreen = u.cancelFullScreen; for (var h in a) a.hasOwnProperty(h) && (e[h] = i(a[h])) } }), define("player/addProperties", [], function () { "use strict"; function e() { var e = document.createElement("video"); return e.requestFullScreen ? "standard" : e.mozRequestFullScreen ? "moz" : e.webkitRequestFullScreen ? "webkit" : e.webkitEnterFullscreen ? "webkitVideo" : e.msRequestFullscreen ? "ms" : !1 } return function (t) { t.fullScreenMode = e(), t.canFullScreen = t.fullScreenMode !== !1, t.mode = t.options.mode, t.talks = t.options.talks, t.postrolling = !1, t.paused = !0, t.on("play", function () { t.paused = !1 }).on("pause", function () { t.paused = !0 }) } }), define("player/addVolume", [], function () { "use strict"; return function (e) { var t = !1; e.on("ready", function () { e.volume(e.config.get("volume")), e.mute(e.config.get("muted")) }).on("muted", function (n) { t = n, e.config.set("muted", n) }).on("volume", function (n) { e.config.set("volume", n), n > 0 && t && e.mute(!1) }) } }), define("player/augmentTalks", [], function () { "use strict"; return function (e) { for (var t, n = e.length, i = n; i--;) t = e[i], t.index = i; return e } }), define("player/Config", ["jquery"], function (e) { "use strict"; function t(e) { return !!(e && e.getItem && e.setItem && window.JSON && JSON.parse && JSON.stringify) } function n(n, i) { if (t(n)) { var s = n.getItem(i); if ("string" === e.type(s) && (s = JSON.parse(s), "object" === e.type(s))) return s } return {} } function i(n, i, s) { t(n) && "object" === e.type(s) && n.setItem(i, JSON.stringify(s)) } function s(e) { this._options = e, this._inited = !1 } return e.extend(s.prototype, { _init: function () { this._inited || (this.internal = e.extend({}, this._options.defaults, n(this._options.storageAdapter, this._options.storageProperty)), this._inited = !0) }, get: function (e) { return this._init(), this.internal[e] }, set: function (e, t) { this._init(), this.internal[e] = t, i(this._options.storageAdapter, this._options.storageProperty, this.internal) } }), s }), define("player/Player", ["jquery", "./topicFactory", "./replaceElement", "./getSupportedMode", "./checkRequiredParams", "./addHandlers", "./addActions", "./addProperties", "./addVolume", "./augmentTalks", "./isLastTalk", "./Config"], function (e, t, n, i, s, r, o, a, l, c, u, h) { "use strict"; function d(u) { var d = this; return u = e.extend({}, p, u), s(u) ? (u.mode = i(u), u.talks = c(u.talks), this.topic = t({ bufferPlayable: void 0, bufferUnplayable: void 0, play: void 0, pause: void 0, prerollStart: void 0, prerollBlock: void 0, postrollStart: void 0, postrollEnd: void 0, adBlock: void 0, seeked: void 0, seeking: void 0, outro: void 0 }), this.options = u, this.config = new h(e.extend({ defaults: { languageCode: !1, muted: !1, volume: u.defaultVolume } }, u)), a(this), o(d), l(d), this.topic("ready.dom").once(function () { window.setTimeout(function () { r(d), d.topic("ready.handlers").once(function () { d.topic("ready").publish() }) }, 10) }), void n(this)) : !1 } var p = { attrs: {}, defaultVolume: 1, el: null, flashVersion: "11.1.0", nativeLanguage: "en", storageAdapter: window.localStorage, storageProperty: "playerconfig", swf: "assets/player.swf" }; e.extend(d.prototype, { on: function (e, t) { return this.topic(e).subscribe(t), this }, one: function (e, t) { return this.topic(e).once(t), this }, isLastTalk: function () { return u(this) } }); t(); return d }), function (e) { "use strict"; var t = function (e, n, i) { return 1 === arguments.length ? t.get(e) : t.set(e, n, i) }; t._document = document, t._navigator = navigator, t.defaults = { path: "/" }, t.get = function (e) { return t._cachedDocumentCookie !== t._document.cookie && t._renewCache(), t._cache[e] }, t.set = function (n, i, s) { return s = t._getExtendedOptions(s), s.expires = t._getExpiresDate(i === e ? -1 : s.expires), t._document.cookie = t._generateCookieString(n, i, s), t }, t.expire = function (n, i) { return t.set(n, e, i) }, t._getExtendedOptions = function (n) { return { path: n && n.path || t.defaults.path, domain: n && n.domain || t.defaults.domain, expires: n && n.expires || t.defaults.expires, secure: n && n.secure !== e ? n.secure : t.defaults.secure } }, t._isValidDate = function (e) { return "[object Date]" === Object.prototype.toString.call(e) && !isNaN(e.getTime()) }, t._getExpiresDate = function (e, n) { switch (n = n || new Date, typeof e) { case "number": e = new Date(n.getTime() + 1e3 * e); break; case "string": e = new Date(e) } if (e && !t._isValidDate(e)) throw new Error("`expires` parameter cannot be converted to a valid Date instance"); return e }, t._generateCookieString = function (e, t, n) { e = encodeURIComponent(e), t = (t + "").replace(/[^!#$&-+\--:<-\[\]-~]/g, encodeURIComponent), n = n || {}; var i = e + "=" + t; return i += n.path ? ";path=" + n.path : "", i += n.domain ? ";domain=" + n.domain : "", i += n.expires ? ";expires=" + n.expires.toGMTString() : "", i += n.secure ? ";secure" : "" }, t._getCookieObjectFromString = function (n) { for (var i = {}, s = n ? n.split("; ") : [], r = 0; r < s.length; r++) { var o = t._getKeyValuePairFromCookieString(s[r]); i[o.key] === e && (i[o.key] = o.value) } return i }, t._getKeyValuePairFromCookieString = function (e) { var t = e.indexOf("="); return t = 0 > t ? e.length : t, { key: decodeURIComponent(e.substr(0, t)), value: decodeURIComponent(e.substr(t + 1)) } }, t._renewCache = function () { t._cache = t._getCookieObjectFromString(t._document.cookie), t._cachedDocumentCookie = t._document.cookie }, t._areEnabled = function () { return t._navigator.cookieEnabled || "1" === t.set("cookies.js", 1).get("cookies.js") }, t.enabled = t._areEnabled(), "function" == typeof define && define.amd ? define("Cookies", [], function () { return t }) : "undefined" != typeof exports ? ("undefined" != typeof module && module.exports && (exports = module.exports = t), exports.Cookies = t) : window.Cookies = t }(), define("widgets/player", ["jquery", "lodash", "utils/f", "utils/query_param", "lib/ga", "lib/currentUserId", "player/Player", "lib/pubSub", "Modernizr", "Cookies", "spinjs", "player/log", "jqueryui/widget", "widgets/hover", "lib/resize"], function (e, t, n, i, s, r, o, a, l, c, u, h) {
        "use strict"; var d = "player", p = d + "--playing", f = d + "--fullscreen", m = d + "--show-cursor", g = d + "__container", v = g + "__cursor-killer", _ = g + "__placeholder", y = g + "__video", b = e("<div></div>"), w = t.once(function (n, i) { window.onYouTubeIframeAPIReady = t.bind(n, i), e.getScript("//www.youtube.com/iframe_api") }); return h.enabled = !1, e.widget("ted.player", e.ted.hover, {
            options: { currentTalk: null, flashVars: {}, mode: null, nativeLanguage: "en", startTrackingAt: 0, swf: "/assets/player.swf?" + TED.assetBuster, talks: null, hideCursorDelay: 1e3 }, _isPlayerInitialized: !1, _addElements: function () {
                var e = this.element.find("div." + g);
                e.length || (e = b.clone().addClass(g).appendTo(this.element)); var t = e.find("div." + _); t.length || (t = b.clone().addClass(_).appendTo(e)); var n = e.find("div." + v); n.length || (n = b.clone().addClass(v).appendTo(e)), this.elements = { container: e, placeholder: t, cursorKiller: n }
            }, _breakpoint: function (e) { 1024 > e ? this.video.attr("controls", "controls") : this.video.removeAttr("controls") }, _create: function () { this.options.currentTalk || (this.options.currentTalk = this.options.talks[0]), this._on({ playerplay: function () { this.element.addClass(p) }, playerpause: function () { this.element.removeClass(p) } }), this._isInternal = !this.talk().external, this.options.hoverStopDelay = this.options.hideCursorDelay, this._initializePlayer(), this._initializeTracking() }, _incrementTalkViews: function () { var e = require("Cookies").get("__utma"); if (e && l.localstorage) { var t = +e.split(".").pop(), n = window.localStorage, i = "talkViews", r = (n.getItem(i) || "").split("|"); 2 === r.length && +r[0] === t ? r[1] = +r[1] + 1 : r = [t, 1], n.setItem(i, r.join("|")), s.set("metric1", r[1]) } }, _initializeTracking: function () { function e(e) { c = t.union([30, 60, 90], t.range(120, e + 1, 120)) } function n() { a = { times: {}, progress: {}, ads: {} } } var i, r = !1, o = null, a = null, l = [25, 50, 75, 95], c = [], u = !1; n(), this._on({ playerenterfullscreen: function () { s.sendEvent("player", "enterFullScreen") }, playerexitfullscreen: function () { s.sendEvent("player", "exitFullScreen") }, playerplay: function () { var e = this.options.currentTalk.id; s.sendEvent("player", "start", r ? "subsequent" : "initial"), r = !0, o !== e && (s.sendEvent("player.talk", "start", e), o = e) }, playerpause: function () { s.sendEvent("player", "pause") }, playerrequestnext: function () { s.sendEvent("player", "next", u ? "postroll" : "talk") }, playerrequestplay: function () { s.sendEvent("player", "request", r ? "subsequent" : "initial") }, playerprogress: function (e, t) { var n = 100 * t.progress, r = 0, o = -1, c = l.length; if (!this.player.postrolling) for (; a && ++o < c && n > r;) r = l[o], n >= r && !a.progress[r] && (i > this.options.startTrackingAt && s.sendEvent("player", "progressPct", r + "%"), a.progress[r] = !0) }, playercomplete: function () { a && !a.progress[100] && (s.sendEvent("player", "progressPct", "100%"), a.progress[100] = !0, s.sendEvent("player.talk", "complete", this.options.currentTalk.id)) }, playercurrenttime: function (e, t) { var n = t.currentTime, r = 0, o = -1, l = c.length; if (i = n, !this.player.postrolling) for (; a && ++o < l && n > r;) r = c[o], n >= r && !a.times[r] && (r > this.options.startTrackingAt && s.sendEvent("player", "progressTime", r + " seconds"), a.times[r] = !0) }, playerprerollstart: function () { a && !a.ads.prerollStart && (s.sendEvent("player.preRoll", "cardStart"), a.ads.prerollStart = !0) }, playerprerollblock: function () { a && !a.ads.prerollBlock && (s.sendEvent("player.preRoll", "cardBlock"), a.ads.prerollBlock = !0) }, playerpostrollstart: function () { u = !0, a && !a.ads.postrollStart && (s.sendEvent("player.postRoll", "adStart"), a.ads.postrollStart = !0) }, playerpostrollcomplete: function () { u = !1, a && !a.ads.postrollComplete && (s.sendEvent("player.postRoll", "adComplete"), a.ads.postrollStart = !0) }, playeradblock: function () { s.sendEvent("player", "adBlock") }, playerduration: function (t, n) { this.player.postrolling || e(n.duration) }, playersubtitle: function (e, t) { s.sendEvent("player.subtitle", "setLanguage", t.subtitle.languageCode) }, playertalk: function () { u = !1, n(), this._incrementTalkViews() }, playeroutro: function (e, t) { s.sendEvent("player.talk", "outro", t.outro.talkId) } }) }, _initializePlayer: function () { this._isPlayerInitialized || (this._isPlayerInitialized = !0, this.element.addClass(d), this._addElements(), this._isInternal ? this._initializeInternalPlayer() : "YouTube" === this.talk().external.service && this._initializeYouTubePlayer(), this._hoverInit()) }, _initializeYouTubePlayer: function () { w(this._youTubeApiReady, this), this._on({ playerrequestplay: function () { this._ytPlayer && this._ytPlayer.playVideo && this._ytPlayer.playVideo() } }) }, _youTubeApiReady: function () { var t = this, n = this.talk(), i = e("<iframe class=" + y + " src=//www.youtube.com/embed/" + n.external.code + "?enablejsapi=1&autoplay=0&origin=" + location.origin + " frameborder=0 allowfullscreen></iframe>"); t.elements.placeholder.replaceWith(i), t._ytPlayer = new YT.Player(i.get(0), { events: {} }), t._trigger("domready") }, _initializeInternalPlayer: function () { var s = i("dfptest"); if (s) { var r = encodeURIComponent(s); this.options.talks = this.options.talks.map(function (e) { return e.adUrl = e.adUrl.replace(/(cust_params=[^&]+)&/, "$1%26dfptest%3D" + r + "&"), e }) } this.player = new o({ attrs: { "class": y }, el: this.elements.placeholder.get(0), flashVars: this.options.flashVars, mode: this.options.mode, nativeLanguage: this.options.nativeLanguage, swf: this.options.swf, talks: this.options.talks, shareToken: this.options.shareToken }), this.element.addClass(d + "--" + this.mode()), this._subscribeToPlayerEvents(), this.player.one("ready.dom", t.bind(this._playerDomReady, this)), this.player.canFullScreen && (this.player.on("enterFullScreen", t.bind(this._playerEnterFullScreen, this)), this.player.on("exitFullScreen", t.bind(this._playerExitFullScreen, this))), this.player.on("talk", t.bind(function (e) { this.options.currentTalk = e, this._trigger("talk", null, e) }, this)), this.player.on("bufferUnplayable", t.bind(this._bufferingStarted, this)), this.player.on("bufferPlayable", t.bind(this._bufferingStopped, this)), this._on({ playerpostrollcomplete: function () { this.player.isLastTalk() && !this._queuedTalkId && (this._queuedTalkId = this.options.currentTalk.id) }, playerrequestplay: function () { this._queuedTalkId ? (e(this.player.el).attr("preload", ""), this.player.playTalk(this._queuedTalkId), this._queuedTalkId = null, t.delay(n(this.player, "play"))) : this.player.play() }, playerrequestpause: function () { this.player.pause() } }), this._recordViews() }, _destroy: function () { a("breakpoint").unsubscribe(this._breakpoint) }, _playerDomReady: function () { this.video = e(this.player.el), a("breakpoint").subscribe(t.bind(this._breakpoint, this)), this._trigger("domready") }, _playerEnterFullScreen: function () { this.element.addClass(f) }, _playerExitFullScreen: function () { this.element.removeClass(f) }, _subscribeToPlayerEvents: function () { var e, n = this; this._on({ playerrequestplay: function () { e = !0 }, playerplay: function () { e = !1 } }), t.forEach(["ad", "currentTime", "duration", "ended", "enterFullScreen", "exitFullScreen", "pause", "play", "progress", "ready", "seeked", "seeking", "volume", "muted", "idle", "complete", "prerollStart", "prerollBlock", "postrollStart", "postrollComplete", "adBlock", "bufferPlayable", "bufferUnplayable", "subtitle", "metricsData", "metricsToggle", "outro"], function (t) { n.player.on(t, function (i) { var s = {}; "play" !== t || e || n._trigger("requestplay"), s[t] = i, n._trigger(t, null, s), n["_" + t] = i }) }) }, _hoverStart: function (e) { this.element.addClass(m), this._trigger("hoverstart", e) }, _hoverStop: function (e) { this.element.removeClass(m), this._trigger("hoverstop", e) }, _bufferingStarted: function () { this._spinner || (this._spinner = new u({ lines: 13, length: 13, width: 5, radius: 16, color: "#FFF", trail: 50, shadow: !0 })), this._spinner.spin(this.element.get(0)) }, _bufferingStopped: function () { this._spinner.stop() }, _recordViews: function () { function t() { "hls" === o.mode() && o.player.el.src.indexOf("hls") > -1 && e.post("/talks/" + o.talk().id + "/views", { view: { apikey: "talk_page_2", format: "hls", quality: "variant", service: "ted_player_hls", share_token: o.options.shareToken } }) } function n() { var e = window.COMSCORE; e && e.beacon && e.beacon({ c1: "1", c2: "7341760", c5: "02", c6: o.talk().id }) } function i() { var e = window.COMSCORE; e && e.beacon && e.beacon({ c1: "1", c2: "7341760", c5: "10" }) } function s() { r.get() && e.post("/talks/" + o.talk().id + "/user_views") } var o = this; this._on({ playertalk: function (e, i) { this.player.one("play", function () { i.id === o.talk().id && (t(), n(), s()) }) }, playerpostrollstart: function () { i() } }) }, mode: function () { return this._isInternal ? this.player.options.mode : "external" }, talk: function (e) { return arguments.length && (this.queue(e), this._trigger("requestplay")), this.options.currentTalk }, talks: function () { return this.player.talks }, play: function () { this._trigger("requestplay") }, playNext: function () { this._trigger("requestnext"), this.player.playNext() }, playPrev: function () { this._trigger("requestprev"), this.player.playPrev() }, pause: function () { this._trigger("requestpause") }, queue: function (e) { this._queuedTalkId = e }, seek: function (e, t) { this.options.startTrackingAt = t ? e : 0, this.player.seek(e) }, _subtitle: null, subtitle: function (e) { if (arguments.length) { var n = e ? t.find(this.talk().languages, { languageCode: e }) : !1; this.player.subtitle(e), this._subtitle = n } return this._subtitle }, _volume: null, volume: function (e) { return arguments.length && this.player.volume(e), this._volume }, _muted: null, mute: function (e) { return arguments.length && this.player.mute(e), this._muted }, toggleFullScreen: function () { var t = e("html,body"), n = e(document).scrollTop(), i = e(this.element).offset().top; n > i && t.scrollTop(i), this.player[this.player.isFullScreen ? "cancelFullScreen" : "requestFullScreen"](this.elements.container.get(0)) }, isControllable: function () { return this._isInternal }, isFullScreen: function () { return this._isInternal ? this.player.isFullScreen : !1 }, canFullScreen: function () { return this._isInternal ? this.player.canFullScreen : !1 }, ignoreContainerSize: function (e) { this.player.ignoreContainerSize(e) }
        }), function (t, n) { return e(t).player(n) }
    }), define("hbs!templates/talkPip", ["hbs", "hbs/handlebars"], function (e, t) { var n = t.template(function (e, t, n) { this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var i = ""; return i += '\n\n\n<div class="talk-pip__controls">\n  <a class="talk-pip__controls__button talk-pip__controls__play" href="#">\n    <i class="talk-pip__controls__icon g-pip-play"></i>\n  </a>\n\n  <a class="talk-pip__controls__button talk-pip__controls__pause" href="#">\n    <i class="talk-pip__controls__icon g-pip-pause"></i>\n  </a>\n</div>\n\n\n<div class="talk-pip__details"></div>\n' }); return n }), define("hbs!templates/talkPipDetails", ["hbs", "hbs/handlebars", "templates/helpers/t", "templates/helpers/formatDate", "templates/helpers/formatDuration"], function (e, t) { var n = t.template(function (e, t, n) { this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var i, s, r, o = "", a = "function", l = this.escapeExpression, c = n.helperMissing; return o += '\n\n<div class="talk-pip__meta">\n  <span class="talk-pip__meta__event">', (s = n.event) ? i = s.call(t, { hash: {} }) : (s = t && t.event, i = typeof s === a ? s.call(t, { hash: {} }) : s), o += l(i) + "</span>\n  &middot;\n  " + l((s = n.t || t && t.t, r = { hash: {} }, s ? s.call(t, "Filmed", r) : c.call(t, "t", "Filmed", r))) + '\n  <span class="talk-pip__meta__value">' + l((s = n.formatDate || t && t.formatDate, r = { hash: {} }, s ? s.call(t, "MMMM YYYY", t && t.filmed, r) : c.call(t, "formatDate", "MMMM YYYY", t && t.filmed, r))) + '</span>\n  &middot;\n  <span class="talk-pip__meta__value">' + l((s = n.formatDuration || t && t.formatDuration, r = { hash: {} }, s ? s.call(t, t && t.duration, r) : c.call(t, "formatDuration", t && t.duration, r))) + '</span>\n</div>\n\n<a class="l3 talk-pip__title talk-pip__top-link" href="#">', (s = n.name) ? i = s.call(t, { hash: {} }) : (s = t && t.name, i = typeof s === a ? s.call(t, { hash: {} }) : s), o += l(i) + "</a>\n" }); return n }), function () { var e = [].indexOf || function (e) { for (var t = 0, n = this.length; n > t; t++) if (t in this && this[t] === e) return t; return -1 }, t = [].slice; !function (e, t) { return "function" == typeof define && define.amd ? define("waypoints", ["jquery"], function (n) { return t(n, e) }) : t(e.jQuery, e) }(this, function (n, i) { var s, r, o, a, l, c, u, h, d, p, f, m, g, v, _, y; return s = n(i), h = e.call(i, "ontouchstart") >= 0, a = { horizontal: {}, vertical: {} }, l = 1, u = {}, c = "waypoints-context-id", f = "resize.waypoints", m = "scroll.waypoints", g = 1, v = "waypoints-waypoint-ids", _ = "waypoint", y = "waypoints", r = function () { function e(e) { var t = this; this.$element = e, this.element = e[0], this.didResize = !1, this.didScroll = !1, this.id = "context" + l++, this.oldScroll = { x: e.scrollLeft(), y: e.scrollTop() }, this.waypoints = { horizontal: {}, vertical: {} }, this.element[c] = this.id, u[this.id] = this, e.bind(m, function () { var e; return t.didScroll || h ? void 0 : (t.didScroll = !0, e = function () { return t.doScroll(), t.didScroll = !1 }, i.setTimeout(e, n[y].settings.scrollThrottle)) }), e.bind(f, function () { var e; return t.didResize ? void 0 : (t.didResize = !0, e = function () { return n[y]("refresh"), t.didResize = !1 }, i.setTimeout(e, n[y].settings.resizeThrottle)) }) } return e.prototype.doScroll = function () { var e, t = this; return e = { horizontal: { newScroll: this.$element.scrollLeft(), oldScroll: this.oldScroll.x, forward: "right", backward: "left" }, vertical: { newScroll: this.$element.scrollTop(), oldScroll: this.oldScroll.y, forward: "down", backward: "up" } }, !h || e.vertical.oldScroll && e.vertical.newScroll || n[y]("refresh"), n.each(e, function (e, i) { var s, r, o; return o = [], r = i.newScroll > i.oldScroll, s = r ? i.forward : i.backward, n.each(t.waypoints[e], function (e, t) { var n, s; return i.oldScroll < (n = t.offset) && n <= i.newScroll ? o.push(t) : i.newScroll < (s = t.offset) && s <= i.oldScroll ? o.push(t) : void 0 }), o.sort(function (e, t) { return e.offset - t.offset }), r || o.reverse(), n.each(o, function (e, t) { return t.options.continuous || e === o.length - 1 ? t.trigger([s]) : void 0 }) }), this.oldScroll = { x: e.horizontal.newScroll, y: e.vertical.newScroll } }, e.prototype.refresh = function () { var e, t, i, s = this; return i = n.isWindow(this.element), t = this.$element.offset(), this.doScroll(), e = { horizontal: { contextOffset: i ? 0 : t.left, contextScroll: i ? 0 : this.oldScroll.x, contextDimension: this.$element.width(), oldScroll: this.oldScroll.x, forward: "right", backward: "left", offsetProp: "left" }, vertical: { contextOffset: i ? 0 : t.top, contextScroll: i ? 0 : this.oldScroll.y, contextDimension: i ? n[y]("viewportHeight") : this.$element.height(), oldScroll: this.oldScroll.y, forward: "down", backward: "up", offsetProp: "top" } }, n.each(e, function (e, t) { return n.each(s.waypoints[e], function (e, i) { var s, r, o, a, l; return s = i.options.offset, o = i.offset, r = n.isWindow(i.element) ? 0 : i.$element.offset()[t.offsetProp], n.isFunction(s) ? s = s.apply(i.element) : "string" == typeof s && (s = parseFloat(s), i.options.offset.indexOf("%") > -1 && (s = Math.ceil(t.contextDimension * s / 100))), i.offset = r - t.contextOffset + t.contextScroll - s, i.options.onlyOnScroll && null != o || !i.enabled ? void 0 : null !== o && o < (a = t.oldScroll) && a <= i.offset ? i.trigger([t.backward]) : null !== o && o > (l = t.oldScroll) && l >= i.offset ? i.trigger([t.forward]) : null === o && t.oldScroll >= i.offset ? i.trigger([t.forward]) : void 0 }) }) }, e.prototype.checkEmpty = function () { return n.isEmptyObject(this.waypoints.horizontal) && n.isEmptyObject(this.waypoints.vertical) ? (this.$element.unbind([f, m].join(" ")), delete u[this.id]) : void 0 }, e }(), o = function () { function e(e, t, i) { var s, r; i = n.extend({}, n.fn[_].defaults, i), "bottom-in-view" === i.offset && (i.offset = function () { var e; return e = n[y]("viewportHeight"), n.isWindow(t.element) || (e = t.$element.height()), e - n(this).outerHeight() }), this.$element = e, this.element = e[0], this.axis = i.horizontal ? "horizontal" : "vertical", this.callback = i.handler, this.context = t, this.enabled = i.enabled, this.id = "waypoints" + g++, this.offset = null, this.options = i, t.waypoints[this.axis][this.id] = this, a[this.axis][this.id] = this, s = null != (r = this.element[v]) ? r : [], s.push(this.id), this.element[v] = s } return e.prototype.trigger = function (e) { return this.enabled ? (null != this.callback && this.callback.apply(this.element, e), this.options.triggerOnce ? this.destroy() : void 0) : void 0 }, e.prototype.disable = function () { return this.enabled = !1 }, e.prototype.enable = function () { return this.context.refresh(), this.enabled = !0 }, e.prototype.destroy = function () { return delete a[this.axis][this.id], delete this.context.waypoints[this.axis][this.id], this.context.checkEmpty() }, e.getWaypointsByElement = function (e) { var t, i; return (i = e[v]) ? (t = n.extend({}, a.horizontal, a.vertical), n.map(i, function (e) { return t[e] })) : [] }, e }(), p = { init: function (e, t) { var i; return null == t && (t = {}), null == (i = t.handler) && (t.handler = e), this.each(function () { var e, i, s, a; return e = n(this), s = null != (a = t.context) ? a : n.fn[_].defaults.context, n.isWindow(s) || (s = e.closest(s)), s = n(s), i = u[s[0][c]], i || (i = new r(s)), new o(e, i, t) }), n[y]("refresh"), this }, disable: function () { return p._invoke.call(this, "disable") }, enable: function () { return p._invoke.call(this, "enable") }, destroy: function () { return p._invoke.call(this, "destroy") }, prev: function (e, t) { return p._traverse.call(this, e, t, function (e, t, n) { return t > 0 ? e.push(n[t - 1]) : void 0 }) }, next: function (e, t) { return p._traverse.call(this, e, t, function (e, t, n) { return t < n.length - 1 ? e.push(n[t + 1]) : void 0 }) }, _traverse: function (e, t, s) { var r, o; return null == e && (e = "vertical"), null == t && (t = i), o = d.aggregate(t), r = [], this.each(function () { var t; return t = n.inArray(this, o[e]), s(r, t, o[e]) }), this.pushStack(r) }, _invoke: function (e) { return this.each(function () { var t; return t = o.getWaypointsByElement(this), n.each(t, function (t, n) { return n[e](), !0 }) }), this } }, n.fn[_] = function () { var e, i; return i = arguments[0], e = 2 <= arguments.length ? t.call(arguments, 1) : [], p[i] ? p[i].apply(this, e) : n.isFunction(i) ? p.init.apply(this, arguments) : n.isPlainObject(i) ? p.init.apply(this, [null, i]) : n.error(i ? "The " + i + " method does not exist in jQuery Waypoints." : "jQuery Waypoints needs a callback function or handler option.") }, n.fn[_].defaults = { context: i, continuous: !0, enabled: !0, horizontal: !1, offset: 0, triggerOnce: !1 }, d = { refresh: function () { return n.each(u, function (e, t) { return t.refresh() }) }, viewportHeight: function () { var e; return null != (e = i.innerHeight) ? e : s.height() }, aggregate: function (e) { var t, i, s; return t = a, e && (t = null != (s = u[n(e)[0][c]]) ? s.waypoints : void 0), t ? (i = { horizontal: [], vertical: [] }, n.each(i, function (e, s) { return n.each(t[e], function (e, t) { return s.push(t) }), s.sort(function (e, t) { return e.offset - t.offset }), i[e] = n.map(s, function (e) { return e.element }), i[e] = n.unique(i[e]) }), i) : [] }, above: function (e) { return null == e && (e = i), d._filter(e, "vertical", function (e, t) { return t.offset <= e.oldScroll.y }) }, below: function (e) { return null == e && (e = i), d._filter(e, "vertical", function (e, t) { return t.offset > e.oldScroll.y }) }, left: function (e) { return null == e && (e = i), d._filter(e, "horizontal", function (e, t) { return t.offset <= e.oldScroll.x }) }, right: function (e) { return null == e && (e = i), d._filter(e, "horizontal", function (e, t) { return t.offset > e.oldScroll.x }) }, enable: function () { return d._invoke("enable") }, disable: function () { return d._invoke("disable") }, destroy: function () { return d._invoke("destroy") }, extendFn: function (e, t) { return p[e] = t }, _invoke: function (e) { var t; return t = n.extend({}, a.vertical, a.horizontal), n.each(t, function (t, n) { return n[e](), !0 }) }, _filter: function (e, t, i) { var s, r; return (s = u[n(e)[0][c]]) ? (r = [], n.each(s.waypoints[t], function (e, t) { return i(s, t) ? r.push(t) : void 0 }), r.sort(function (e, t) { return e.offset - t.offset }), n.map(r, function (e) { return e.element })) : [] } }, n[y] = function () { var e, n; return n = arguments[0], e = 2 <= arguments.length ? t.call(arguments, 1) : [], d[n] ? d[n].apply(null, e) : d.aggregate.call(null, n) }, n[y].settings = { resizeThrottle: 100, scrollThrottle: 30 }, s.load(function () { return n[y]("refresh") }) }) }.call(this), define("widgets/talkPip", ["jquery", "hbs!templates/talkPip", "hbs!templates/talkPipDetails", "waypoints", "jqueryui/widget"], function (e, t, n) { "use strict"; var i = "talk-pip--playing", s = "talk-pip__container"; return e.widget("ted.talkPip", { options: { player: null, waypoint: null }, shouldBeOn: !1, _create: function () { var n = this, i = e("html,body"), r = e(t()), o = this.element.find("div." + s); o.length || (o = e("<div></div>").addClass(s).appendTo(this.element)), o.append(r), this.detailsElement = r.filter("div.talk-pip__details"), this.options.player && this._setPlayer(), n._on({ "click a.talk-pip__controls__play": function (e) { e.preventDefault(), this._trigger("play") }, "click a.talk-pip__controls__pause": function (e) { e.preventDefault(), this._trigger("pause") }, "click a.talk-pip__top-link": function (e) { e.preventDefault(), i.animate({ scrollTop: n.options.waypoint.offset().top }, 200) } }), n.options.waypoint.waypoint(function (e) { n.shouldBeOn = "down" === e, n.refreshState() }, { offset: function () { return -n.options.waypoint.height() } }) }, _setPlayer: function () { function t(e) { n.details({ event: e.event, filmed: e.filmed, published: e.published, duration: e.duration, name: e.name }) } var n = this, s = e(n.options.player); t(s.player("talk")), n._on({ talkpipchangestate: function (e, t) { s.player("ignoreContainerSize", t.isOn) }, talkpipplay: function () { s.player("play") }, talkpippause: function () { s.player("pause") } }), s.on("playerplay", function () { n.element.addClass(i) }).on("playerpause", function () { n.element.removeClass(i) }).on("playerended", function () { n.element.removeClass(i) }).on("playertalk", function (e, n) { t(n) }) }, details: function (t) { arguments.length && (e.isPlainObject(t) && (t = e.extend({ eventName: "", filmed: new Date, duration: 0, name: "" }, t), t.filmed *= 1e3, t = n(t)), this.detailsElement.html(t)) }, refreshState: function () { var e = this.shouldBeOn; this.element[e ? "addClass" : "removeClass"]("talk-pip--on"), this._trigger("changeState", null, { isOn: e }) } }), function (t, n) { return e(t).talkPip(n) } }), define("widgets/talkHero", ["jquery", "lodash", "lib/pubSub", "hbs!templates/talkHeroHiccup", "widgets/controls", "widgets/player", "widgets/talkPip", "lib/resize"], function (e, t, n, i) { "use strict"; return e.widget("ted.talkHero", { options: { hiccups: !1, isSkip: !1, isTranscript: !1, nativeLanguage: "en", talks: [] }, _create: function () { var e = this; e.playerElement = e.element.find("div.player"), e.maxiControlsElement = e.element.find("div.controls--maxi"), e.miniControlsElement = e.element.find("div.controls--mini"), e.pipElement = e.element.find("div.talk-pip"), this._addPlayStates(), e._on(e.playerElement, { playerrequestplay: function () { e._onFirstPlay() } }), e._on({ "click a.talk-hero__play": function (e) { e.preventDefault(), this.play() } }), e._on(e.pipElement, { talkpipchangestate: function (t, n) { e.element[n.isOn ? "addClass" : "removeClass"]("talk-hero--pip-on") } }), e.playerElement.player({ nativeLanguage: e.options.nativeLanguage, talks: e.options.talks, shareToken: e.options.shareToken }) }, _isMiniBreakpoint: !1, _isPlayerInitialized: !1, _isPlayerFullScreen: !1, _addPlayStates: function () { function t() { n.element.addClass(o).removeClass(c).removeClass(r).removeClass(a).removeClass(l) } var n = this, i = !1, s = n.playerElement, r = "talk-hero--idle", o = "talk-hero--playing", a = "talk-hero--paused", l = "talk-hero--unactivated", c = "talk-hero--ended", u = "talk-hero--early-request"; n._on(s, { playerplay: t, playerrequestplay: t, playerpause: function () { n.element.removeClass(o).removeClass(r).removeClass(c), s.player("isControllable") ? n.element.addClass(a).removeClass(l) : n.element.addClass(l) }, playerdomready: function () { window.talkHeroPlay && (window.talkHeroPlay = e.noop), n.element.hasClass(u) && (i = !0, n.play(), s.addClass("player--playing"), n.element.removeClass(u)) }, playerready: function () { i && (n.play(), i = !1) }, playeridle: function () { n.element.addClass(r) }, playerended: function () { n.element.removeClass(r).addClass(c).removeClass(a).removeClass(l).addClass(o) }, playerenterfullscreen: function () { n._isPlayerFullScreen = !0, n._refreshMiniControlsState() }, playerexitfullscreen: function () { n._isPlayerFullScreen = !1, n._refreshMiniControlsState() }, playerhoverstart: function () { this.miniControlsElement.addClass("controls--visible") }, playerhoverstop: function () { this.miniControlsElement.removeClass("controls--visible") } }) }, _refreshMiniControlsState: function () { var e = this._isPlayerFullScreen || this._isMiniBreakpoint; this.miniControlsElement[e ? "addClass" : "removeClass"]("controls--active") }, _onFirstPlay: function () { var e = this; if (!e._isPlayerInitialized) { e._isPlayerInitialized = !0, this.playerElement.player("isControllable") && (e.maxiControlsElement.controls({ isSkip: this.options.isSkip, isTranscript: this.options.isTranscript, player: e.playerElement, template: "maxi" }), e.miniControlsElement.controls({ player: e.playerElement, template: "mini" })); var s = e.playerElement.player("mode"), r = e.options.hiccups; (r === s || r === !0 || t.isArray(r) && t.contains(r, s)) && e.element.prepend(i()), "flash" === s && (e.pipElement.talkPip({ player: e.playerElement, waypoint: e.element.find("div.talk-hero__banner") }), n("breakpoint").subscribe(function (t) { e._isMiniBreakpoint = 1024 > t, e._refreshMiniControlsState() })) } }, play: function () { this.playerElement.player("play") }, player: function () { return this.playerElement } }), function (t, n) { return e(t).talkHero(n) } }), define("hbs!templates/popupMenu", ["hbs", "hbs/handlebars"], function (e, t) { var n = t.template(function (e, t, n, i, s) { function r(e, t) { var i, s, r = ""; return r += '\n      <li class="poup-menu__item">\n        <a href="', (s = n.url) ? i = s.call(e, { hash: {} }) : (s = e && e.url, i = typeof s === c ? s.call(e, { hash: {} }) : s), r += u(i) + '" ', i = n["if"].call(e, e && e.blank, { hash: {}, inverse: h.noop, fn: h.program(2, o, t) }), (i || 0 === i) && (r += i), r += ' class="l3 popup-menu__link">\n          ', (s = n.label) ? i = s.call(e, { hash: {} }) : (s = e && e.label, i = typeof s === c ? s.call(e, { hash: {} }) : s), r += u(i) + "\n        </a>\n      </li>\n    " } function o() { return 'target="_blank"' } this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var a, l = "", c = "function", u = this.escapeExpression, h = this; return l += '\n\n<div class="popup-menu">\n  <ul class="popup-menu__list">\n    ', a = n.each.call(t, t && t.items, { hash: {}, inverse: h.noop, fn: h.program(1, r, s) }), (a || 0 === a) && (l += a), l += "\n  </ul>\n</div>\n" }); return n }), define("widgets/popupMenu", ["jquery", "lodash", "hbs!templates/popupMenu", "widgets/tooltip"], function (e, t, n) { "use strict"; return e.widget("ted.popupMenu", e.ted.tooltip, { options: { interactive: !0, inverse: !0, items: [], position: { my: "center top+10", at: "center bottom", of: window, collision: "fit flip" } }, _create: function () { this.options.content || (this.options.content = n({ items: this._items() })), this._super(), this._on(this.popupObject, { "click a.popup-menu__link": function (e) { var t = this.popupObject.find("a.popup-menu__link").index(e.target), n = -1 === t ? null : this.options.items[t]; n.url || e.preventDefault(), this._trigger("itemclick", e, n) !== !1 && n.callback && n.callback.call(e.target, e, n) } }) }, _items: function () { return t.map(this.options.items, function (e) { var n = e.url || "#", i = e.blank || n.match(/^(?:https?:)?\/\//); return t.merge({}, e, { url: n, blank: i }) }) } }), function (t, n) { return e(t).popupMenu(n) } }), define("hbs!templates/talkDownloadModal", ["hbs", "hbs/handlebars", "templates/helpers/t"], function (e, t) { var n = t.template(function (e, t, n, i, s) { function r(e, t) { var i, s, r, a = ""; return a += '\n    <select class="talk-download__language form-control dropdown">\n      <option value="">' + f((s = n.t || e && e.t, r = { hash: {} }, s ? s.call(e, "Subtitles: None", r) : m.call(e, "t", "Subtitles: None", r))) + "</option>\n      ", i = n.each.call(e, e && e.subtitledLanguages, { hash: {}, inverse: g.noop, fn: g.program(2, o, t) }), (i || 0 === i) && (a += i), a += "\n    </select>\n  " } function o(e) { var t, i, s = ""; return s += '\n        <option value="', (i = n.languageCode) ? t = i.call(e, { hash: {} }) : (i = e && e.languageCode, t = typeof i === p ? i.call(e, { hash: {} }) : i), s += f(t) + '">\n          ', (i = n.languageName) ? t = i.call(e, { hash: {} }) : (i = e && e.languageName, t = typeof i === p ? i.call(e, { hash: {} }) : i), s += f(t) + "\n        </options>\n      " } function a(e) { var t, i, s = ""; return s += '\n      <li data-size="', (i = n.size) ? t = i.call(e, { hash: {} }) : (i = e && e.size, t = typeof i === p ? i.call(e, { hash: {} }) : i), s += f(t) + '">\n        <label>\n          <input name="size" class="talk-download__size" type="radio" value="', (i = n.size) ? t = i.call(e, { hash: {} }) : (i = e && e.size, t = typeof i === p ? i.call(e, { hash: {} }) : i), s += f(t) + '">\n          ', (i = n.label) ? t = i.call(e, { hash: {} }) : (i = e && e.label, t = typeof i === p ? i.call(e, { hash: {} }) : i), s += f(t) + "\n        </label>\n      </li>\n    " } function l(e) { var t, i, s, r = ""; return r += '\n  <div class="talk-download__audio">\n    <h4>' + f((i = n.t || e && e.t, s = { hash: {} }, i ? i.call(e, "Audio", s) : m.call(e, "t", "Audio", s))) + '</h4>\n    <div class="talk-download__coach">' + f((i = n.t || e && e.t, s = { hash: {} }, i ? i.call(e, "Audio downloads are available in MP3 format.", s) : m.call(e, "t", "Audio downloads are available in MP3 format.", s))) + '</div>\n\n    <a class="button" href="' + f((t = e && e.talk, t = null == t || t === !1 ? t : t.audioDownload, typeof t === p ? t.apply(e) : t)) + '" download>' + f((i = n.t || e && e.t, s = { hash: {} }, i ? i.call(e, "Download audio", s) : m.call(e, "t", "Download audio", s))) + "</a>\n  </div>\n" } this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var c, u, h, d = "", p = "function", f = this.escapeExpression, m = n.helperMissing, g = this; return d += '\n\n<div class="modal__head">\n  <a class="modal__close modal__head__close" href="#">\n    <i class="g-button-modal-close">' + f((u = n.t || t && t.t, h = { hash: {} }, u ? u.call(t, "Close", h) : m.call(t, "t", "Close", h))) + '</i>\n  </a>\n\n  <h3 class="modal__head__title">' + f((u = n.t || t && t.t, h = { hash: {} }, u ? u.call(t, "Download this talk", h) : m.call(t, "t", "Download this talk", h))) + '</h3>\n</div>\n\n<div class="talk-download__video">\n  <h4>' + f((u = n.t || t && t.t, h = { hash: {} }, u ? u.call(t, "Video", h) : m.call(t, "t", "Video", h))) + '</h4>\n  <div class="talk-download__coach">' + f((u = n.t || t && t.t, h = { hash: {} }, u ? u.call(t, "Videos are available for download in MP4 format.", h) : m.call(t, "t", "Videos are available for download in MP4 format.", h))) + "</div>\n\n  ", c = n["if"].call(t, (c = t && t.talk, null == c || c === !1 ? c : c.subtitledDownloads), { hash: {}, inverse: g.noop, fn: g.program(1, r, s) }), (c || 0 === c) && (d += c), d += '\n\n  <ul class="talk-download__list">\n    ', c = n.each.call(t, t && t.sizes, { hash: {}, inverse: g.noop, fn: g.program(4, a, s) }), (c || 0 === c) && (d += c), d += '\n  </ul>\n\n  <a class="button talk-download__button--video" href="#" download>' + f((u = n.t || t && t.t, h = { hash: {} }, u ? u.call(t, "Download video", h) : m.call(t, "t", "Download video", h))) + '</a>\n\n  <div class="talk-download__link">\n    For low bandwidth downloads,\n    <a href="/talks/quick-list" target="_blank">\n      visit TED\'s quicklist\n    </a>\n  </div>\n</div>\n\n', c = n["if"].call(t, (c = t && t.talk, null == c || c === !1 ? c : c.audioDownload), { hash: {}, inverse: g.noop, fn: g.program(6, l, s) }), (c || 0 === c) && (d += c), d += "\n" }); return n }), define("widgets/talkDownloadModal", ["jquery", "hbs!templates/talkDownloadModal", "widgets/modal"], function (e, t) { "use strict"; function n(e, t) { for (var n, i = e.length, s = [], r = -1; ++r < i;) n = e[r], t && t[n.languageCode] && s.push(n); return s } var i = [{ size: "low", label: "Low (320x180)" }, { size: "medium", label: "Medium (512x288)" }, { size: "high", label: "High (854x480)" }]; e.widget("ted.talkDownloadModal", e.ted.modal, { options: { subtitle: null, talk: null }, elements: {}, _create: function () { this.element.html(t({ sizes: i, talk: this.options.talk, subtitledLanguages: n(this.options.talk.languages, this.options.talk.subtitledDownloads) })), this.elements.sizeRadios = this.element.find("input.talk-download__size"), this.elements.sizeItems = this.elements.sizeRadios.closest("li"), this.elements.videoDownload = this.element.find("a.talk-download__button--video"), this.elements.languageDropdown = this.element.find("select.talk-download__language"), this._on({ talkdownloadmodalopen: this._onOpen }), this._super(), this._on({ "click input.talk-download__size": this.refreshVideoUrl, "change select.talk-download__language": this.refreshVideoUrl, "click a.talk-download__button--video": function (e) { this._trigger("download", e, { type: "video", language: this.elements.languageDropdown.val(), quality: this.elements.sizeRadios.filter(":checked:data(visible)").val() }) }, "click a.talk-download__button--audio": function (e) { this._trigger("download", e, { type: "audio" }) } }), this.refreshVideoUrl() }, refreshVideoUrl: function () { var t, n = this.elements.languageDropdown.val(), i = this.options.talk; t = n ? i.subtitledDownloads[n] : i.nativeDownloads, this.elements.sizeItems.each(function () { var n = e(this), i = n.find("input"), s = "visible", r = t[n.data("size")]; r ? (n.show(), i.data(s, s)) : (n.hide(), i.removeData(s)) }); var s = this.elements.sizeRadios.filter(":checked:data(visible)"); s.length || (s = this.elements.sizeRadios.filter(":data(visible)").last().prop("checked", !0)), this.elements.videoDownload.attr("href", t[s.val()]) }, _onOpen: function () { this.options.subtitle && this.elements.languageDropdown.length && this.elements.languageDropdown.val(this.options.subtitle), this.refreshVideoUrl() } }) }), define("hbs!templates/talkEmbedModal", ["hbs", "hbs/handlebars", "templates/helpers/t"], function (e, t) {
        var n = t.template(function (e, t, n, i, s) {
            function r(e, t) { var i, s, r, a = ""; return a += "\n    <div>\n      <p>" + d((s = n.t || e && e.t, r = { hash: {} }, s ? s.call(e, "Choose subtitles and dimensions.", r) : p.call(e, "t", "Choose subtitles and dimensions.", r))) + '</p>\n      <select class="talk-embed__language">\n        <option value="">' + d((s = n.t || e && e.t, r = { hash: {} }, s ? s.call(e, "Subtitles: None", r) : p.call(e, "t", "Subtitles: None", r))) + "</option>\n        ", i = n.each.call(e, (i = e && e.talk, null == i || i === !1 ? i : i.languages), { hash: {}, inverse: f.noop, fn: f.program(2, o, t) }), (i || 0 === i) && (a += i), a += "\n      </select>\n    </div>\n  " } function o(e) {
                var t, i, s = ""; return s += '\n          <option value="', (i = n.languageCode) ? t = i.call(e, { hash: {} }) : (i = e && e.languageCode, t = typeof i === h ? i.call(e, { hash: {} }) : i), s += d(t) + '">\n            ', (i = n.languageName) ? t = i.call(e, { hash: {} }) : (i = e && e.languageName, t = typeof i === h ? i.call(e, { hash: {} }) : i), s += d(t) + "\n          </options>\n        "
            } this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var a, l, c, u = "", h = "function", d = this.escapeExpression, p = n.helperMissing, f = this; return u += '\n\n<div class="modal__head">\n  <a class="modal__close modal__head__close" href="#">\n    <i class="g-button-modal-close">' + d((l = n.t || t && t.t, c = { hash: {} }, l ? l.call(t, "Close", c) : p.call(t, "t", "Close", c))) + '</i>\n  </a>\n\n  <h3 class="modal__head__title">' + d((l = n.t || t && t.t, c = { hash: {} }, l ? l.call(t, "Embed this talk", c) : p.call(t, "t", "Embed this talk", c))) + '</h3>\n</div>\n\n<div class="talk-embed">\n  <div>\n    <p>' + d((l = n.t || t && t.t, c = { hash: {} }, l ? l.call(t, "Copy & paste this code into your website or blog.", c) : p.call(t, "t", "Copy & paste this code into your website or blog.", c))) + '</p>\n    <input class="form-control talk-embed__code">\n    <p>' + d((l = n.t || t && t.t, c = { hash: {} }, l ? l.call(t, "Wordpress shortcode", c) : p.call(t, "t", "Wordpress shortcode", c))) + '</p>\n    <input class="form-control talk-embed__wordpress">\n  </div>\n\n  ', a = n["if"].call(t, (a = t && t.talk, null == a || a === !1 ? a : a.languages), { hash: {}, inverse: f.noop, fn: f.program(1, r, s) }), (a || 0 === a) && (u += a), u += '\n\n  <div class="talk-embed__sizes">\n    <a class="talk-embed__size talk-embed__size--small" href="#" data-x="560" data-y="315">560 x 315</a>\n    <a class="talk-embed__size talk-embed__size--selected talk-embed__size--medium" href="#" data-x="640" data-y="360">640 x 360</a>\n    <a class="talk-embed__size talk-embed__size--large" href="#" data-x="854" data-y="480">854 x 480</a>\n  </div>\n</div>\n'
        }); return n
    }), define("widgets/talkEmbedModal", ["jquery", "hbs!templates/talkEmbedModal", "widgets/modal"], function (e, t) { "use strict"; var n = "talk-embed", i = n + "__size", s = i + "--selected"; e.widget("ted.talkEmbedModal", e.ted.modal, { options: { talk: null }, elements: {}, _create: function () { this._setContent(), this._super(), this._on({ "click a.talk-embed__size": function (t) { this.elements.sizes.removeClass(s), e(t.target).addClass(s), this.refreshEmbed(), t.preventDefault() }, "click input.talk-embed__code": function (t) { e(t.target).select() }, "change select.talk-embed__language": this.refreshEmbed }), this.refreshEmbed() }, _setContent: function () { this.element.html(t(this.options)), this.elements.code = this.element.find("input." + n + "__code"), this.elements.wordpress = this.element.find("input." + n + "__wordpress"), this.elements.sizes = this.element.find("a." + i), this.elements.language = this.element.find("select." + n + "__language") }, _setOptions: function (e, t) { this._super(e, t), this._setContent(), this.refreshEmbed() }, refreshEmbed: function () { var e = this.elements.language.val(), t = this.elements.sizes.filter("a." + s), n = e ? "lang/" + e + "/" : "", i = e ? " lang=" + e : ""; this.elements.code.val(["<iframe ", 'src="http://embed.ted.com/talks/', n, this.options.talk.slug, '.html" ', 'width="', t.data("x"), '" ', 'height="', t.data("y"), '" ', 'frameborder="0" scrolling="no" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'].join("")), this.elements.wordpress.val(["[ted id=", this.options.talk.id, i, "]"].join("")) } }) }), define("hbs!templates/talkRatingModal", ["hbs", "hbs/handlebars", "templates/helpers/t"], function (e, t) { var n = t.template(function (e, t, n, i, s) { function r(e) { var t, i, s = ""; return s += '\n        <li class="talk-rating__item">\n          <label>\n            <input class="talk-rating__checkbox" type="checkbox" value="', (i = n.id) ? t = i.call(e, { hash: {} }) : (i = e && e.id, t = typeof i === d ? i.call(e, { hash: {} }) : i), s += p(t) + '">\n            <span>', (i = n.name) ? t = i.call(e, { hash: {} }) : (i = e && e.name, t = typeof i === d ? i.call(e, { hash: {} }) : i), s += p(t) + "</span>\n          </label>\n        </li>\n      " } function o(e) { var t, i, s = ""; return s += '\n      <div class="talk-rating__flip">\n        <a class="l3 talk-rating__flip__link" href="#">' + p((t = n.t || e && e.t, i = { hash: {} }, t ? t.call(e, "See all ratings", i) : f.call(e, "t", "See all ratings", i))) + "</a>\n      </div>\n    " } function a(e) { var t, i, s = ""; return s += '\n        <li class="talk-rating__item">\n          <div class="talk-rating__result">\n            <div class="talk-rating__result__bar" style="width:', (i = n.percent) ? t = i.call(e, { hash: {} }) : (i = e && e.percent, t = typeof i === d ? i.call(e, { hash: {} }) : i), s += p(t) + '%"></div>\n            <span class="talk-rating__result__name">', (i = n.name) ? t = i.call(e, { hash: {} }) : (i = e && e.name, t = typeof i === d ? i.call(e, { hash: {} }) : i), s += p(t) + '</span>\n            <span class="talk-rating__result__value">', (i = n.percent) ? t = i.call(e, { hash: {} }) : (i = e && e.percent, t = typeof i === d ? i.call(e, { hash: {} }) : i), s += p(t) + "%</span>\n          </div>\n        </li>\n      " } this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var l, c, u, h = "", d = "function", p = this.escapeExpression, f = n.helperMissing, m = this; return h += '\n\n<div class="talk-rating">\n  \n  <div class="modal__head">\n    <a class="modal__close modal__head__close" href="#">\n      <i class="g-button-modal-close">' + p((c = n.t || t && t.t, u = { hash: {} }, c ? c.call(t, "Close", u) : f.call(t, "t", "Close", u))) + '</i>\n    </a>\n    <h3 class="modal__head__title">' + p((c = n.t || t && t.t, u = { hash: {} }, c ? c.call(t, "Rate this talk", u) : f.call(t, "t", "Rate this talk", u))) + '</h3>\n  </div>\n\n  \n  <div class="talk-rating__submit">\n    <p>\n      ' + p((c = n.t || t && t.t, u = { hash: {} }, c ? c.call(t, "How would you describe this talk? Tell us by choosing up to three words. (If you choose just one, it will count three times.)", u) : f.call(t, "t", "How would you describe this talk? Tell us by choosing up to three words. (If you choose just one, it will count three times.)", u))) + '\n    </p>\n\n    <ul class="talk-rating__list">\n      ', l = n.each.call(t, t && t.ratings, { hash: {}, inverse: m.noop, fn: m.program(1, r, s) }), (l || 0 === l) && (h += l), h += '\n    </ul>\n\n    <button class="button talk-rating__submit__commit" disabled>' + p((c = n.t || t && t.t, u = { hash: {} }, c ? c.call(t, "Submit", u) : f.call(t, "t", "Submit", u))) + "</button>\n\n    ", l = n["if"].call(t, t && t.total, { hash: {}, inverse: m.noop, fn: m.program(3, o, s) }), (l || 0 === l) && (h += l), h += '\n  </div>\n\n  \n  <div class="talk-rating__show">\n    <p>\n      <span class="talk-rating__submitted-message">' + p((c = n.t || t && t.t, u = { hash: {} }, c ? c.call(t, "Thanks for rating this talk!", u) : f.call(t, "t", "Thanks for rating this talk!", u))) + "</span>\n      " + p((c = n.t || t && t.t, u = { hash: {} }, c ? c.call(t, "Here's what everyone else thought:", u) : f.call(t, "t", "Here's what everyone else thought:", u))) + '\n    </p>\n\n    <ul class="talk-rating__list">\n      ', l = n.each.call(t, t && t.ratings, { hash: {}, inverse: m.noop, fn: m.program(5, a, s) }), (l || 0 === l) && (h += l), h += '\n    </ul>\n\n    <div class="talk-rating__flip">\n      <a class="l3 talk-rating__flip__link" href="#">' + p((c = n.t || t && t.t, u = { hash: {} }, c ? c.call(t, "Submit your own rating", u) : f.call(t, "t", "Submit your own rating", u))) + "</a>\n    </div>\n  </div>\n\n</div>\n" }); return n }), function (e, t, n) { "object" == typeof exports ? module.exports = n() : "function" == typeof define && define.amd ? define("depot", n) : t[e] = n() }("depot", this, function () { "use strict"; function e(e) { return e && JSON.parse(e) } function t(e, t) { return e + "-" + t } function n(e, t) { var n, i; if ("function" == typeof e) n = e(t); else { n = !0; for (i in e) n &= e[i] === t[i] } return n } function i() { return Math.floor(65536 * (1 + Math.random())).toString(16).substring(1) } function s() { return i() + i() + "-" + i() + "-" + i() + "-" + i() + "-" + i() + i() + i() } function r(e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]); return e } function o(e, t) { var n; if (t = r({ idAttribute: "_id", storageAdaptor: localStorage }, t), !t.storageAdaptor) throw new Error("No storage adaptor was found"); return n = Object.create(a, { name: { value: e }, idAttribute: { value: t.idAttribute }, storageAdaptor: { value: t.storageAdaptor } }), n.refresh(), n } var a = { save: function (e) { var n, i; return this.refresh(), e[this.idAttribute] || (e[this.idAttribute] = s()), n = e[this.idAttribute] + "", this.ids.indexOf(n) < 0 && (this.ids.push(n), i = this.ids.join(","), this.storageAdaptor.setItem(this.name, i), this.store = i), this.storageAdaptor.setItem(t(this.name, n), JSON.stringify(e)), e }, update: function (e, t) { "undefined" == typeof t && (t = e, e = t[this.idAttribute]); var n = this.get(e); return n && (n = r(n, t), this.save(n)), n }, updateAll: function (e) { var t = this.all(); return t.forEach(function (t) { t = r(t, e), this.save(t) }, this), t }, find: function (i) { var s, r, o = this.name, a = this; return i ? (this.refresh(), this.ids.reduce(function (l, c) { return r = e(a.storageAdaptor.getItem(t(o, c))), s = n(i, r), s && l.push(r), l }, [])) : this.all() }, get: function (n) { return e(this.storageAdaptor.getItem(t(this.name, n))) }, all: function () { var n, i = this, s = this.name; return this.refresh(), this.ids.reduce(function (r, o) { return n = i.storageAdaptor.getItem(t(s, o)), n && r.push(e(n)), r }, []) }, destroy: function (n) { var i, s = n[this.idAttribute] ? n[this.idAttribute] : n, r = t(this.name, s); return n = e(this.storageAdaptor.getItem(r)), this.storageAdaptor.removeItem(r), i = this.ids.indexOf(s), -1 != i && this.ids.splice(i, 1), this.storageAdaptor.setItem(this.name, this.ids.join(",")), n }, destroyAll: function (i) { var s, r, o, a; this.refresh(); for (var l = this.ids.length - 1; l >= 0; l--) s = this.ids[l], a = t(this.name, s), i ? (o = e(this.storageAdaptor.getItem(a)), r = n(i, o), r && (this.storageAdaptor.removeItem(a), this.ids.splice(l, 1))) : this.storageAdaptor.removeItem(a); i ? this.storageAdaptor.setItem(this.name, this.ids.join(",")) : (this.storageAdaptor.removeItem(this.name), this.ids = []) }, size: function () { return this.refresh(), this.ids.length }, refresh: function () { var e = this.storageAdaptor.getItem(this.name); this.store && this.store === e || (this.ids = e && e.split(",") || [], this.store = e) } }; return o }), define("widgets/talkRatingModal", ["jquery", "lodash", "hbs!templates/talkRatingModal", "depot", "widgets/modal"], function (e, t, n, i) { "use strict"; var s = e.ted.modal.prototype, r = i("talkRatings", { idAttribute: "id", storageAdaptor: sessionStorage }); e.widget("ted.talkRatingModal", e.ted.modal, { options: { talkId: null, ratings: [] }, _create: function () { var e = r.get(this.options.talkId), i = this; this._calculateTotal(), this._calculatePercents(), this.element.html(n({ ratings: this.options.ratings, total: this.options.total })), e && this.submitted(), s._create.apply(this, t.toArray(arguments)), this.boxes = this.element.find("input.talk-rating__checkbox"), this.button = this.element.find("button.talk-rating__submit__commit"), this._on("button.talk-rating__submit__commit", { click: function (e) { e.preventDefault(), i.submit() } }), this._on("input.talk-rating__checkbox", { click: function () { i.sanitize() } }), this._on("a.talk-rating__flip__link", { click: function (e) { e.preventDefault(), i.element.toggleClass("talk-rating--flipped") } }) }, _calculatePercents: function () { var e = this.options.total; t.forEach(this.options.ratings, function (t) { t.percent = e > 0 ? Math.round(t.count / e * 100) : 0 }) }, _calculateTotal: function () { var e = t.pluck(this.options.ratings, "count"); this.options.total = t.reduce(e, function (e, t) { return e + t }) }, sanitize: function () { var e = this.boxes, t = e.filter(":checked"); this.button.prop("disabled", !t.length), e.not(t).prop("disabled", t.length > 2) }, submit: function () { var t = this.element.find("input.talk-rating__checkbox:checked").map(function () { return +this.value }).toArray(), n = this; return this._trigger("submit"), e.post("/ratings", { talk_id: this.options.talkId, talk_rating_ids: t }, "json").then(function () { r.save({ id: n.options.talkId, ratings: t }), n.submitted() }, function () { window.alert("Sorry, your rating couldn't be saved. Please try again.") }) }, submitted: function () { this.element.addClass("talk-rating--submitted") } }) }), define("widgets/favoriteButton", ["jquery", "lodash", "lib/favorite", "lib/pubSub", "widgets/tooltip"], function (e, t, n, i) { "use strict"; function s() { return e(document.documentElement).hasClass("loggedin") } var r = "favorite-button", o = r + "--remove", a = r + "--add", l = r + "--working", c = r + "__label", u = "Remove", h = "Favorite", d = "Error", p = "Working…"; e.widget("ted.favoriteButton", e.ted.tooltip, { options: { favoriteId: null, itemId: null, itemType: null, supportTouch: !1, allowClick: !0 }, add: function () { this._toggleFavorite(!0) }, details: function () { var e, t = this.options; return e = { itemId: t.itemId, itemType: t.itemType }, t.favoriteId && (e.id = t.favoriteId), e }, remove: function () { this._toggleFavorite(!1) }, _handleFavoriteButtonEvents: { click: function (e) { s() && (e.preventDefault(), this._toggleFavorite(!this._isAdded)) } }, _isAdded: !1, _checkAddition: function (e) { this._isOurItem(e) && this._toggledFavorite(!0) }, _checkRemoval: function (e) { this._isOurItem(e) && this._toggledFavorite(!1) }, _create: function () { var e = this; this.element.addClass(r), this.label = this.element.find("." + c), t.extend(e.options, { content: '<div style="color:#111;text-align:left;font-size:13px;width:145px;"><a class="l3" href="' + TED.signInUrl + '">Log in</a> or <a class="l3" href="' + TED.signUpUrl + '">sign up</a><br>to add favorites.</div>', interactive: !0, inverse: !0, position: { my: "right middle", at: "left middle", collision: "flip flip" }, beforeOpen: function () { return !s() } }), e._checkDetails(), e._checkAddition = t.bind(e._checkAddition, e), e._checkRemoval = t.bind(e._checkRemoval, e), i("favorite.add").subscribe(e._checkAddition), i("favorite.remove").subscribe(e._checkRemoval), e._on(e._handleFavoriteButtonEvents), e._super(), s() || e.element.attr("href", TED.signUpUrl) }, _destroy: function () { i("favorite.add").unsubscribe(this._checkAddition), i("favorite.remove").unsubscribe(this._checkRemoval), this._super() }, _isOurItem: function (e) { return e.itemId === this.options.itemId || e.itemType === this.options.itemType }, _setOption: function (e, t) { this._super(e, t), ("itemId" === e || "itemType" === e) && this._checkDetails() }, _checkDetails: function () { var e = this; n.get(e.details()).then(function (t) { e._isAdded = !!t, t && (e.options.favoriteId = t.id), e._toggledFavorite(e._isAdded) }, function () { e._toggledFavorite(!1) }) }, _setLabel: function (e) { this.label.text(e) }, _toggleFavorite: function (e) { var i = this; e = !!e, i.element.hasClass(l) || (i.element.addClass(l), i._setLabel(p), n[e ? "add" : "remove"](i.details()).then(function (t) { i.options.favoriteId = e ? t.id : null, i._toggledFavorite(e) }, function () { i._setLabel(d), t.delay(function () { i._setLabel(e ? h : u) }, 800) }).always(function () { i.element.removeClass(l) })) }, _toggledFavorite: function (e) { this._setLabel(e ? u : h), this._isAdded = e, this.element.addClass(e ? o : a).removeClass(e ? a : o) } }) }), define("widgets/watchLaterButton", ["jquery", "lodash", "lib/watchLater", "lib/pubSub", "widgets/tooltip"], function (e, t, n, i) { "use strict"; function s() { return e(document.documentElement).hasClass("loggedin") } var r = "watch-later-button", o = r + "--remove", a = r + "--add", l = r + "--working", c = r + "__label", u = "Remove", h = "Watch later", d = "Error", p = "Working…"; e.widget("ted.watchLaterButton", e.ted.tooltip, { options: { saveId: null, itemId: null, itemType: null, supportTouch: !1, allowClick: !0, signInMessage: "Short on time? Save\nthis to watch later." }, add: function () { this._toggleSave(!0) }, details: function () { var e, t = this.options; return e = { itemId: t.itemId, itemType: t.itemType }, t.saveId && (e.id = t.saveId), e }, update: function (e) { t.extend(this.options, e), n.update(this.details()) }, remove: function () { this._toggleSave(!1) }, _handleWatchLaterEvents: { click: function (e) { s() && (e.preventDefault(), this._toggleSave(!this._isAdded)) } }, _isSaved: !1, _checkAddition: function (e) { this._isOurItem(e) && this._toggledSave(!0) }, _checkRemoval: function (e) { this._isOurItem(e) && this._toggledSave(!1) }, _create: function () { var e = this; this.element.addClass(r), this.label = this.element.find("." + c), t.extend(e.options, { content: '<div style="color:#111;font-size:13px;text-align:left;width:145px;">' + e.options.signInMessage.replace("\n", "<br>") + "</div>", interactive: !0, inverse: !0, position: { my: "right middle", at: "left middle", collision: "flip flip" }, beforeOpen: function () { return !s() } }), e._checkDetails(), e._checkAddition = t.bind(e._checkAddition, e), e._checkRemoval = t.bind(e._checkRemoval, e), i("watchLater.add").subscribe(e._checkAddition), i("watchLater.remove").subscribe(e._checkRemoval), e._on(e._handleWatchLaterEvents), e._super(), s() || e.element.attr("href", TED.signUpUrl) }, _destroy: function () { i("watchLater.add").unsubscribe(this._checkAddition), i("watchLater.remove").unsubscribe(this._checkRemoval), this._super() }, _isOurItem: function (e) { return e.itemId === this.options.itemId && e.itemType === this.options.itemType }, _setOption: function (e, t) { this._super(e, t), ("itemId" === e || "itemType" === e) && this._checkDetails() }, _checkDetails: function () { var e = this; n.get(e.details()).then(function (t) { e._isAdded = !!t, t && (e.options.saveId = t.id), e._toggledSave(e._isAdded) }, function () { e._toggledSave(!1) }) }, _setLabel: function (e) { this.label.text(e) }, _toggleSave: function (e) { var i = this; e = !!e, i.element.hasClass(l) || (i.element.addClass(l), i._setLabel(p), n[e ? "add" : "remove"](i.details()).then(function (t) { i.options.saveId = e ? t.id : null, i._toggledSave(e) }, function () { i._setLabel(d), t.delay(function () { i._setLabel(e ? h : u) }, 800) }).always(function () { i.element.removeClass(l) })) }, _toggledSave: function (e) { this._setLabel(e ? u : h), this._isAdded = e, this.element.addClass(e ? o : a).removeClass(e ? a : o) } }) }), define("talk/talkPage", ["jquery", "lodash", "utils/query_param", "lib/ga", "lib/pubSub", "talk/transcript", "lib/ads", "lib/qos", "lib/favorite", "lib/watchLater", "utils/share", "utils/timeFromUrl", "utils/query_param", "hbs!templates/talkEndCard", "hbs!templates/talkViewsBreakdown", "views/ThreadView", "models/Thread", "apps/your_impact/app", "widgets/talkHero", "widgets/tooltip", "widgets/popupMenu", "widgets/talkArticleLink", "widgets/talkDownloadModal", "widgets/talkEmbedModal", "widgets/talkRatingModal", "widgets/favoriteButton", "widgets/watchLaterButton", "waypoints"], function (e, t, n, i, s, r, o, a, l, c, u, h, d, p, f, m, g, v) { "use strict"; function _(e, t, n) { if ("embed" === t.service) b.embed(e); else { i.sendEvent("talk.share", "start", t.service); var s, r = y.talks[0].title, o = t.service, a = function (e, t) { return u(o, { url: e, message: r }, t) }; if (n && (s = n.getShareToken()), s) { var l = function (e) { return a(s.get("sharableUrl"), e) }; if (s.readyForSharing) l(); else { var c = l(!0); s.on("readyForSharing", function () { c.goToRightUrl(s.get("sharableUrl")) }) } } else a(y.talks[0].shareUrl || y.talks[0].canonical) } } var y, b = {}; return b.checkDeepLink = function () { var e = h(), t = e.seconds; if (t) { if (e.offset) { var n = y.talks[0].introDuration; t += n } var i = b.hero.data("tedTalkHero").playerElement; i.one("playerready", function () { i.player("seek", t) }) } }, b.initComments = t.once(function () { var e = new g({ id: y.threadId }), t = new m({ el: document.getElementById("thread"), model: e }); t.render(), e.set("sort", t.getSort()), e.more(), s("comment.report").subscribe(function () { i.sendEvent("comment", "flag", "talk") }), s("comment.create").subscribe(function (e) { i.sendEvent("comment", e.parentId ? "reply" : "new", "talk") }), s("comment.upvote").subscribe(function (e) { e.upvoted && i.sendEvent("comment", "upvote", "talk") }) }), b.initExtras = function () { var n = []; e('a.ga-link[data-ga-category="talk.extras"]').each(function () { n.push(e(this).data("ga-label").split("|")[0]) }), n.length && i.sendEvent("talk.extras", "impression", t.uniq(n).join("|"), { nonInteraction: 1 }), e("a.open-article").talkArticleLink(), e("a.talk-more__link--citations").on("talkarticlelinkshow", function () { i.sendEvent("talk.extras", "click", "citation|show") }).on("talkarticlelinkhide", function () { i.sendEvent("talk.extras", "click", "citation|hide") }) }, b.init = function (s) { var l = s.talks[0]; y = s, b.hero = e("#talk-hero").talkHero({ isTranscript: !0, nativeLanguage: y.language, talks: y.talks, shareToken: n("share") }), i.sendEvent("talk.page", "view", l.id, { nonInteraction: 1 }); var c = new v({ talk: l, rootElement: ".talk-sharing__your-impact" }); o.initPlayer(b.hero.talkHero("player")), a.player = b.hero.talkHero("player"), a.initQos(), b.initWatchLater(l), b.initFavorite(l), b.checkDeepLink(); var u = t.filter([{ label: "Twitter", service: "twitter", smallOnly: !0 }, { label: "Facebook", service: "facebook", smallOnly: !0 }, { label: "Email", service: "email", smallOnly: !0 }, { label: "Google +", service: "gplus" }, { label: "LinkedIn", service: "linkedin" }]), h = e("#sharing-other").popupMenu({ items: t.map(u, function (e) { return t.merge(e, { callback: function (e, t) { _(e, t, c) } }) }) }).popupMenu("popup").find("li.poup-menu__item"); t.each(t.filter(u, { smallOnly: !0 }), function (e, t) { h.eq(t).addClass("hide-lg") }), e("a.talk-sharing__link").click(function (t) { var n = e(this); t.preventDefault(), _(t, { label: n.data("service-label"), service: n.data("service-name") }, c) }), r.player = b.hero.data("tedTalkHero").playerElement, r.initLink({ offset: 1e3 * l.introDuration }), r.player.one("playerplay", function () { b.hero.find("a.talk-hero__play").after(p({ relatedTalks: y.relatedTalks })) }), e("a.download-button").on("click", b.download), e("a.rate-button").on("click", b.rate), e("#thread").waypoint(b.initComments, { offset: "100%" }), b.initCoder(), b.initExtras(), b.initNoLanguage() }, b.initCoder = function () { var e; return t.once(function () { history && history.replaceState && (r.player.on("playerpause", function () { if (e) { var t = window.location.href.split("#")[0], n = e - y.talks[0].introDuration; if (0 >= n) return; history.replaceState(history.state, null, t + "#t-" + Math.floor(1e3 * n)) } }), r.player.on("playercurrenttime", function (t, n) { e = n.currentTime })) }) }(), b.download = function () { var t; return function (n) { n && n.preventDefault() && n.preventDefault(), t ? t.talkDownloadModal("open") : (t = e("<div>").talkDownloadModal(e.extend({ open: i.sendEvent.recall("talk.download", "show"), download: function (e, t) { i.sendEvent("talk.download", "download", t.type + ("audio" === t.type ? "" : "|" + t.quality)) } }, { talk: y.talks[0] })), r.player.on("playersubtitle", function (e, n) { t.talkDownloadModal("option", "subtitle", n.subtitle.languageCode) })) } }(), b.embed = function () { var t; return function () { t ? t.talkEmbedModal("open") : t = e("<div>").talkEmbedModal(e.extend({ open: i.sendEvent.recall("talk.embed", "show") }, { talk: y.talks[0] })) } }(), b.initBreakdown = function (n) { e("#sharing-count").tooltip({ openDelay: 300, content: f({ sources: t.map(n, function (e) { return e.width = e.value / 2, e }) }), position: { my: "center top+10", at: "center bottom", of: window, collision: "fit flip" }, inverse: "true", interactive: !0 }) }, b.initFavorite = function (n) { var r = { itemId: n.id, itemType: "Talk" }; e("a.favorite-button").favoriteButton(r); var o = null, a = t.once(function () { i.sendEvent("favorite", "play", "talk") }), c = b.hero.talkHero("player"); c.on("playercurrenttime", function () { o && a() }), l.get(r).done(function (e) { e && (o = e.id) }), s("favorite.add").subscribe(function (e) { e.itemId === r.itemId && e.itemType === r.itemType && (o = e.id) }), s("favorite.remove").subscribe(function (e) { e.itemId === r.itemId && e.itemType === r.itemType && (o = null) }) }, b.initNoLanguage = function () { d("nolanguage") && e("<div class=talk-hero__hiccup><div class=talk-hero__inner><div class=container>Sorry, subtitles are not available in the language you requested.</div></div></div>").insertBefore(b.hero) }, b.initWatchLater = function (n) { var r = { itemId: n.id, itemType: "Talk" }, o = b.hero.talkHero("player"); e("a.watch-later-button").watchLaterButton(e.extend({ signInMessage: "Short on time? Save\nthis talk to watch later." }, r)); var a = null, l = t.once(function (e) { i.sendEvent("watchLater", "play", "talk", e) }); o.on("playercurrenttime", t.throttle(function (e, t) { if (a) { var n = Math.floor(t.currentTime); n > 5 && c.update({ id: a, secondsPlayed: n }), l(n) } }, 3e4)), c.get(r).done(function (e) { e && (e.secondsPlayed && !h().seconds && o.one("playerready", function () { o.player("seek", e.secondsPlayed, !0) }), a = e.id) }), s("watchLater.add").subscribe(function (e) { e.itemId === n.id && (a = e.id) }), s("watchLater.remove").subscribe(function (e) { e.itemId === n.id && (a = null) }) }, b.rate = function () { var t; return function (n) { n && n.preventDefault() && n.preventDefault(), t ? t.talkRatingModal("open") : t = e("<div>").talkRatingModal(e.extend({ open: i.sendEvent.recall("talk.rate", "show"), submit: i.sendEvent.recall("talk.rate", "submit") }, { talkId: y.talks[0].id, ratings: y.ratings })) } }(), b.hero = null, b }), define("global/links", ["jquery", "deferLink", "lib/ga"], function (e, t, n) { "use strict"; function i(e) { if (e.match(location.origin)) return !1; for (var t = -1; ++t < a;) if (e.match(o[t].re)) return o[t] } function s(t, n, i) { t = e.extend({}, l, t); for (var s in t) t.hasOwnProperty(s) && e.isFunction(t[s]) && (t[s] = t[s].call(n, i)); return t } function r(e) { var r = i(this.href); return r ? (n.send(s(r, this, e)), t.call(this, e)) : !0 } var o = [{ re: /^https?:\/\/(?:.*\.)tedprize\.org/, eventCategory: "link.outbound.tedPrize" }, { re: /^https?:\/\/ed\.ted\.com/, eventCategory: "link.outbound.tedEd" }, { re: /^https?:\/\/tedfellows\.posterous\.com/, eventCategory: "link.outbound.fellowsBlog" }, { re: /^https?:\/\/(?:.*\.)universalsubtitles\.org/, eventCategory: "link.outbound.translatorDashboard" }, { re: /^https?:\/\/(?:.*\.)feedburner\.com/, eventCategory: "link.outbound.feedburner" }, { re: /^https?:\/\// }], a = o.length, l = { hitType: "event", eventCategory: "link.outbound.other", eventAction: "click", eventLabel: function () { return this.href } }; return { init: function () { e("body").on("click", "a[href]", r) } } }), define("lib/newsletter", ["jquery"], function (e) { "use strict"; function t(t) { var n = []; return t.isDaily && n.push("daily"), t.isWeekly && n.push("weekly"), t.isFellows && n.push("fellows"), e.getJSON("//www.ted.com/newsletter/signup.json?callback=?", { newsletterSignup: { email_address: t.email, subscription_list: n } }) } function n(n) { function s(e) { "error" === e.status ? l.rejectWith(n, [["uncaught"]]) : l.resolveWith(n) } function r() { l.rejectWith(n, [["server"]]) } function o() { t(n).then(s, r) } function a(e) { l.rejectWith(this, [e]) } var l = new e.Deferred; return i(n).then(o, a), l } function i(t) { var n = [], i = new e.Deferred; return ("" + t.email).match(/.+@.+/) || n.push("email"), t.isDaily || t.isWeekly || t.isFellows || n.push("subscription"), n.length ? i.rejectWith(t, [n]) : i.resolveWith(t), i.promise() } return { ajax: t, subscribe: n, validate: i } }), define("global/subscribe", ["jquery", "lodash", "lib/newsletter", "lib/ga"], function (e, t, n, i) { "use strict"; function s(e) { m(), i.sendEvent("newsletter", "submit", "footer"), a = { email: h.val(), isDaily: c.is(":checked"), isWeekly: u.is(":checked") }, n.subscribe(a).then(r, o), e.preventDefault() } function r() { i.sendEvent("newsletter", "success", t.filter([a.isDaily ? "daily" : !1, a.isWeekly ? "weekly" : !1]).join(",")), e(p + "-details").slideUp(f), e(p + "-success").slideDown(f) } function o(t) { d.slideUp(f), e(p + "-error-" + t[0]).slideDown(f) } var a, l, c, u, h, d, p = "#newsletter-signup", f = "fast", m = t.once(function () { c = e(p + "-daily"), u = e(p + "-weekly"), h = e(p + "-email"), d = l.find("p.footer-newsletter__error") }); return { init: function () { l = e(p), l.on("submit", s) } } }), define("global/retirement", ["jquery", "Cookies"], function (e, t) { "use strict"; return { init: function () { e("#retirement-retirement").on("click", function (n) { n.preventDefault(), e("#retirement").slideUp("fast"), t.expire("v2", { domain: "ted.com", path: "/" }) }) } } }), define("global/navs", ["jquery", "lib/ga", "lib/pubSub", "lib/resize"], function (e, t, n) { "use strict"; function i() { var i = n("breakpoint").read() >= 1024, s = e(this), a = s.closest("li.nav__item"), l = a.siblings(), c = a.children(r), u = a.hasClass(o), h = s.data("ga-label"); if (!a.hasClass("nav__item--disabled") && (a[i ? "addClass" : "toggleClass"](o), l.removeClass(o), c.length && (!u && h && a.hasClass(o) && t.sendEvent("navigation.menu", "open", h), a.closest("div.shoji-fixture").length || !i))) return l.children(r).stop(!0, !0).animate({ height: "hide" }, 200), c.stop(!0, !0).animate({ height: "toggle" }, 200), !1 } var s = {}, r = "div.nav__folder", o = "nav__item--active"; return s.init = function () { e(document).on("click", "a.nav__link", i) }, s }), define("lib/shoji", ["jquery", "lodash", "Modernizr", "lib/pubSub", "utils/throwError", "lib/resize"], function (e, t, n, i, s) { "use strict"; function r(t) { var n = e(t); return n.hasClass(f) || (n = n.closest("div." + f)), n.length || s("Could not find fixture " + t), n } function o(n, i) { var s = e("<div class=" + f + ">"), r = {}; return t.defaults(r, i, { at: "left" }), _(), s.addClass(f + "--" + r.at), s.data("at", r.at), s.append(n), s.appendTo(d), s } function a() { return _(), n.csstransforms3d && p >= 320 } function l() { _(), e(document.activeElement).blur(), h.removeClass(m + " " + g) } function c(e) { var t = r(e); _(), d.children().removeClass(v), t.addClass(v), u(t.data("at")) } function u(e) { l(), h.addClass("shoji--opened shoji--" + e) } var h, d, p, f = "shoji__fixture", m = "shoji--left", g = "shoji--right", v = f + "--revealed", _ = t.once(function () { h = e("#shoji"), d = e("#shoji-fixtures"), e("#shoji-lattice").on("click", function () { return l(), !1 }), i("breakpoint").subscribe(function (e) { p = e }) }); return { _getFixture: r, _init: _, addFixture: o, canSlide: a, concealFixture: l, revealFixture: c, slide: u } }), define("widgets/fixture", ["jquery", "lodash", "lib/shoji", "jqueryui/widget"], function (e, t, n) { "use strict"; var i, s = t.once(function () { i = e("body,html") }); return e.widget("ted.fixture", { options: { at: "left", autoReveal: !0, scrollAnimationDuration: 200 }, _create: function () { s(), this.fixture = n.addFixture(this.element.remove(), { at: this.options.at }), this.options.autoReveal && this.reveal() }, reveal: function () { this.options.scrollAnimationDuration && i.scrollTop() && i.animate({ scrollTop: 0 }, this.options.scrollAnimationDuration), n.revealFixture(this.fixture) }, conceal: function () { n.concealFixture() } }), function (t, n) { return e(t).fixture(n) } }), define("menuAim", ["jquery"], function (e) { "use strict"; function t(t) { var n = e(this), i = null, s = [], r = null, o = null, a = e.extend({ rowSelector: "> li", submenuSelector: "*", submenuDirection: "right", tolerance: 75, enter: e.noop, exit: e.noop, activate: e.noop, deactivate: e.noop, exitMenu: e.noop }, t), l = 3, c = 300, u = 200, h = function (e) { s.push({ x: e.pageX, y: e.pageY }), s.length > l && s.shift() }, d = function () { o && clearTimeout(o), a.exitMenu(this) && (i && a.deactivate(i), i = null) }, p = function () { o && clearTimeout(o), a.enter(this), v(this) }, f = function () { a.exit(this) }, m = function () { g(this) }, g = function (e) { e !== i && (i && a.deactivate(i), a.activate(e), i = e) }, v = function (e) { var t = _(); null === t ? o = setTimeout(function () { g(e) }, u) : t ? o = setTimeout(function () { v(e) }, t) : g(e) }, _ = function () { function t(e, t) { return (t.y - e.y) / (t.x - e.x) } if (!i || !e(i).is(a.submenuSelector)) return null; var o = n.offset(), l = { x: o.left, y: o.top - a.tolerance }, u = { x: o.left + n.outerWidth(), y: l.y }, h = { x: o.left, y: o.top + n.outerHeight() + a.tolerance }, d = { x: o.left + n.outerWidth(), y: h.y }, p = s[s.length - 1], f = s[0]; if (!p) return 0; if (f || (f = p), f.x < o.left || f.x > d.x || f.y < o.top || f.y > d.y) return 0; if (r && p.x === r.x && p.y === r.y) return 0; var m = u, g = d; "left" === a.submenuDirection ? (m = h, g = l) : "below" === a.submenuDirection ? (m = d, g = h) : "above" === a.submenuDirection && (m = l, g = u); var v = t(p, m), _ = t(p, g), y = t(f, m), b = t(f, g); return y > v && _ > b ? (r = p, c) : (r = null, 0) }; n.mouseleave(d).find(a.rowSelector).mouseenter(p).mouseleave(f).on("touchend", function (t) { i && e(i).is(a.submenuSelector) || (t.preventDefault(), m.apply(this, Array.prototype.slice.call(arguments, 0))) }).click(m), e(document).mousemove(h) } return e.fn.menuAim = function (e) { return this.each(function () { t.call(this, e) }), this }, e }), define("global/mainNav", ["jquery", "lodash", "lib/shoji", "lib/pubSub", "lib/ga", "lib/resize", "widgets/fixture", "menuAim"], function (e, t, n, i, s) { "use strict"; function r(t) { t.preventDefault(), n.canSlide() ? l ? l.fixture("reveal") : (l = e("#banner-core").clone(), l.find("nav.nav--main").removeClass("nav--main"), l.add("*[id]", l).removeAttr("id"), l.show(), l.fixture()) : e("#main-nav").toggleClass("nav--main--open") } function o(t) { 1024 > t || (i("breakpoint").unsubscribe(o), e("#main-nav").find("ul:first > li > a").each(function () { var t = e(this); e('<span class="nav__link nav__link--placeholder" aria-hidden></span>').text(t.text()).insertAfter(t), t.addClass("nav__link--placeheld") })) } function a() { function n() { l = !0, f.trigger("mouseleave") } function r() { return d.read() >= 1024 } function o(i) { 1024 > i || (d.unsubscribe(o), f.menuAim({ activate: function (t) { var n = e(t), i = n.find("a.nav__link"), o = i.data("ga-label"); return r() ? (o && !n.hasClass(c) && s.sendEvent("navigation.menu", "open", o), n.addClass(c).removeClass(u), void m.addClass(h)) : !1 }, deactivate: function (t) { return r() ? (e(t).removeClass(c).removeClass(u), void m.removeClass(h)) : !1 }, exitMenu: function (i) { return r() ? l ? (l = !1, !0) : (e(i).find("li." + c).addClass(u), a = t.delay(n, p), !1) : !1 }, enter: function (t) { return r() ? (e(t).removeClass(u), clearTimeout(a), void (a = null)) : !1 }, submenuDirection: "below" }), m.on("click", n)) } var a, l, c = "nav__item--active", u = "nav__item--deactivating", h = "main-nav-screen--active", d = i("breakpoint"), p = 250, f = e(this).children("ul"), m = e("#main-nav-screen"); i("breakpoint").subscribe(o) } var l, c = {}; return c.init = function () { i("breakpoint").subscribe(o), e("#main-nav-toggle").on("click", r), e("nav.nav--main").each(a) }, c }), define("hbs!templates/login", ["hbs", "hbs/handlebars", "templates/helpers/t"], function (e, t) {
        var n = t.template(function (e, t, n) {
            this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var i, s, r = "", o = n.helperMissing, a = this.escapeExpression; return r += '\n\n<div class="login-form">\n  <form class="form-vertical" action="https://auth.ted.com/session" method="post">\n    <label class="form-group">\n      <span class="control-label">' + a((i = n.t || t && t.t, s = { hash: {} }, i ? i.call(t, "Email:", s) : o.call(t, "t", "Email:", s))) + '</span>\n      <input class="form-control" name="user[email]" type="email">\n    </label>\n\n    <label class="form-group">\n      <span class="control-label">' + a((i = n.t || t && t.t, s = { hash: {} }, i ? i.call(t, "Password:", s) : o.call(t, "t", "Password:", s))) + '</span>\n      <input class="form-control" name="user[password]" type="password">\n    </label>\n\n    <div class="form-group">\n      <input class="button button--dark button--wide" type="submit" value="Log in">\n\n      <div>\n        <a class="l3" href="https://auth.ted.com/account/password/new">' + a((i = n.t || t && t.t, s = { hash: {} }, i ? i.call(t, "Need help logging in?", s) : o.call(t, "t", "Need help logging in?", s))) + '</a>\n      </div>\n    </div>\n  </form>\n\n  <div class="login-form__or"></div>\n\n  <div>\n    <a class="button button--wide button--dark button--facebook" href="/account/auth/facebook">' + a((i = n.t || t && t.t, s = { hash: {} }, i ? i.call(t, "Log in with Facebook", s) : o.call(t, "t", "Log in with Facebook", s))) + "</a>\n  </div>\n\n  <div>\n    " + a((i = n.t || t && t.t, s = { hash: {} }, i ? i.call(t, "Don't have a TED account?", s) : o.call(t, "t", "Don't have a TED account?", s))) + '\n    <a class="l3" href="https://auth.ted.com/users/new">' + a((i = n.t || t && t.t, s = { hash: {} }, i ? i.call(t, "Sign up", s) : o.call(t, "t", "Sign up", s))) + "</a>\n  </div>\n</div>\n"
        }); return n
    }), define("global/login", ["jquery", "lib/shoji", "lib/pubSub", "hbs!templates/login", "lib/resize", "widgets/fixture", "widgets/tooltip"], function (e, t, n, i) { "use strict"; function s(s) { var r = n("breakpoint").read() >= 1024; if (c && !r && t.canSlide()) return s.preventDefault(), a ? void a.fixture("reveal") : void (a = e(i()).fixture({ at: "right" })) } function r(e) { 1024 > e || c && (n("breakpoint").unsubscribe(r), o.tooltip({ content: i(), interactive: !0, position: { my: "right bottom-20", at: "right top", of: window, collision: "fit flip" }, beforeOpen: function () { return n("breakpoint").read() >= 1024 } })) } var o, a, l = {}, c = !1; return l.init = function () { o = e("#login-link"), o.on("click", s), n("breakpoint").subscribe(r) }, l }), define("global/exodus", ["jquery", "lodash", "depot", "Modernizr", "lib/currentUserId", "lib/personalStorage", "exports"], function (e, t, n, i, s, r, o) { "use strict"; function a(e) { var t = !!e.talkId, n = { itemId: t ? e.talkId : e.playlistId, itemType: t ? "Talk" : "Playlist" }; return t && (n.secondsPlayed = e.currentTime), n } var l; o.migrate = function (n) { if (n && n.length) { var i = t.map(n, a); return e.post("/saved_items/batch", { records: i }).done(function (e) { t.forEach(e.records, function (e) { var i = {}; i["Talk" === e.itemType ? "talkId" : "playlistId"] = e.itemId; var s = t.find(n, i); s && s._id && l.destroy(s._id) }) }) } }, o.init = function () { if (i.localstorage && s.get()) { l = n("watchLater", { storageAdaptor: r }); var e = l.all(); o.migrate(e) } } }), define("hbs!templates/accountFixture", ["hbs", "hbs/handlebars", "templates/helpers/t"], function (e, t) { var n = t.template(function (e, t, n, i, s) { function r(e, t) { var i, s = ""; return s += "\n        ", i = n["if"].call(e, e && e.items, { hash: {}, inverse: _.program(10, h, t), fn: _.program(2, o, t) }), (i || 0 === i) && (s += i), s += "\n      " } function o(e, t) { var i, s, r = ""; return r += '\n          <li class="nav__item nav__item--foldable ', i = n["if"].call(e, e && e.open, { hash: {}, inverse: _.noop, fn: _.program(3, a, t) }), (i || 0 === i) && (r += i), r += '">\n            <a class="nav__link" href="#">', (s = n.name) ? i = s.call(e, { hash: {} }) : (s = e && e.name, i = typeof s === g ? s.call(e, { hash: {} }) : s), r += v(i) + '</a>\n            <div class="nav__folder" ', i = n["if"].call(e, e && e.open, { hash: {}, inverse: _.noop, fn: _.program(5, l, t) }), (i || 0 === i) && (r += i), r += '>\n              <ul class="nav__menu">\n                ', i = n.each.call(e, e && e.items, { hash: {}, inverse: _.noop, fn: _.program(7, c, t) }), (i || 0 === i) && (r += i), r += "\n              </ul>\n            </div>\n          </li>\n        " } function a() { return "nav__item--active" } function l() { return 'style="display:block"' } function c(e, t) { var i, s, r = ""; return r += '\n                  <li class="nav__item">\n                    <a class="nav__link" href="', (s = n.url) ? i = s.call(e, { hash: {} }) : (s = e && e.url, i = typeof s === g ? s.call(e, { hash: {} }) : s), r += v(i) + '" ', i = n["if"].call(e, e && e.external, { hash: {}, inverse: _.noop, fn: _.program(8, u, t) }), (i || 0 === i) && (r += i), r += ">", (s = n.name) ? i = s.call(e, { hash: {} }) : (s = e && e.name, i = typeof s === g ? s.call(e, { hash: {} }) : s), r += v(i) + "</a>\n                  </li>\n                " } function u() { return 'target="_blank"' } function h(e, t) { var i, s, r = ""; return r += '\n          <li class="nav__item">\n            <a class="nav__link" href="', (s = n.url) ? i = s.call(e, { hash: {} }) : (s = e && e.url, i = typeof s === g ? s.call(e, { hash: {} }) : s), r += v(i) + '" ', i = n["if"].call(e, e && e.external, { hash: {}, inverse: _.noop, fn: _.program(8, u, t) }), (i || 0 === i) && (r += i), r += ">", (s = n.name) ? i = s.call(e, { hash: {} }) : (s = e && e.name, i = typeof s === g ? s.call(e, { hash: {} }) : s), r += v(i) + "</a>\n          </li>\n        " } this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var d, p, f, m = "", g = "function", v = this.escapeExpression, _ = this, y = n.helperMissing; return m += '\n\n<div class="account__fixture">\n  <div class="account__fixture__welcome">\n    <h2 class="h6">' + v((p = n.t || t && t.t, f = { hash: {} }, p ? p.call(t, "Hi ", f) : y.call(t, "t", "Hi ", f))) + v((d = t && t.user, d = null == d || d === !1 ? d : d.firstName, typeof d === g ? d.apply(t) : d)) + ",</h2>\n    <div>" + v((p = n.t || t && t.t, f = { hash: {} }, p ? p.call(t, "This is your stuff.", f) : y.call(t, "t", "This is your stuff.", f))) + '</div>\n  </div>\n\n  <nav class="nav">\n    <ul class="nav__menu">\n      ', d = n.each.call(t, t && t.items, { hash: {}, inverse: _.noop, fn: _.program(1, r, s) }), (d || 0 === d) && (m += d), m += "\n    </ul>\n  </nav>\n</div>\n" }); return n }), define("hbs!templates/accountPoparoo", ["hbs", "hbs/handlebars", "templates/helpers/t"], function (e, t) { var n = t.template(function (e, t, n, i, s) { function r() { return "account__poparoo__later--populated" } function o(e) { var t, i, s, r = ""; return r += '\n      <li class="account__poparoo__item">\n        <a class="l3" href="/profiles/' + f((t = e && e.user, t = null == t || t === !1 ? t : t.profileId, typeof t === p ? t.apply(e) : t)) + '/tedx-event-management">\n          ' + f((i = n.t || e && e.t, s = { hash: {} }, i ? i.call(e, "TEDx Events", s) : m.call(e, "t", "TEDx Events", s))) + "\n        </a>\n      </li>\n    " } function a(e) { var t, i, s, r = ""; return r += '\n      <li class="account__poparoo__item">\n        <a class="l3" href="' + f((t = e && e.itemUrls, t = null == t || t === !1 ? t : t.conferences, typeof t === p ? t.apply(e) : t)) + '">\n          ' + f((i = n.t || e && e.t, s = { hash: {} }, i ? i.call(e, "Conferences", s) : m.call(e, "t", "Conferences", s))) + "\n        </a>\n      </li>\n    " } function l(e) { var t, i, s, r = ""; return r += '\n      <li class="account__poparoo__item">\n        <a class="l3" href="' + f((t = e && e.itemUrls, t = null == t || t === !1 ? t : t.tedEdHistory, typeof t === p ? t.apply(e) : t)) + '" target="_blank">\n          ' + f((i = n.t || e && e.t, s = { hash: {} }, i ? i.call(e, "Your activity on TED-Ed", s) : m.call(e, "t", "Your activity on TED-Ed", s))) + "\n        </a>\n      </li>\n    " } this.compilerInfo = [4, ">= 1.0.0"], n = this.merge(n, e.helpers); var c, u, h, d = "", p = "function", f = this.escapeExpression, m = n.helperMissing, g = this; return d += '\n\n<div class="account__poparoo">\n  <h2>' + f((u = n.t || t && t.t, h = { hash: {} }, u ? u.call(t, "Hi ", h) : m.call(t, "t", "Hi ", h))) + f((c = t && t.user, c = null == c || c === !1 ? c : c.firstName, typeof c === p ? c.apply(t) : c)) + ",</h2>\n  <div>" + f((u = n.t || t && t.t, h = { hash: {} }, u ? u.call(t, "This is your stuff.", h) : m.call(t, "t", "This is your stuff.", h))) + '</div>\n\n  <ul class="account__poparoo__menu">\n    <li class="account__poparoo__item" id="account-talks">\n      <a class="l3" href="' + f((c = t && t.itemUrls, c = null == c || c === !1 ? c : c.savedTalks, typeof c === p ? c.apply(t) : c)) + '">\n        ' + f((u = n.t || t && t.t, h = { hash: {} }, u ? u.call(t, "Saved talks", h) : m.call(t, "t", "Saved talks", h))) + '\n      </a>\n\n      <a class="account__poparoo__later ', c = n["if"].call(t, t && t.savedTalksCount, { hash: {}, inverse: g.noop, fn: g.program(1, r, s) }), (c || 0 === c) && (d += c), d += '" href="' + f((c = t && t.itemUrls, c = null == c || c === !1 ? c : c.savedTalks, typeof c === p ? c.apply(t) : c)) + '">\n        <span class="account__poparoo__later__count">', (u = n.savedTalksCount) ? c = u.call(t, { hash: {} }) : (u = t && t.savedTalksCount, c = typeof u === p ? u.call(t, { hash: {} }) : u), d += f(c) + '</span>\n      </a>\n    </li>\n\n    <li class="account__poparoo__item" id="account-playlists">\n      <a class="l3" href="' + f((c = t && t.itemUrls, c = null == c || c === !1 ? c : c.savedPlaylists, typeof c === p ? c.apply(t) : c)) + '">\n        ' + f((u = n.t || t && t.t, h = { hash: {} }, u ? u.call(t, "Saved playlists", h) : m.call(t, "t", "Saved playlists", h))) + '\n      </a>\n\n      <a class="account__poparoo__later ', c = n["if"].call(t, t && t.savedPlaylistsCount, { hash: {}, inverse: g.noop, fn: g.program(1, r, s) }), (c || 0 === c) && (d += c), d += '" href="' + f((c = t && t.itemUrls, c = null == c || c === !1 ? c : c.savedPlaylists, typeof c === p ? c.apply(t) : c)) + '">\n        <span class="account__poparoo__later__count">', (u = n.savedPlaylistsCount) ? c = u.call(t, { hash: {} }) : (u = t && t.savedPlaylistsCount, c = typeof u === p ? u.call(t, { hash: {} }) : u), d += f(c) + '</span>\n      </a>\n    </li>\n\n    <li class="account__poparoo__item">\n      <a class="l3" href="' + f((c = t && t.itemUrls, c = null == c || c === !1 ? c : c.favoriteTalks, typeof c === p ? c.apply(t) : c)) + '">\n        ' + f((u = n.t || t && t.t, h = { hash: {} }, u ? u.call(t, "Favorite talks", h) : m.call(t, "t", "Favorite talks", h))) + '\n      </a>\n    </li>\n\n    <li class="account__poparoo__item">\n      <a class="l3" href="' + f((c = t && t.itemUrls, c = null == c || c === !1 ? c : c.favoritePlaylists, typeof c === p ? c.apply(t) : c)) + '">\n        ' + f((u = n.t || t && t.t, h = { hash: {} }, u ? u.call(t, "Favorite playlists", h) : m.call(t, "t", "Favorite playlists", h))) + "\n      </a>\n    </li>\n\n    ", c = n["if"].call(t, (c = t && t.user, null == c || c === !1 ? c : c.isTEDxOrganizer), { hash: {}, inverse: g.noop, fn: g.program(3, o, s) }), (c || 0 === c) && (d += c), d += "\n\n    ", c = n["if"].call(t, (c = t && t.user, null == c || c === !1 ? c : c.hasConferences), { hash: {}, inverse: g.noop, fn: g.program(5, a, s) }), (c || 0 === c) && (d += c), d += "\n\n    ", c = n["if"].call(t, (c = t && t.user, null == c || c === !1 ? c : c.hasEdActivity), { hash: {}, inverse: g.noop, fn: g.program(7, l, s) }), (c || 0 === c) && (d += c), d += '\n\n    <li class="account__poparoo__item">\n      <a class="l3" href="' + f((c = t && t.itemUrls, c = null == c || c === !1 ? c : c.settings, typeof c === p ? c.apply(t) : c)) + '">\n        ' + f((u = n.t || t && t.t, h = { hash: {} }, u ? u.call(t, "Settings", h) : m.call(t, "t", "Settings", h))) + '\n      </a>\n    </li>\n\n    <li class="account__poparoo__item">\n      <a class="l3" href="' + f((c = t && t.itemUrls, c = null == c || c === !1 ? c : c.profile, typeof c === p ? c.apply(t) : c)) + '">\n        ' + f((u = n.t || t && t.t, h = { hash: {} }, u ? u.call(t, "Your profile", h) : m.call(t, "t", "Your profile", h))) + '\n      </a>\n    </li>\n  </ul>\n\n  <a class="account__poparoo__leave" href="' + f((c = t && t.itemUrls, c = null == c || c === !1 ? c : c.logOut, typeof c === p ? c.apply(t) : c)) + '">' + f((u = n.t || t && t.t, h = { hash: {} }, u ? u.call(t, "Log out", h) : m.call(t, "t", "Log out", h))) + "</a>\n</div>\n" }); return n }), define("plugins/addClassFor", ["jquery"], function (e) { "use strict"; e.fn.extend({ addClassFor: function (e, t) { var n = this; return window.setTimeout(function () { n.removeClass(e) }, t), n.addClass(e) } }) }), define("global/account", ["jquery", "lodash", "lib/shoji", "lib/pubSub", "lib/currentUser", "lib/personalStorage", "lib/watchLaterLocal", "utils/monogram", "hbs!templates/accountFixture", "hbs!templates/accountPoparoo", "lib/resize", "transit", "widgets/fixture", "plugins/addClassFor"], function (e, t, n, i, s, r, o, a, l, c) { "use strict"; function u(t) { var s = i("breakpoint").read() >= 1024; if (n.canSlide() && (t.preventDefault(), !s)) return _ ? void _.fixture("reveal") : void (_ = e(l({ items: S(b), user: b })).fixture({ at: "right" })) } function h(e) { if (!(1024 > e)) { i("breakpoint").unsubscribe(h); var t = g.parent().find("div.nav__folder").html(c({ itemUrls: x, user: b, savedTalksCount: !1, savedPlaylistsCount: !1 })); y = t.find("a." + k), p() } } function d() { v || (v = e("#account-link").find("img.banner__account__image")), v.transition({ opacity: 0 }).transition({ opacity: 1 }).transition({ opacity: 0 }).transition({ opacity: 1 }) } function p() { o.count().done(C) } function f(e, t) { e.find("a.account__poparoo__later")[t ? "addClass" : "removeClass"]("account__poparoo__later--populated").find("span").text(t) } function m(t) { var n; b = t, g = e("#account-link"), g.on("click", u), i("breakpoint").subscribe(h), i("favorite.add").subscribe(d), p(), i("watchLater.add").subscribe(p), i("watchLater.remove").subscribe(p), b.avatarUrl ? (n = e("<img class=banner__account__image>"), n.attr("src", b.avatarUrl), e("#account-image").replaceWith(n)) : e("#account-image").text(a(b.firstName + " " + b.lastName)) } var g, v, _, y, b, w = {}, k = "account__poparoo__later", x = { savedTalks: "/dashboard/saved_talks", savedPlaylists: "/dashboard/saved_playlists", favoriteTalks: "/dashboard/favorite_talks", favoritePlaylists: "/dashboard/favorite_playlists", watchHistory: "/dashboard/history", conferences: "/dashboard/conferences", tedEdHistory: "http://ed.ted.com/activity/lessons", settings: "/account/my", profile: "/profile", logOut: TED.signOutUrl }, S = function (e) { var t = []; return t.push({ name: "Talks", open: !0, items: [{ name: "Saved talks", url: x.savedTalks }, { name: "Saved playlists", url: x.savedPlaylists }, { name: "Favorite talks", url: x.favoriteTalks }, { name: "Favorite playlists", url: x.favoritePlaylists }, { name: "Talks you've watched", url: x.watchHistory }] }), e && e.isTEDxOrganizer && t.push({ name: "TEDx Events", url: "/profiles/" + e.profileId + "/tedx-event-management" }), e && e.hasConferences && t.push({ name: "Conferences", url: "/dashboard/conferences" }), e && e.hasEdActivity && t.push({ name: "Your TED-Ed activity", url: x.tedEdHistory, external: !0 }), t.push({ name: "Settings", url: "/account/my" }), t.push({ name: "Your profile", url: "/profile" }), t.push({ name: "Log out", url: TED.signOutUrl }), t }, C = function () { var t, n, i; return function (s) { var r, o = s.total, a = o > 0; if (o !== t) { var l; n && s.talks !== n && (r = "talks", l = s.talks > n), i && s.playlists !== i && (r = "playlists", l = s.playlists > i), r && e("#account-" + r)[l ? "addClass" : "removeClass"]("account__poparoo__item--active"), s.talks !== n && f(e("#account-talks"), s.talks), s.playlists !== i && f(e("#account-playlists"), s.playlists); var c = e("#account-badge"); c.text(s.total > 99 ? 99 : s.total)[a ? "addClass" : "removeClass"]("badge--visible"), a && null !== t && s.total > t && c.addClassFor("badge--notify", 600), n = s.talks, i = s.playlists, t = o } } }(); return w.init = t.once(function () { s.getDetails().done(m) }), w }), require(["jquery", "lodash", "dq", "global/links", "global/subscribe", "global/retirement", "global/navs", "global/mainNav", "global/login", "global/exodus", "global/account", "lib/ads", "jqueryujs"], function (e, t, n, i, s, r, o, a, l, c, u, h) { "use strict"; t.defer(function () { i.init(), s.init(), r.init(), o.init(), a.init(), l.init(), c.init(), u.init() }), n({ q: _g, modules: { global: { ads: h } } }) }), define("global", function () { }), define("talk", ["jquery", "dq", "talk/talkPage", "talk/transcript", "global"], function (e, t, n, i) { "use strict"; t({ modules: { talkPage: n, transcript: i } }) })
}();
//# sourceMappingURL=talk.js.map